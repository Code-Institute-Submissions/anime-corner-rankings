var app=function(){"use strict";function t(){}function e(t,e){for(const n in e)t[n]=e[n];return t}function n(t){return t()}function r(){return Object.create(null)}function i(t){t.forEach(n)}function o(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let a,u;function c(t,e){return a||(a=document.createElement("a")),a.href=e,t===a.href}function l(e,n,r){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}function h(t,e,n){return t.set(n),e}function f(t,e){t.appendChild(e)}function p(t,e,n){t.insertBefore(e,n||null)}function d(t){t.parentNode.removeChild(t)}function g(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function v(t){return document.createElement(t)}function y(t){return document.createTextNode(t)}function m(){return y(" ")}function b(){return y("")}function w(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function E(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function I(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function T(t,e,n,r){t.style.setProperty(e,n,r?"important":"")}function _(t,e){for(let n=0;n<t.options.length;n+=1){const r=t.options[n];if(r.__value===e)return void(r.selected=!0)}}function S(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}function A(t,e,n){t.classList[n?"add":"remove"](e)}class N{constructor(){this.e=this.n=null}c(t){this.h(t)}m(t,e,n=null){this.e||(this.e=v(e.nodeName),this.t=e,this.c(t)),this.i(n)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}i(t){for(let e=0;e<this.n.length;e+=1)p(this.t,this.n[e],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(d)}}function D(t){u=t}function k(){if(!u)throw new Error("Function called outside component initialization");return u}const C=[],x=[],R=[],O=[],L=Promise.resolve();let P=!1;function F(t){R.push(t)}let M=!1;const V=new Set;function U(){if(!M){M=!0;do{for(let t=0;t<C.length;t+=1){const e=C[t];D(e),j(e.$$)}for(D(null),C.length=0;x.length;)x.pop()();for(let t=0;t<R.length;t+=1){const e=R[t];V.has(e)||(V.add(e),e())}R.length=0}while(C.length);for(;O.length;)O.pop()();P=!1,M=!1,V.clear()}}function j(t){if(null!==t.fragment){t.update(),i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(F)}}const q=new Set;let B;function K(){B={r:0,c:[],p:B}}function z(){B.r||i(B.c),B=B.p}function G(t,e){t&&t.i&&(q.delete(t),t.i(e))}function $(t,e,n,r){if(t&&t.o){if(q.has(t))return;q.add(t),B.c.push((()=>{q.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}function H(t){t&&t.c()}function Q(t,e,r,s){const{fragment:a,on_mount:u,on_destroy:c,after_update:l}=t.$$;a&&a.m(e,r),s||F((()=>{const e=u.map(n).filter(o);c?c.push(...e):i(e),t.$$.on_mount=[]})),l.forEach(F)}function W(t,e){const n=t.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function X(t,e){-1===t.$$.dirty[0]&&(C.push(t),P||(P=!0,L.then(U)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Y(e,n,o,s,a,c,l,h=[-1]){const f=u;D(e);const p=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:a,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:n.context||[]),callbacks:r(),dirty:h,skip_bound:!1,root:n.target||f.$$.root};l&&l(p.root);let g=!1;if(p.ctx=o?o(e,n.props||{},((t,n,...r)=>{const i=r.length?r[0]:n;return p.ctx&&a(p.ctx[t],p.ctx[t]=i)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](i),g&&X(e,t)),n})):[],p.update(),g=!0,i(p.before_update),p.fragment=!!s&&s(p.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);p.fragment&&p.fragment.l(t),t.forEach(d)}else p.fragment&&p.fragment.c();n.intro&&G(e.$$.fragment),Q(e,n.target,n.anchor,n.customElement),U()}D(f)}class J{$destroy(){W(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}var Z=function(t,e){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return t.apply(e,n)}},tt=Object.prototype.toString;function et(t){return"[object Array]"===tt.call(t)}function nt(t){return void 0===t}function rt(t){return null!==t&&"object"==typeof t}function it(t){if("[object Object]"!==tt.call(t))return!1;var e=Object.getPrototypeOf(t);return null===e||e===Object.prototype}function ot(t){return"[object Function]"===tt.call(t)}function st(t,e){if(null!=t)if("object"!=typeof t&&(t=[t]),et(t))for(var n=0,r=t.length;n<r;n++)e.call(null,t[n],n,t);else for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.call(null,t[i],i,t)}var at={isArray:et,isArrayBuffer:function(t){return"[object ArrayBuffer]"===tt.call(t)},isBuffer:function(t){return null!==t&&!nt(t)&&null!==t.constructor&&!nt(t.constructor)&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)},isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:rt,isPlainObject:it,isUndefined:nt,isDate:function(t){return"[object Date]"===tt.call(t)},isFile:function(t){return"[object File]"===tt.call(t)},isBlob:function(t){return"[object Blob]"===tt.call(t)},isFunction:ot,isStream:function(t){return rt(t)&&ot(t.pipe)},isURLSearchParams:function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:st,merge:function t(){var e={};function n(n,r){it(e[r])&&it(n)?e[r]=t(e[r],n):it(n)?e[r]=t({},n):et(n)?e[r]=n.slice():e[r]=n}for(var r=0,i=arguments.length;r<i;r++)st(arguments[r],n);return e},extend:function(t,e,n){return st(e,(function(e,r){t[r]=n&&"function"==typeof e?Z(e,n):e})),t},trim:function(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")},stripBOM:function(t){return 65279===t.charCodeAt(0)&&(t=t.slice(1)),t}};function ut(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var ct=function(t,e,n){if(!e)return t;var r;if(n)r=n(e);else if(at.isURLSearchParams(e))r=e.toString();else{var i=[];at.forEach(e,(function(t,e){null!=t&&(at.isArray(t)?e+="[]":t=[t],at.forEach(t,(function(t){at.isDate(t)?t=t.toISOString():at.isObject(t)&&(t=JSON.stringify(t)),i.push(ut(e)+"="+ut(t))})))})),r=i.join("&")}if(r){var o=t.indexOf("#");-1!==o&&(t=t.slice(0,o)),t+=(-1===t.indexOf("?")?"?":"&")+r}return t};function lt(){this.handlers=[]}lt.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},lt.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},lt.prototype.forEach=function(t){at.forEach(this.handlers,(function(e){null!==e&&t(e)}))};var ht=lt,ft=function(t,e,n){return at.forEach(n,(function(n){t=n(t,e)})),t},pt=function(t){return!(!t||!t.__CANCEL__)},dt=function(t,e){at.forEach(t,(function(n,r){r!==e&&r.toUpperCase()===e.toUpperCase()&&(t[e]=n,delete t[r])}))},gt=function(t,e,n,r,i){return function(t,e,n,r,i){return t.config=e,n&&(t.code=n),t.request=r,t.response=i,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},t}(new Error(t),e,n,r,i)},vt=at.isStandardBrowserEnv()?{write:function(t,e,n,r,i,o){var s=[];s.push(t+"="+encodeURIComponent(e)),at.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),at.isString(r)&&s.push("path="+r),at.isString(i)&&s.push("domain="+i),!0===o&&s.push("secure"),document.cookie=s.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},yt=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],mt=at.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function r(t){var r=t;return e&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return t=r(window.location.href),function(e){var n=at.isString(e)?r(e):e;return n.protocol===t.protocol&&n.host===t.host}}():function(){return!0},bt=function(t){return new Promise((function(e,n){var r=t.data,i=t.headers;at.isFormData(r)&&delete i["Content-Type"];var o=new XMLHttpRequest;if(t.auth){var s=t.auth.username||"",a=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";i.Authorization="Basic "+btoa(s+":"+a)}var u,c,l=(u=t.baseURL,c=t.url,u&&!/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(c)?function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}(u,c):c);if(o.open(t.method.toUpperCase(),ct(l,t.params,t.paramsSerializer),!0),o.timeout=t.timeout,o.onreadystatechange=function(){if(o&&4===o.readyState&&(0!==o.status||o.responseURL&&0===o.responseURL.indexOf("file:"))){var r,i,s,a,u,c="getAllResponseHeaders"in o?(r=o.getAllResponseHeaders(),u={},r?(at.forEach(r.split("\n"),(function(t){if(a=t.indexOf(":"),i=at.trim(t.substr(0,a)).toLowerCase(),s=at.trim(t.substr(a+1)),i){if(u[i]&&yt.indexOf(i)>=0)return;u[i]="set-cookie"===i?(u[i]?u[i]:[]).concat([s]):u[i]?u[i]+", "+s:s}})),u):u):null,l={data:t.responseType&&"text"!==t.responseType?o.response:o.responseText,status:o.status,statusText:o.statusText,headers:c,config:t,request:o};!function(t,e,n){var r=n.config.validateStatus;n.status&&r&&!r(n.status)?e(gt("Request failed with status code "+n.status,n.config,null,n.request,n)):t(n)}(e,n,l),o=null}},o.onabort=function(){o&&(n(gt("Request aborted",t,"ECONNABORTED",o)),o=null)},o.onerror=function(){n(gt("Network Error",t,null,o)),o=null},o.ontimeout=function(){var e="timeout of "+t.timeout+"ms exceeded";t.timeoutErrorMessage&&(e=t.timeoutErrorMessage),n(gt(e,t,"ECONNABORTED",o)),o=null},at.isStandardBrowserEnv()){var h=(t.withCredentials||mt(l))&&t.xsrfCookieName?vt.read(t.xsrfCookieName):void 0;h&&(i[t.xsrfHeaderName]=h)}if("setRequestHeader"in o&&at.forEach(i,(function(t,e){void 0===r&&"content-type"===e.toLowerCase()?delete i[e]:o.setRequestHeader(e,t)})),at.isUndefined(t.withCredentials)||(o.withCredentials=!!t.withCredentials),t.responseType)try{o.responseType=t.responseType}catch(e){if("json"!==t.responseType)throw e}"function"==typeof t.onDownloadProgress&&o.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&o.upload&&o.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then((function(t){o&&(o.abort(),n(t),o=null)})),r||(r=null),o.send(r)}))},wt={"Content-Type":"application/x-www-form-urlencoded"};function Et(t,e){!at.isUndefined(t)&&at.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var It,Tt={adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(It=bt),It),transformRequest:[function(t,e){return dt(e,"Accept"),dt(e,"Content-Type"),at.isFormData(t)||at.isArrayBuffer(t)||at.isBuffer(t)||at.isStream(t)||at.isFile(t)||at.isBlob(t)?t:at.isArrayBufferView(t)?t.buffer:at.isURLSearchParams(t)?(Et(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):at.isObject(t)?(Et(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(t){return t>=200&&t<300}};Tt.headers={common:{Accept:"application/json, text/plain, */*"}},at.forEach(["delete","get","head"],(function(t){Tt.headers[t]={}})),at.forEach(["post","put","patch"],(function(t){Tt.headers[t]=at.merge(wt)}));var _t=Tt;function St(t){t.cancelToken&&t.cancelToken.throwIfRequested()}var At=function(t){return St(t),t.headers=t.headers||{},t.data=ft(t.data,t.headers,t.transformRequest),t.headers=at.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),at.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete t.headers[e]})),(t.adapter||_t.adapter)(t).then((function(e){return St(t),e.data=ft(e.data,e.headers,t.transformResponse),e}),(function(e){return pt(e)||(St(t),e&&e.response&&(e.response.data=ft(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)}))},Nt=function(t,e){e=e||{};var n={},r=["url","method","data"],i=["headers","auth","proxy","params"],o=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],s=["validateStatus"];function a(t,e){return at.isPlainObject(t)&&at.isPlainObject(e)?at.merge(t,e):at.isPlainObject(e)?at.merge({},e):at.isArray(e)?e.slice():e}function u(r){at.isUndefined(e[r])?at.isUndefined(t[r])||(n[r]=a(void 0,t[r])):n[r]=a(t[r],e[r])}at.forEach(r,(function(t){at.isUndefined(e[t])||(n[t]=a(void 0,e[t]))})),at.forEach(i,u),at.forEach(o,(function(r){at.isUndefined(e[r])?at.isUndefined(t[r])||(n[r]=a(void 0,t[r])):n[r]=a(void 0,e[r])})),at.forEach(s,(function(r){r in e?n[r]=a(t[r],e[r]):r in t&&(n[r]=a(void 0,t[r]))}));var c=r.concat(i).concat(o).concat(s),l=Object.keys(t).concat(Object.keys(e)).filter((function(t){return-1===c.indexOf(t)}));return at.forEach(l,u),n};function Dt(t){this.defaults=t,this.interceptors={request:new ht,response:new ht}}Dt.prototype.request=function(t){"string"==typeof t?(t=arguments[1]||{}).url=arguments[0]:t=t||{},(t=Nt(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var e=[At,void 0],n=Promise.resolve(t);for(this.interceptors.request.forEach((function(t){e.unshift(t.fulfilled,t.rejected)})),this.interceptors.response.forEach((function(t){e.push(t.fulfilled,t.rejected)}));e.length;)n=n.then(e.shift(),e.shift());return n},Dt.prototype.getUri=function(t){return t=Nt(this.defaults,t),ct(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")},at.forEach(["delete","get","head","options"],(function(t){Dt.prototype[t]=function(e,n){return this.request(Nt(n||{},{method:t,url:e,data:(n||{}).data}))}})),at.forEach(["post","put","patch"],(function(t){Dt.prototype[t]=function(e,n,r){return this.request(Nt(r||{},{method:t,url:e,data:n}))}}));var kt=Dt;function Ct(t){this.message=t}Ct.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},Ct.prototype.__CANCEL__=!0;var xt=Ct;function Rt(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise((function(t){e=t}));var n=this;t((function(t){n.reason||(n.reason=new xt(t),e(n.reason))}))}Rt.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},Rt.source=function(){var t;return{token:new Rt((function(e){t=e})),cancel:t}};var Ot=Rt;function Lt(t){var e=new kt(t),n=Z(kt.prototype.request,e);return at.extend(n,kt.prototype,e),at.extend(n,e),n}var Pt=Lt(_t);Pt.Axios=kt,Pt.create=function(t){return Lt(Nt(Pt.defaults,t))},Pt.Cancel=xt,Pt.CancelToken=Ot,Pt.isCancel=pt,Pt.all=function(t){return Promise.all(t)},Pt.spread=function(t){return function(e){return t.apply(null,e)}},Pt.isAxiosError=function(t){return"object"==typeof t&&!0===t.isAxiosError};var Ft=Pt,Mt=Pt;Ft.default=Mt;var Vt=Ft,Ut=function(t,e){return(Ut=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function jt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Ut(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var qt=function(){return(qt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function Bt(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function Kt(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function zt(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Gt(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function $t(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||e)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ht={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,l=o>>2,h=(3&o)<<4|a>>4,f=(15&a)<<2|c>>6,p=63&c;u||(p=64,s||(f=64)),r.push(n[l],n[h],n[f],n[p])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e}(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var s=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{o=t[n++];var a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();var c=o<<2|s>>4;if(r.push(c),64!==a){var l=s<<4&240|a>>2;if(r.push(l),64!==u){var h=a<<6&192|u;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};function Qt(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=Qt(t[n],e[n]));return t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Wt=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Xt(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Yt(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(t){return!1}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Jt=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,Zt.prototype.create),o}return jt(e,t),e}(Error),Zt=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?te(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",u=new Jt(i,a,r);return u},t}();function te(t,e){return t.replace(ee,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var ee=/\{\$([^}]+)}/g;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ne(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function re(t,e){var n=new ie(t,e);return n.subscribe.bind(n)}var ie=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=oe),void 0===r.error&&(r.error=oe),void 0===r.complete&&(r.complete=oe);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function oe(){}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function se(t){return t&&t._delegate?t._delegate:t}var ae=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),ue="[DEFAULT]",ce=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.onInitCallbacks=new Map}return t.prototype.get=function(t){var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new Wt;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e,n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),r=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(r)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t))try{this.getOrInitializeService({instanceIdentifier:ue})}catch(t){}try{for(var r=zt(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=Gt(i.value,2),s=o[0],a=o[1],u=this.normalizeInstanceIdentifier(s);try{var c=this.getOrInitializeService({instanceIdentifier:u});a.resolve(c)}catch(t){}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t=ue),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return Bt(this,void 0,void 0,(function(){var t;return Kt(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all($t($t([],Gt(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),Gt(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=ue),this.instances.has(t)},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var r=t.options,i=void 0===r?{}:r,o=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(o))throw Error(this.name+"("+o+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var s=this.getOrInitializeService({instanceIdentifier:o,options:i});try{for(var a=zt(this.instancesDeferred.entries()),u=a.next();!u.done;u=a.next()){var c=Gt(u.value,2),l=c[0],h=c[1];o===this.normalizeInstanceIdentifier(l)&&h.resolve(s)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return s},t.prototype.onInit=function(t,e){var n,r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);var o=this.instances.get(r);return o&&t(o,r),function(){i.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,r,i=this.onInitCallbacks.get(e);if(i)try{for(var o=zt(i),s=o.next();!s.done;s=o.next()){var a=s.value;try{a(t,e)}catch(t){}}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,r=t.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,e===ue?void 0:e),options:i}),this.instances.set(n,o),this.invokeOnInitCallbacks(o,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(t){}return o||null},t.prototype.normalizeInstanceIdentifier=function(t){return void 0===t&&(t=ue),this.component?this.component.multipleInstances?t:ue:t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var le,he=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new ce(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function fe(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var pe,de=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(pe||(pe={}));var ge,ve={debug:pe.DEBUG,verbose:pe.VERBOSE,info:pe.INFO,warn:pe.WARN,error:pe.ERROR,silent:pe.SILENT},ye=pe.INFO,me=((le={})[pe.DEBUG]="log",le[pe.VERBOSE]="log",le[pe.INFO]="info",le[pe.WARN]="warn",le[pe.ERROR]="error",le),be=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=me[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,fe(["["+i+"]  "+t.name+":"],n))}},we=function(){function t(t){this.name=t,this._logLevel=ye,this._logHandler=be,this._userLogHandler=null,de.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in pe))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?ve[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,fe([this,pe.DEBUG],t)),this._logHandler.apply(this,fe([this,pe.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,fe([this,pe.VERBOSE],t)),this._logHandler.apply(this,fe([this,pe.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,fe([this,pe.INFO],t)),this._logHandler.apply(this,fe([this,pe.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,fe([this,pe.WARN],t)),this._logHandler.apply(this,fe([this,pe.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,fe([this,pe.ERROR],t)),this._logHandler.apply(this,fe([this,pe.ERROR],t))},t}();function Ee(t){de.forEach((function(e){e.setLogLevel(t)}))}var Ie,Te=((ge={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",ge["bad-app-name"]="Illegal App name: '{$appName}",ge["duplicate-app"]="Firebase App named '{$appName}' already exists",ge["app-deleted"]="Firebase App named '{$appName}' already deleted",ge["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",ge["invalid-log-argument"]="First argument to `onLog` must be null or a function.",ge),_e=new Zt("app","Firebase",Te),Se="@firebase/app",Ae="[DEFAULT]",Ne=((Ie={})[Se]="fire-core",Ie["@firebase/analytics"]="fire-analytics",Ie["@firebase/app-check"]="fire-app-check",Ie["@firebase/auth"]="fire-auth",Ie["@firebase/database"]="fire-rtdb",Ie["@firebase/functions"]="fire-fn",Ie["@firebase/installations"]="fire-iid",Ie["@firebase/messaging"]="fire-fcm",Ie["@firebase/performance"]="fire-perf",Ie["@firebase/remote-config"]="fire-rc",Ie["@firebase/storage"]="fire-gcs",Ie["@firebase/firestore"]="fire-fst",Ie["fire-js"]="fire-js",Ie["firebase-wrapper"]="fire-js-all",Ie),De=new we("@firebase/app"),ke=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=Qt(void 0,t),this.container=new he(e.name),this._addComponent(new ae("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(t){return r._addComponent(t)}))}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){var n;void 0===e&&(e=Ae),this.checkDestroyed_();var r=this.container.getProvider(t);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=Ae),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){De.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw _e.create("app-deleted",{appName:this.name_})},t}();ke.prototype.name&&ke.prototype.options||ke.prototype.delete||console.log("dc");
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Ce(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={});if("object"!=typeof i||null===i){i={name:i}}var o=i;void 0===o.name&&(o.name=Ae);var s=o.name;if("string"!=typeof s||!s)throw _e.create("bad-app-name",{appName:String(s)});if(ne(e,s))throw _e.create("duplicate-app",{appName:s});var a=new t(n,o,r);return e[s]=a,a},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=Ne[t])&&void 0!==r?r:t;n&&(i+="-"+n);var s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return s&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),s&&a&&u.push("and"),a&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void De.warn(u.join(" "))}o(new ae(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:Ee,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw _e.create("invalid-log-argument");!function(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=ve[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:pe[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=de;r<i.length;r++)n(i[r])}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t,e)},apps:null,SDK_VERSION:"8.7.0",INTERNAL:{registerComponent:o,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){if("serverAuth"===e)return null;return e}}};function i(t){if(!ne(e,t=t||Ae))throw _e.create("no-app",{appName:t});return e[t]}function o(o){var s=o.name;if(n.has(s))return De.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===o.type?r[s]:null;if(n.set(s,o),"PUBLIC"===o.type){var a=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[s])throw _e.create("invalid-app-argument",{appName:s});return t[s]()};void 0!==o.serviceProps&&Qt(a,o.serviceProps),r[s]=a,t.prototype[s]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,s);return n.apply(this,o.multipleInstances?t:[])}}for(var u=0,c=Object.keys(e);u<c.length;u++){var l=c[u];e[l]._addComponent(o)}return"PUBLIC"===o.type?r[s]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var xe=function t(){var e=Ce(ke);return e.INTERNAL=qt(qt({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){Qt(e,t)},createSubscribe:re,ErrorFactory:Zt,deepExtend:Qt}),e}(),Re=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
if("object"==typeof self&&self.self===self&&void 0!==self.firebase){De.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var Oe=self.firebase.SDK_VERSION;Oe&&Oe.indexOf("LITE")>=0&&De.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var Le=xe.initializeApp;xe.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Yt()&&De.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),Le.apply(void 0,t)};var Pe=xe;!function(t,e){t.INTERNAL.registerComponent(new ae("platform-logger",(function(t){return new Re(t)}),"PRIVATE")),t.registerVersion(Se,"0.6.28",e),t.registerVersion("fire-js","")}(Pe);var Fe="8.8.0";
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
Pe.registerVersion("firebase",Fe,"app"),Pe.SDK_VERSION=Fe;
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var Me=function(t,e){return(Me=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function Ve(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var Ue,je="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},qe=qe||{},Be=je||self;function Ke(){}function ze(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function Ge(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var $e="closure_uid_"+(1e9*Math.random()>>>0),He=0;function Qe(t,e,n){return t.call.apply(t.bind,arguments)}function We(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function Xe(t,e,n){return(Xe=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Qe:We).apply(null,arguments)}function Ye(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Je(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function Ze(){this.s=this.s,this.o=this.o}var tn={};Ze.prototype.s=!1,Ze.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,$e)&&t[$e]||(t[$e]=++He)}(this);delete tn[t]}},Ze.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var en=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},nn=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function rn(t){return Array.prototype.concat.apply([],arguments)}function on(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function sn(t){return/^[\s\xa0]*$/.test(t)}var an,un=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function cn(t,e){return-1!=t.indexOf(e)}function ln(t,e){return t<e?-1:t>e?1:0}t:{var hn=Be.navigator;if(hn){var fn=hn.userAgent;if(fn){an=fn;break t}}an=""}function pn(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function dn(t){var e={};for(var n in t)e[n]=t[n];return e}var gn="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function vn(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<gn.length;o++)n=gn[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function yn(t){return yn[" "](t),t}yn[" "]=Ke;var mn,bn,wn=cn(an,"Opera"),En=cn(an,"Trident")||cn(an,"MSIE"),In=cn(an,"Edge"),Tn=In||En,_n=cn(an,"Gecko")&&!(cn(an.toLowerCase(),"webkit")&&!cn(an,"Edge"))&&!(cn(an,"Trident")||cn(an,"MSIE"))&&!cn(an,"Edge"),Sn=cn(an.toLowerCase(),"webkit")&&!cn(an,"Edge");function An(){var t=Be.document;return t?t.documentMode:void 0}t:{var Nn="",Dn=(bn=an,_n?/rv:([^\);]+)(\)|;)/.exec(bn):In?/Edge\/([\d\.]+)/.exec(bn):En?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(bn):Sn?/WebKit\/(\S+)/.exec(bn):wn?/(?:Version)[ \/]?(\S+)/.exec(bn):void 0);if(Dn&&(Nn=Dn?Dn[1]:""),En){var kn=An();if(null!=kn&&kn>parseFloat(Nn)){mn=String(kn);break t}}mn=Nn}var Cn,xn={};function Rn(){return function(t){var e=xn;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}((function(){for(var t=0,e=un(String(mn)).split("."),n=un("9").split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=ln(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||ln(0==o[2].length,0==s[2].length)||ln(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t}))}if(Be.document&&En){var On=An();Cn=On||(parseInt(mn,10)||void 0)}else Cn=void 0;var Ln=Cn,Pn=function(){if(!Be.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{Be.addEventListener("test",Ke,e),Be.removeEventListener("test",Ke,e)}catch(t){}return t}();function Fn(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function Mn(t,e){if(Fn.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(_n){t:{try{yn(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Vn[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Mn.Z.h.call(this)}}Fn.prototype.h=function(){this.defaultPrevented=!0},Je(Mn,Fn);var Vn={2:"touch",3:"pen",4:"mouse"};Mn.prototype.h=function(){Mn.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Un="closure_listenable_"+(1e6*Math.random()|0),jn=0;function qn(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=i,this.key=++jn,this.ca=this.fa=!1}function Bn(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function Kn(t){this.src=t,this.g={},this.h=0}function zn(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],o=en(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Bn(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function Gn(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ca&&o.listener==e&&o.capture==!!n&&o.ia==r)return i}return-1}Kn.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.g[o])||(t=this.g[o]=[],this.h++);var s=Gn(t,e,r,i);return-1<s?(e=t[s],n||(e.fa=!1)):((e=new qn(e,this.src,o,!!r,i)).fa=n,t.push(e)),e};var $n="closure_lm_"+(1e6*Math.random()|0),Hn={};function Qn(t,e,n,r,i){if(r&&r.once)return Xn(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Qn(t,e[o],n,r,i);return null}return n=rr(n),t&&t[Un]?t.N(e,n,Ge(r)?!!r.capture:!!r,i):Wn(t,e,n,!1,r,i)}function Wn(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=Ge(i)?!!i.capture:!!i,a=er(t);if(a||(t[$n]=a=new Kn(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){function t(n){return e.call(t.src,t.listener,n)}var e=tr;return t}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Pn||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Zn(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Xn(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)Xn(t,e[o],n,r,i);return null}return n=rr(n),t&&t[Un]?t.O(e,n,Ge(r)?!!r.capture:!!r,i):Wn(t,e,n,!0,r,i)}function Yn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Yn(t,e[o],n,r,i);else r=Ge(r)?!!r.capture:!!r,n=rr(n),t&&t[Un]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(n=Gn(o=t.g[e],n,r,i))&&(Bn(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.g[e],t.h--)))):t&&(t=er(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Gn(e,n,r,i)),(n=-1<t?e[t]:null)&&Jn(n))}function Jn(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[Un])zn(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Zn(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=er(e))?(zn(n,t),0==n.h&&(n.src=null,e[$n]=null)):Bn(t)}}}function Zn(t){return t in Hn?Hn[t]:Hn[t]="on"+t}function tr(t,e){if(t.ca)t=!0;else{e=new Mn(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&Jn(t),t=n.call(r,e)}return t}function er(t){return(t=t[$n])instanceof Kn?t:null}var nr="__closure_events_fn_"+(1e9*Math.random()>>>0);function rr(t){return"function"==typeof t?t:(t[nr]||(t[nr]=function(e){return t.handleEvent(e)}),t[nr])}function ir(){Ze.call(this),this.i=new Kn(this),this.P=this,this.I=null}function or(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,"string"==typeof e)e=new Fn(e,t);else if(e instanceof Fn)e.target=e.target||t;else{var i=e;vn(e=new Fn(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.g=n[o];i=sr(s,r,!0,e)&&i}if(i=sr(s=e.g=t,r,!0,e)&&i,i=sr(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=sr(s=e.g=n[o],r,!1,e)&&i}function sr(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.ca&&s.capture==n){var a=s.listener,u=s.ia||s.src;s.fa&&zn(t.i,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}Je(ir,Ze),ir.prototype[Un]=!0,ir.prototype.removeEventListener=function(t,e,n,r){Yn(this,t,e,n,r)},ir.prototype.M=function(){if(ir.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)Bn(n[r]);delete e.g[t],e.h--}}this.I=null},ir.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},ir.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var ar=Be.JSON.stringify;function ur(){var t=vr,e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var cr,lr=function(){function t(){this.h=this.g=null}return t.prototype.add=function(t,e){var n=hr.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n},t}(),hr=new(function(){function t(t,e){this.i=t,this.j=e,this.h=0,this.g=null}return t.prototype.get=function(){var t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t},t}())((function(){return new fr}),(function(t){return t.reset()})),fr=function(){function t(){this.next=this.g=this.h=null}return t.prototype.set=function(t,e){this.h=t,this.g=e,this.next=null},t.prototype.reset=function(){this.next=this.g=this.h=null},t}();function pr(t){Be.setTimeout((function(){throw t}),0)}function dr(t,e){cr||function(){var t=Be.Promise.resolve(void 0);cr=function(){t.then(yr)}}(),gr||(cr(),gr=!0),vr.add(t,e)}var gr=!1,vr=new lr;function yr(){for(var t;t=ur();){try{t.h.call(t.g)}catch(t){pr(t)}var e=hr;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}gr=!1}function mr(t,e){ir.call(this),this.h=t||1,this.g=e||Be,this.j=Xe(this.kb,this),this.l=Date.now()}function br(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function wr(t,e,n){if("function"==typeof t)n&&(t=Xe(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=Xe(t.handleEvent,t)}return 2147483647<Number(e)?-1:Be.setTimeout(t,e||0)}function Er(t){t.g=wr((function(){t.g=null,t.i&&(t.i=!1,Er(t))}),t.j);var e=t.h;t.h=null,t.m.apply(null,e)}Je(mr,ir),(Ue=mr.prototype).da=!1,Ue.S=null,Ue.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),or(this,"tick"),this.da&&(br(this),this.start()))}},Ue.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Ue.M=function(){mr.Z.M.call(this),br(this),delete this.g};var Ir=function(t){function e(e,n){var r=t.call(this)||this;return r.m=e,r.j=n,r.h=null,r.i=!1,r.g=null,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Me(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.l=function(t){this.h=arguments,this.g?this.i=!0:Er(this)},e.prototype.M=function(){t.prototype.M.call(this),this.g&&(Be.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},e}(Ze);function Tr(t){Ze.call(this),this.h=t,this.g={}}Je(Tr,Ze);var _r=[];function Sr(t,e,n,r){Array.isArray(n)||(n&&(_r[0]=n.toString()),n=_r);for(var i=0;i<n.length;i++){var o=Qn(e,n[i],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}}function Ar(t){pn(t.g,(function(t,e){this.g.hasOwnProperty(e)&&Jn(t)}),t),t.g={}}function Nr(){this.g=!0}function Dr(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return ar(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}Tr.prototype.M=function(){Tr.Z.M.call(this),Ar(this)},Tr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Nr.prototype.Aa=function(){this.g=!1},Nr.prototype.info=function(){};var kr={},Cr=null;function xr(){return Cr=Cr||new ir}function Rr(t){Fn.call(this,kr.Ma,t)}function Or(t){var e=xr();or(e,new Rr(e,t))}function Lr(t,e){Fn.call(this,kr.STAT_EVENT,t),this.stat=e}function Pr(t){var e=xr();or(e,new Lr(e,t))}function Fr(t,e){Fn.call(this,kr.Na,t),this.size=e}function Mr(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Be.setTimeout((function(){t()}),e)}kr.Ma="serverreachability",Je(Rr,Fn),kr.STAT_EVENT="statevent",Je(Lr,Fn),kr.Na="timingevent",Je(Fr,Fn);var Vr={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Ur={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function jr(){}function qr(t){return t.h||(t.h=t.i())}function Br(){}jr.prototype.h=null;var Kr,zr={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function Gr(){Fn.call(this,"d")}function $r(){Fn.call(this,"c")}function Hr(){}function Qr(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new Tr(this),this.P=Xr,t=Tn?125:void 0,this.W=new mr(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new Wr}function Wr(){this.i=null,this.g="",this.h=!1}Je(Gr,Fn),Je($r,Fn),Je(Hr,jr),Hr.prototype.g=function(){return new XMLHttpRequest},Hr.prototype.i=function(){return{}},Kr=new Hr;var Xr=45e3,Yr={},Jr={};function Zr(t,e,n){t.K=1,t.v=Ii(vi(e)),t.s=n,t.U=!0,ti(t,null)}function ti(t,e){t.F=Date.now(),ii(t),t.A=vi(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),Pi(n.h,"t",r),t.C=0,n=t.l.H,t.h=new Wr,t.g=Mo(t.l,n?e:null,!t.s),0<t.O&&(t.L=new Ir(Xe(t.Ia,t,t.g),t.O)),Sr(t.V,t.g,"readystatechange",t.gb),e=t.H?dn(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),Or(1),function(t,e,n,r,i,o){t.info((function(){if(t.g)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");s=2<=h.length&&"type"==h[1]?s+(l+"=")+c+"&":s+(l+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}(t.j,t.u,t.A,t.m,t.X,t.s)}function ei(t){return!!t.g&&("GET"==t.u&&2!=t.K&&t.l.Ba)}function ni(t,e,n){for(var r,i=!0;!t.I&&t.C<n.length;){if((r=ri(t,n))==Jr){4==e&&(t.o=4,Pr(14),i=!1),Dr(t.j,t.m,null,"[Incomplete Response]");break}if(r==Yr){t.o=4,Pr(15),Dr(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}Dr(t.j,t.m,r,null),ci(t,r)}ei(t)&&r!=Jr&&r!=Yr&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,Pr(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),ko(e),e.L=!0,Pr(11))):(Dr(t.j,t.m,n,"[Invalid Chunked Response]"),ui(t),ai(t))}function ri(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?Jr:(n=Number(e.substring(n,r)),isNaN(n)?Yr:(r+=1)+n>e.length?Jr:(e=e.substr(r,n),t.C=r+n,e))}function ii(t){t.Y=Date.now()+t.P,oi(t,t.P)}function oi(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Mr(Xe(t.eb,t),e)}function si(t){t.B&&(Be.clearTimeout(t.B),t.B=null)}function ai(t){0==t.l.G||t.I||Ro(t.l,t)}function ui(t){si(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,br(t.W),Ar(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function ci(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||Bi(n.i,t)))if(n.I=t.N,!t.J&&Bi(n.i,t)&&3==n.G){try{var r=n.Ca.g.parse(e)}catch(o){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;xo(n),wo(n)}Do(n),Pr(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=Mr(Xe(n.ab,n),6e3));if(1>=qi(n.i)&&n.ka){try{n.ka()}catch(o){}n.ka=void 0}}else Lo(n,11)}else if((t.J||n.g==t)&&xo(n),!sn(e))for(i=n.Ca.g.parse(e),e=0;e<i.length;e++){var o=i[e];if(n.U=o[0],o=o[1],2==n.G)if("c"==o[0]){n.J=o[1],n.la=o[2];var s=o[3];null!=s&&(n.ma=s,n.h.info("VER="+n.ma));var a=o[4];null!=a&&(n.za=a,n.h.info("SVER="+n.za));var u=o[5];null!=u&&"number"==typeof u&&0<u&&(r=1.5*u,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=t.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.i;!h.g&&(cn(l,"spdy")||cn(l,"quic")||cn(l,"h2"))&&(h.j=h.l,h.g=new Set,h.h&&(Ki(h,h.h),h.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,Ei(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var p=t;if((r=n).oa=Fo(r,r.H?r.la:null,r.W),p.J){zi(r.i,p);var d=p,g=r.K;g&&d.setTimeout(g),d.B&&(si(d),ii(d)),r.g=p}else No(r);0<n.l.length&&To(n)}else"stop"!=o[0]&&"close"!=o[0]||Lo(n,7);else 3==n.G&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?Lo(n,7):bo(n):"noop"!=o[0]&&n.j&&n.j.wa(o),n.A=0)}Or(4)}catch(o){}}function li(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(ze(t)||"string"==typeof t)nn(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(ze(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(ze(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function hi(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof hi)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function fi(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];pi(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var i={};for(n=e=0;e<t.g.length;)pi(i,r=t.g[e])||(t.g[n++]=r,i[r]=1),e++;t.g.length=n}}function pi(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(Ue=Qr.prototype).setTimeout=function(t){this.P=t},Ue.gb=function(t){t=t.target;var e=this.L;e&&3==po(t)?e.l():this.Ia(t)},Ue.Ia=function(t){try{if(t==this.g)t:{var e=po(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>e)&&(3!=e||Tn||this.g&&(this.h.h||this.g.ga()||go(this.g)))){this.I||4!=e||7==n||Or(8==n||0>=r?3:2),si(this);var i=this.g.ba();this.N=i;e:if(ei(this)){var o=go(this.g);t="";var s=o.length,a=4==po(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){ui(this),ai(this);var u="";break e}this.h.i=new Be.TextDecoder}for(n=0;n<s;n++)this.h.h=!0,t+=this.h.i.decode(o[n],{stream:a&&n==s-1});o.splice(0,s),this.h.g+=t,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}(this.j,this.u,this.A,this.m,this.X,e,i),this.i){if(this.$&&!this.J){e:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!sn(c)){var h=c;break e}}h=null}if(!(i=h)){this.i=!1,this.o=3,Pr(12),ui(this),ai(this);break t}Dr(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,ci(this,i)}this.U?(ni(this,e,u),Tn&&this.i&&3==e&&(Sr(this.V,this.W,"tick",this.fb),this.W.start())):(Dr(this.j,this.m,u,null),ci(this,u)),4==e&&ui(this),this.i&&!this.I&&(4==e?Ro(this.l,this):(this.i=!1,ii(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,Pr(12)):(this.o=0,Pr(13)),ui(this),ai(this)}}}catch(e){}},Ue.fb=function(){if(this.g){var t=po(this.g),e=this.g.ga();this.C<e.length&&(si(this),ni(this,t,e),this.i&&4!=t&&ii(this))}},Ue.cancel=function(){this.I=!0,ui(this)},Ue.eb=function(){this.B=null;var t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(Or(3),Pr(17)),ui(this),this.o=2,ai(this)):oi(this,this.Y-t)},(Ue=hi.prototype).R=function(){fi(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},Ue.T=function(){return fi(this),this.g.concat()},Ue.get=function(t,e){return pi(this.h,t)?this.h[t]:e},Ue.set=function(t,e){pi(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},Ue.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var di=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function gi(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof gi){this.g=void 0!==e?e:t.g,yi(this,t.j),this.s=t.s,mi(this,t.i),bi(this,t.m),this.l=t.l,e=t.h;var n=new xi;n.i=e.i,e.g&&(n.g=new hi(e.g),n.h=e.h),wi(this,n),this.o=t.o}else t&&(n=String(t).match(di))?(this.g=!!e,yi(this,n[1]||"",!0),this.s=Ti(n[2]||""),mi(this,n[3]||"",!0),bi(this,n[4]),this.l=Ti(n[5]||"",!0),wi(this,n[6]||"",!0),this.o=Ti(n[7]||"")):(this.g=!!e,this.h=new xi(null,this.g))}function vi(t){return new gi(t)}function yi(t,e,n){t.j=n?Ti(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function mi(t,e,n){t.i=n?Ti(e,!0):e}function bi(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function wi(t,e,n){e instanceof xi?(t.h=e,function(t,e){e&&!t.j&&(Ri(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Oi(this,e),Pi(this,n,t))}),t)),t.j=e}(t.h,t.g)):(n||(e=_i(e,ki)),t.h=new xi(e,t.g))}function Ei(t,e,n){t.h.set(e,n)}function Ii(t){return Ei(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Ti(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function _i(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Si),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Si(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}gi.prototype.toString=function(){var t=[],e=this.j;e&&t.push(_i(e,Ai,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(_i(e,Ai,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(_i(n,"/"==n.charAt(0)?Di:Ni,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",_i(n,Ci)),t.join("")};var Ai=/[#\/\?@]/g,Ni=/[#\?:]/g,Di=/[#\?]/g,ki=/[#\?@]/g,Ci=/#/g;function xi(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Ri(t){t.g||(t.g=new hi,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Oi(t,e){Ri(t),e=Fi(t,e),pi(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,pi((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&fi(t)))}function Li(t,e){return Ri(t),e=Fi(t,e),pi(t.g.h,e)}function Pi(t,e,n){Oi(t,e),0<n.length&&(t.i=null,t.g.set(Fi(t,e),on(n)),t.h+=n.length)}function Fi(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(Ue=xi.prototype).add=function(t,e){Ri(this),this.i=null,t=Fi(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},Ue.forEach=function(t,e){Ri(this),this.g.forEach((function(n,r){nn(n,(function(n){t.call(e,n,r,this)}),this)}),this)},Ue.T=function(){Ri(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},Ue.R=function(t){Ri(this);var e=[];if("string"==typeof t)Li(this,t)&&(e=rn(e,this.g.get(Fi(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=rn(e,t[n])}return e},Ue.set=function(t,e){return Ri(this),this.i=null,Li(this,t=Fi(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},Ue.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},Ue.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.R(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.i=t.join("&")};var Mi=function(t,e){this.h=t,this.g=e};function Vi(t){this.l=t||Ui,Be.PerformanceNavigationTiming?t=0<(t=Be.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(Be.g&&Be.g.Ea&&Be.g.Ea()&&Be.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Ui=10;function ji(t){return!!t.h||!!t.g&&t.g.size>=t.j}function qi(t){return t.h?1:t.g?t.g.size:0}function Bi(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function Ki(t,e){t.g?t.g.add(e):t.h=e}function zi(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Gi(t){var e,n;if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){var r=t.i;try{for(var i=Ve(t.g.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.D)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return on(t.i)}function $i(){}function Hi(){this.g=new $i}function Qi(t,e,n){var r=n||"";try{li(t,(function(t,n){var i=t;Ge(t)&&(i=ar(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function Wi(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}function Xi(t){this.l=t.$b||null,this.j=t.ib||!1}function Yi(t,e){ir.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=Ji,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Vi.prototype.cancel=function(){var t,e;if(this.i=Gi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=Ve(this.g.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.g.clear()}},$i.prototype.stringify=function(t){return Be.JSON.stringify(t,void 0)},$i.prototype.parse=function(t){return Be.JSON.parse(t,void 0)},Je(Xi,jr),Xi.prototype.g=function(){return new Yi(this.l,this.j)},Xi.prototype.i=function(t){return function(){return t}}({}),Je(Yi,ir);var Ji=0;function Zi(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function to(t){t.readyState=4,t.l=null,t.j=null,t.A=null,eo(t)}function eo(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(Ue=Yi.prototype).open=function(t,e){if(this.readyState!=Ji)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,eo(this)},Ue.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||Be).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},Ue.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,to(this)),this.readyState=Ji},Ue.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,eo(this)),this.g&&(this.readyState=3,eo(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==Be.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Zi(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},Ue.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?to(this):eo(this),3==this.readyState&&Zi(this)}},Ue.Ua=function(t){this.g&&(this.response=this.responseText=t,to(this))},Ue.Ta=function(t){this.g&&(this.response=t,to(this))},Ue.ha=function(){this.g&&to(this)},Ue.setRequestHeader=function(t,e){this.v.append(t,e)},Ue.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},Ue.getAllResponseHeaders=function(){if(!this.h)return"";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Yi.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var no=Be.JSON.parse;function ro(t){ir.call(this),this.headers=new hi,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=io,this.K=this.L=!1}Je(ro,ir);var io="",oo=/^https?$/i,so=["POST","PUT"];function ao(t){return"content-type"==t.toLowerCase()}function uo(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,co(t),ho(t)}function co(t){t.D||(t.D=!0,or(t,"complete"),or(t,"error"))}function lo(t){if(t.h&&void 0!==qe&&(!t.C[1]||4!=po(t)||2!=t.ba()))if(t.v&&4==po(t))wr(t.Fa,0,t);else if(or(t,"readystatechange"),4==po(t)){t.h=!1;try{var e,n=t.ba();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.H).match(di)[1]||null;if(!o&&Be.self&&Be.self.location){var s=Be.self.location.protocol;o=s.substr(0,s.length-1)}i=!oo.test(o?o.toLowerCase():"")}e=i}if(e)or(t,"complete"),or(t,"success");else{t.m=6;try{var a=2<po(t)?t.g.statusText:""}catch(t){a=""}t.j=a+" ["+t.ba()+"]",co(t)}}finally{ho(t)}}}function ho(t,e){if(t.g){fo(t);var n=t.g,r=t.C[0]?Ke:null;t.g=null,t.C=null,e||or(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function fo(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(Be.clearTimeout(t.A),t.A=null)}function po(t){return t.g?t.g.readyState:0}function go(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case io:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function vo(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return pn(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ei(t,e,n))}function yo(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function mo(t){this.za=0,this.l=[],this.h=new Nr,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=yo("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=yo("baseRetryDelayMs",5e3,t),this.$a=yo("retryDelaySeedMs",1e4,t),this.Ya=yo("forwardChannelMaxRetries",2,t),this.ra=yo("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new Vi(t&&t.concurrentRequestLimit),this.Ca=new Hi,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function bo(t){if(Eo(t),3==t.G){var e=t.V++,n=vi(t.F);Ei(n,"SID",t.J),Ei(n,"RID",e),Ei(n,"TYPE","terminate"),So(t,n),(e=new Qr(t,t.h,e,void 0)).K=2,e.v=Ii(vi(n)),n=!1,Be.navigator&&Be.navigator.sendBeacon&&(n=Be.navigator.sendBeacon(e.v.toString(),"")),!n&&Be.Image&&((new Image).src=e.v,n=!0),n||(e.g=Mo(e.l,null),e.g.ea(e.v)),e.F=Date.now(),ii(e)}Po(t)}function wo(t){t.g&&(ko(t),t.g.cancel(),t.g=null)}function Eo(t){wo(t),t.u&&(Be.clearTimeout(t.u),t.u=null),xo(t),t.i.cancel(),t.m&&("number"==typeof t.m&&Be.clearTimeout(t.m),t.m=null)}function Io(t,e){t.l.push(new Mi(t.Za++,e)),3==t.G&&To(t)}function To(t){ji(t.i)||t.m||(t.m=!0,dr(t.Ha,t),t.C=0)}function _o(t,e){var n;n=e?e.m:t.V++;var r=vi(t.F);Ei(r,"SID",t.J),Ei(r,"RID",n),Ei(r,"AID",t.U),So(t,r),t.o&&t.s&&vo(r,t.o,t.s),n=new Qr(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=Ao(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),Ki(t.i,n),Zr(n,r,e)}function So(t,e){t.j&&li({},(function(t,n){Ei(e,n,t)}))}function Ao(t,e,n){n=Math.min(t.l.length,n);var r=t.j?Xe(t.j.Oa,t.j,t):null;t:for(var i=t.l,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].h,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].h,l=i[u].g;if(0>(c-=o))o=Math.max(0,i[u].h-100),a=!1;else try{Qi(l,s,"req"+c+"_")}catch(t){r&&r(l)}}if(a){r=s.join("&");break t}}return t=t.l.splice(0,n),e.D=t,r}function No(t){t.g||t.u||(t.Y=1,dr(t.Ga,t),t.A=0)}function Do(t){return!(t.g||t.u||3<=t.A)&&(t.Y++,t.u=Mr(Xe(t.Ga,t),Oo(t,t.A)),t.A++,!0)}function ko(t){null!=t.B&&(Be.clearTimeout(t.B),t.B=null)}function Co(t){t.g=new Qr(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=vi(t.oa);Ei(e,"RID","rpc"),Ei(e,"SID",t.J),Ei(e,"CI",t.N?"0":"1"),Ei(e,"AID",t.U),So(t,e),Ei(e,"TYPE","xmlhttp"),t.o&&t.s&&vo(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=Ii(vi(e)),n.s=null,n.U=!0,ti(n,t)}function xo(t){null!=t.v&&(Be.clearTimeout(t.v),t.v=null)}function Ro(t,e){var n=null;if(t.g==e){xo(t),ko(t),t.g=null;var r=2}else{if(!Bi(t.i,e))return;n=e.D,zi(t.i,e),r=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==r){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;or(r=xr(),new Fr(r,n,e,i)),To(t)}else No(t);else if(3==(i=e.o)||0==i&&0<t.I||!(1==r&&function(t,e){return!(qi(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.l=e.D.concat(t.l),0):1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya)||(t.m=Mr(Xe(t.Ha,t,e),Oo(t,t.C)),t.C++,0)))}(t,e)||2==r&&Do(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Lo(t,5);break;case 4:Lo(t,10);break;case 3:Lo(t,6);break;default:Lo(t,2)}}function Oo(t,e){var n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function Lo(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var r=Xe(t.jb,t);n||(n=new gi("//www.google.com/images/cleardot.gif"),Be.location&&"http"==Be.location.protocol||yi(n,"https"),Ii(n)),function(t,e){var n=new Nr;if(Be.Image){var r=new Image;r.onload=Ye(Wi,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Ye(Wi,n,r,"TestLoadImage: error",!1,e),r.onabort=Ye(Wi,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Ye(Wi,n,r,"TestLoadImage: timeout",!1,e),Be.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else Pr(2);t.G=0,t.j&&t.j.va(e),Po(t),Eo(t)}function Po(t){t.G=0,t.I=-1,t.j&&(0==Gi(t.i).length&&0==t.l.length||(t.i.i.length=0,on(t.l),t.l.length=0),t.j.ua())}function Fo(t,e,n){var r=function(t){return t instanceof gi?vi(t):new gi(t,void 0)}(n);if(""!=r.i)e&&mi(r,e+"."+r.i),bi(r,r.m);else{var i=Be.location;r=function(t,e,n,r){var i=new gi(null,void 0);return t&&yi(i,t),e&&mi(i,e),n&&bi(i,n),r&&(i.l=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.aa&&pn(t.aa,(function(t,e){Ei(r,e,t)})),e=t.D,n=t.sa,e&&n&&Ei(r,e,n),Ei(r,"VER",t.ma),So(t,r),r}function Mo(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ba&&!t.qa?new ro(new Xi({ib:!0})):new ro(t.qa)).L=t.H,e}function Vo(){}function Uo(){if(En&&!(10<=Number(Ln)))throw Error("Environmental error: no available transport.")}function jo(t,e){ir.call(this),this.g=new mo(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!sn(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!sn(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new Ko(this)}function qo(t){Gr.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Bo(){$r.call(this),this.status=1}function Ko(t){this.g=t}(Ue=ro.prototype).ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Kr.g(),this.C=this.u?qr(this.u):qr(Kr),this.g.onreadystatechange=Xe(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(t){return void uo(this,t)}t=n||"";var i=new hi(this.headers);r&&li(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=ao,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.T()),n=Be.FormData&&t instanceof Be.FormData,!(0<=en(so,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.g.setRequestHeader(e,t)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{fo(this),0<this.B&&((this.K=function(t){return En&&Rn()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Xe(this.pa,this)):this.A=wr(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){uo(this,t)}},Ue.pa=function(){void 0!==qe&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,or(this,"timeout"),this.abort(8))},Ue.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,or(this,"complete"),or(this,"abort"),ho(this))},Ue.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),ho(this,!0)),ro.Z.M.call(this)},Ue.Fa=function(){this.s||(this.F||this.v||this.l?lo(this):this.cb())},Ue.cb=function(){lo(this)},Ue.ba=function(){try{return 2<po(this)?this.g.status:-1}catch(t){return-1}},Ue.ga=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},Ue.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),no(e)}},Ue.Da=function(){return this.m},Ue.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(Ue=mo.prototype).ma=8,Ue.G=1,Ue.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(t){}},Ue.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;var e=new Qr(this,this.h,t,void 0),n=this.s;if(this.P&&(n?vn(n=dn(n),this.P):n=this.P),null===this.o&&(e.H=n),this.ja)t:{for(var r=0,i=0;i<this.l.length;i++){var o=this.l[i];if(void 0===(o="__data__"in o.g&&"string"==typeof(o=o.g.__data__)?o.length:void 0))break;if(4096<(r+=o)){r=i;break t}if(4096===r||i===this.l.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=Ao(this,e,r),Ei(i=vi(this.F),"RID",t),Ei(i,"CVER",22),this.D&&Ei(i,"X-HTTP-Session-Id",this.D),So(this,i),this.o&&n&&vo(i,this.o,n),Ki(this.i,e),this.Ra&&Ei(i,"TYPE","init"),this.ja?(Ei(i,"$req",r),Ei(i,"SID","null"),e.$=!0,Zr(e,i,null)):Zr(e,i,r),this.G=2}}else 3==this.G&&(t?_o(this,t):0==this.l.length||ji(this.i)||_o(this))},Ue.Ga=function(){if(this.u=null,Co(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=Mr(Xe(this.bb,this),t)}},Ue.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Pr(10),wo(this),Co(this))},Ue.ab=function(){null!=this.v&&(this.v=null,wo(this),Do(this),Pr(19))},Ue.jb=function(t){t?(this.h.info("Successfully pinged google.com"),Pr(2)):(this.h.info("Failed to ping google.com"),Pr(1))},(Ue=Vo.prototype).xa=function(){},Ue.wa=function(){},Ue.va=function(){},Ue.ua=function(){},Ue.Oa=function(){},Uo.prototype.g=function(t,e){return new jo(t,e)},Je(jo,ir),jo.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),dr(Xe(t.hb,t,e))),Pr(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=Fo(t,null,t.W),To(t)},jo.prototype.close=function(){bo(this.g)},jo.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,Io(this.g,e)}else this.v?((e={}).__data__=ar(t),Io(this.g,e)):Io(this.g,t)},jo.prototype.M=function(){this.g.j=null,delete this.j,bo(this.g),delete this.g,jo.Z.M.call(this)},Je(qo,Gr),Je(Bo,$r),Je(Ko,Vo),Ko.prototype.xa=function(){or(this.g,"a")},Ko.prototype.wa=function(t){or(this.g,new qo(t))},Ko.prototype.va=function(t){or(this.g,new Bo(t))},Ko.prototype.ua=function(){or(this.g,"b")},Uo.prototype.createWebChannel=Uo.prototype.g,jo.prototype.send=jo.prototype.u,jo.prototype.open=jo.prototype.m,jo.prototype.close=jo.prototype.close,Vr.NO_ERROR=0,Vr.TIMEOUT=8,Vr.HTTP_ERROR=6,Ur.COMPLETE="complete",Br.EventType=zr,zr.OPEN="a",zr.CLOSE="b",zr.ERROR="c",zr.MESSAGE="d",ir.prototype.listen=ir.prototype.N,ro.prototype.listenOnce=ro.prototype.O,ro.prototype.getLastError=ro.prototype.La,ro.prototype.getLastErrorCode=ro.prototype.Da,ro.prototype.getStatus=ro.prototype.ba,ro.prototype.getResponseJson=ro.prototype.Qa,ro.prototype.getResponseText=ro.prototype.ga,ro.prototype.send=ro.prototype.ea;var zo=Vr,Go=Ur,$o=kr,Ho=10,Qo=11,Wo=Xi,Xo=Br,Yo=ro,Jo=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();Jo.o=-1;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Zo={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},ts=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return jt(e,t),e}(Error),es=new we("@firebase/firestore");function ns(){return es.logLevel}function rs(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(es.logLevel<=pe.DEBUG){var r=e.map(ss);es.debug.apply(es,$t(["Firestore (8.8.0): "+t],r))}}function is(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(es.logLevel<=pe.ERROR){var r=e.map(ss);es.error.apply(es,$t(["Firestore (8.8.0): "+t],r))}}function os(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(es.logLevel<=pe.WARN){var r=e.map(ss);es.warn.apply(es,$t(["Firestore (8.8.0): "+t],r))}}function ss(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function as(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.8.0) INTERNAL ASSERTION FAILED: "+t;throw is(e),new Error(e)}function us(t,e){t||as()}function cs(t,e){return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ls(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var hs=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=ls(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function fs(t,e){return t<e?-1:t>e?1:0}function ps(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function ds(t){return t+"\0"}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var gs=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new ts(Zo.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new ts(Zo.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new ts(Zo.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new ts(Zo.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?fs(this.nanoseconds,t.nanoseconds):fs(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),vs=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new gs(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ys(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ms(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function bs(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ws=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&as(),void 0===n?n=t.length-e:n>t.length-e&&as(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),Es=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return jt(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new ts(Zo.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.emptyPath=function(){return new e([])},e}(ws),Is=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ts=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return jt(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return Is.test(t)},e.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new ts(Zo.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new ts(Zo.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new ts(Zo.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new ts(Zo.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(ws),_s=function(){function t(t){this.fields=t,t.sort(Ts.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return ps(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),Ss=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return fs(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();Ss.EMPTY_BYTE_STRING=new Ss("");var As=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ns(t){if(us(!!t),"string"==typeof t){var e=0,n=As.exec(t);if(us(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Ds(t.seconds),nanos:Ds(t.nanos)}}function Ds(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function ks(t){return"string"==typeof t?Ss.fromBase64String(t):Ss.fromUint8Array(t)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Cs(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function xs(t){var e=t.mapValue.fields.__previous_value__;return Cs(e)?xs(e):e}function Rs(t){var e=Ns(t.mapValue.fields.__local_write_time__.timestampValue);return new gs(e.seconds,e.nanos)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Os(t){return null==t}function Ls(t){return 0===t&&1/t==-1/0}function Ps(t){return"number"==typeof t&&Number.isInteger(t)&&!Ls(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Fs=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(Es.fromString(e))},t.fromName=function(e){return new t(Es.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===Es.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return Es.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new Es(e.slice()))},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ms(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Cs(t)?4:10:as()}function Vs(t,e){var n=Ms(t);if(n!==Ms(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Rs(t).isEqual(Rs(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=Ns(t.timestampValue),r=Ns(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return ks(t.bytesValue).isEqual(ks(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Ds(t.geoPointValue.latitude)===Ds(e.geoPointValue.latitude)&&Ds(t.geoPointValue.longitude)===Ds(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Ds(t.integerValue)===Ds(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Ds(t.doubleValue),r=Ds(e.doubleValue);return n===r?Ls(n)===Ls(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return ps(t.arrayValue.values||[],e.arrayValue.values||[],Vs);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(ys(n)!==ys(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Vs(n[i],r[i])))return!1;return!0}(t,e);default:return as()}}function Us(t,e){return void 0!==(t.values||[]).find((function(t){return Vs(t,e)}))}function js(t,e){var n=Ms(t),r=Ms(e);if(n!==r)return fs(n,r);switch(n){case 0:return 0;case 1:return fs(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=Ds(t.integerValue||t.doubleValue),r=Ds(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return qs(t.timestampValue,e.timestampValue);case 4:return qs(Rs(t),Rs(e));case 5:return fs(t.stringValue,e.stringValue);case 6:return function(t,e){var n=ks(t),r=ks(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=fs(n[i],r[i]);if(0!==o)return o}return fs(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=fs(Ds(t.latitude),Ds(e.latitude));return 0!==n?n:fs(Ds(t.longitude),Ds(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=js(n[i],r[i]);if(o)return o}return fs(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=fs(r[s],o[s]);if(0!==a)return a;var u=js(n[r[s]],i[o[s]]);if(0!==u)return u}return fs(r.length,o.length)}(t.mapValue,e.mapValue);default:throw as()}}function qs(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return fs(t,e);var n=Ns(t),r=Ns(e),i=fs(n.seconds,r.seconds);return 0!==i?i:fs(n.nanos,r.nanos)}function Bs(t){return Ks(t)}function Ks(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=Ns(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?ks(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Fs.fromName(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=Ks(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+Ks(t.fields[o])}return e+"}"}(t.mapValue):as();var e,n}function zs(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function Gs(t){return!!t&&"integerValue"in t}function $s(t){return!!t&&"arrayValue"in t}function Hs(t){return!!t&&"nullValue"in t}function Qs(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ws(t){return!!t&&"mapValue"in t}function Xs(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){var e={mapValue:{fields:{}}};return ms(t.mapValue.fields,(function(t,n){return e.mapValue.fields[t]=Xs(n)})),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=Xs(t.arrayValue.values[r]);return n}return Object.assign({},t)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ys=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!Ws(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Xs(e)},t.prototype.setAll=function(t){var e=this,n=Ts.emptyPath(),r={},i=[];t.forEach((function(t,o){if(!n.isImmediateParentOf(o)){var s=e.getFieldsMap(n);e.applyChanges(s,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=Xs(t):i.push(o.lastSegment())}));var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());Ws(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return Vs(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];Ws(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){ms(e,(function(e,n){return t[e]=n}));for(var r=0,i=n;r<i.length;r++){var o=i[r];delete t[o]}},t.prototype.clone=function(){return new t(Xs(this.value))},t}();function Js(t){var e=[];return ms(t.fields,(function(t,n){var r=new Ts([t]);if(Ws(n)){var i=Js(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var a=s[o];e.push(r.child(a))}}else e.push(r)})),new _s(e)
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var Zs=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,vs.min(),Ys.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,Ys.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,Ys.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=Ys.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=Ys.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),ta=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ea(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new ta(t,e,n,r,i,o,s)}function na(t){var e=cs(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.canonicalString()+t.op.toString()+Bs(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.canonicalString()+t.dir}(t)})).join(","),Os(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=ga(e.startAt)),e.endAt&&(n+="|ub:",n+=ga(e.endAt)),e.h=n}return e.h}function ra(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!ya(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!Vs(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ba(t.startAt,e.startAt)&&ba(t.endAt,e.endAt)}function ia(t){return Fs.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var oa=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return jt(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new sa(t,n,r):"array-contains"===n?new la(t,r):"in"===n?new ha(t,r):"not-in"===n?new fa(t,r):"array-contains-any"===n?new pa(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new aa(t,n):new ua(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(js(e,this.value)):null!==e&&Ms(this.value)===Ms(e)&&this.m(js(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return as()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),sa=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Fs.fromName(r.referenceValue),i}return jt(e,t),e.prototype.matches=function(t){var e=Fs.comparator(t.key,this.key);return this.m(e)},e}(oa),aa=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=ca("in",n),r}return jt(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(oa),ua=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=ca("not-in",n),r}return jt(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(oa);function ca(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return Fs.fromName(t.referenceValue)}))}var la=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return jt(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return $s(e)&&Us(e.arrayValue,this.value)},e}(oa),ha=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return jt(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&Us(this.value.arrayValue,e)},e}(oa),fa=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return jt(e,t),e.prototype.matches=function(t){if(Us(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!Us(this.value.arrayValue,e)},e}(oa),pa=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return jt(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!$s(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return Us(e.value.arrayValue,t)}))},e}(oa),da=function(t,e){this.position=t,this.before=e};function ga(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return Bs(t)})).join(",")}var va=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function ya(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function ma(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.isKeyField()?Fs.comparator(Fs.fromName(s.referenceValue),n.key):js(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ba(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Vs(t.position[n],e.position[n]))return!1;return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var wa=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null,this.startAt,this.endAt};function Ea(t,e,n,r,i,o,s,a){return new wa(t,e,n,r,i,o,s,a)}function Ia(t){return new wa(t)}function Ta(t){return!Os(t.limit)&&"F"===t.limitType}function _a(t){return!Os(t.limit)&&"L"===t.limitType}function Sa(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Aa(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function Na(t){return null!==t.collectionGroup}function Da(t){var e=cs(t);if(null===e.p){e.p=[];var n=Aa(e),r=Sa(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new va(n)),e.p.push(new va(Ts.keyField(),"asc"));else{for(var i=!1,o=0,s=e.explicitOrderBy;o<s.length;o++){var a=s[o];e.p.push(a),a.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new va(Ts.keyField(),u))}}}return e.p}function ka(t){var e=cs(t);if(!e.T)if("F"===e.limitType)e.T=ea(e.path,e.collectionGroup,Da(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Da(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new va(o.field,s))}var a=e.endAt?new da(e.endAt.position,!e.endAt.before):null,u=e.startAt?new da(e.startAt.position,!e.startAt.before):null;e.T=ea(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.T}function Ca(t,e,n){return new wa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function xa(t,e){return ra(ka(t),ka(e))&&t.limitType===e.limitType}function Ra(t){return na(ka(t))+"|lt:"+t.limitType}function Oa(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.canonicalString()+" "+e.op+" "+Bs(e.value);var e})).join(", ")+"]"),Os(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+ga(t.startAt)),t.endAt&&(e+=", endAt: "+ga(t.endAt)),"Target("+e+")"}(ka(t))+"; limitType="+t.limitType+")"}function La(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Fs.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!ma(t.startAt,Da(t),e)||t.endAt&&ma(t.endAt,Da(t),e))}(t,e)}function Pa(t){return function(e,n){for(var r=!1,i=0,o=Da(t);i<o.length;i++){var s=o[i],a=Fa(s,e,n);if(0!==a)return a;r=r||s.field.isKeyField()}return 0}}function Fa(t,e,n){var r=t.field.isKeyField()?Fs.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?js(r,i):as()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return as()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ma(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ls(e)?"-0":e}}function Va(t){return{integerValue:""+t}}function Ua(t,e){return Ps(e)?Va(e):Ma(t,e)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ja=function(){this._=void 0};function qa(t,e,n){return t instanceof za?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Ga?$a(t,e):t instanceof Ha?Qa(t,e):function(t,e){var n=Ka(t,e),r=Xa(n)+Xa(t.A);return Gs(n)&&Gs(t.A)?Va(r):Ma(t.R,r)}(t,e)}function Ba(t,e,n){return t instanceof Ga?$a(t,e):t instanceof Ha?Qa(t,e):n}function Ka(t,e){return t instanceof Wa?Gs(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var za=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return jt(e,t),e}(ja),Ga=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return jt(e,t),e}(ja);function $a(t,e){for(var n=Ya(e),r=function(t){n.some((function(e){return Vs(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Ha=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return jt(e,t),e}(ja);function Qa(t,e){for(var n=Ya(e),r=function(t){n=n.filter((function(e){return!Vs(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Wa=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return jt(e,t),e}(ja);function Xa(t){return Ds(t.integerValue||t.doubleValue)}function Ya(t){return $s(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ja=function(t,e){this.field=t,this.transform=e},Za=function(t,e){this.version=t,this.transformResults=e},tu=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function eu(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var nu=function(){};function ru(t,e,n){t instanceof uu?function(t,e,n){var r=t.value.clone(),i=hu(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof cu?function(t,e,n){if(eu(t.precondition,e)){var r=hu(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(lu(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function iu(t,e,n){t instanceof uu?function(t,e,n){if(eu(t.precondition,e)){var r=t.value.clone(),i=fu(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(au(e),r).setHasLocalMutations()}}(t,e,n):t instanceof cu?function(t,e,n){if(eu(t.precondition,e)){var r=fu(t.fieldTransforms,n,e),i=e.data;i.setAll(lu(t)),i.setAll(r),e.convertToFoundDocument(au(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){eu(t.precondition,e)&&e.convertToNoDocument(vs.min())}(t,e)}function ou(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e.data.field(o.field),a=Ka(o.transform,s||null);null!=a&&(null==n&&(n=Ys.empty()),n.set(o.field,a))}return n||null}function su(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&ps(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Ga&&e instanceof Ga||t instanceof Ha&&e instanceof Ha?ps(t.elements,e.elements,Vs):t instanceof Wa&&e instanceof Wa?Vs(t.A,e.A):t instanceof za&&e instanceof za}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function au(t){return t.isFoundDocument()?t.version:vs.min()}var uu=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return jt(e,t),e}(nu),cu=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.fieldMask=r,s.precondition=i,s.fieldTransforms=o,s.type=1,s}return jt(e,t),e}(nu);function lu(t){var e=new Map;return t.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}})),e}function hu(t,e,n){var r=new Map;us(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,Ba(s,a,n[i]))}return r}function fu(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var s=o[i],a=s.transform,u=n.data.field(s.field);r.set(s.field,qa(a,u,e))}return r}var pu,du,gu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return jt(e,t),e}(nu),vu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return jt(e,t),e}(nu),yu=function(t){this.count=t};function mu(t){switch(t){case Zo.OK:return as();case Zo.CANCELLED:case Zo.UNKNOWN:case Zo.DEADLINE_EXCEEDED:case Zo.RESOURCE_EXHAUSTED:case Zo.INTERNAL:case Zo.UNAVAILABLE:case Zo.UNAUTHENTICATED:return!1;case Zo.INVALID_ARGUMENT:case Zo.NOT_FOUND:case Zo.ALREADY_EXISTS:case Zo.PERMISSION_DENIED:case Zo.FAILED_PRECONDITION:case Zo.ABORTED:case Zo.OUT_OF_RANGE:case Zo.UNIMPLEMENTED:case Zo.DATA_LOSS:return!0;default:return as()}}function bu(t){if(void 0===t)return is("GRPC error has no .code"),Zo.UNKNOWN;switch(t){case pu.OK:return Zo.OK;case pu.CANCELLED:return Zo.CANCELLED;case pu.UNKNOWN:return Zo.UNKNOWN;case pu.DEADLINE_EXCEEDED:return Zo.DEADLINE_EXCEEDED;case pu.RESOURCE_EXHAUSTED:return Zo.RESOURCE_EXHAUSTED;case pu.INTERNAL:return Zo.INTERNAL;case pu.UNAVAILABLE:return Zo.UNAVAILABLE;case pu.UNAUTHENTICATED:return Zo.UNAUTHENTICATED;case pu.INVALID_ARGUMENT:return Zo.INVALID_ARGUMENT;case pu.NOT_FOUND:return Zo.NOT_FOUND;case pu.ALREADY_EXISTS:return Zo.ALREADY_EXISTS;case pu.PERMISSION_DENIED:return Zo.PERMISSION_DENIED;case pu.FAILED_PRECONDITION:return Zo.FAILED_PRECONDITION;case pu.ABORTED:return Zo.ABORTED;case pu.OUT_OF_RANGE:return Zo.OUT_OF_RANGE;case pu.UNIMPLEMENTED:return Zo.UNIMPLEMENTED;case pu.DATA_LOSS:return Zo.DATA_LOSS;default:return as()}}(du=pu||(pu={}))[du.OK=0]="OK",du[du.CANCELLED=1]="CANCELLED",du[du.UNKNOWN=2]="UNKNOWN",du[du.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",du[du.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",du[du.NOT_FOUND=5]="NOT_FOUND",du[du.ALREADY_EXISTS=6]="ALREADY_EXISTS",du[du.PERMISSION_DENIED=7]="PERMISSION_DENIED",du[du.UNAUTHENTICATED=16]="UNAUTHENTICATED",du[du.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",du[du.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",du[du.ABORTED=10]="ABORTED",du[du.OUT_OF_RANGE=11]="OUT_OF_RANGE",du[du.UNIMPLEMENTED=12]="UNIMPLEMENTED",du[du.INTERNAL=13]="INTERNAL",du[du.UNAVAILABLE=14]="UNAVAILABLE",du[du.DATA_LOSS=15]="DATA_LOSS";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var wu=function(){function t(t,e){this.comparator=t,this.root=e||Iu.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Iu.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Iu.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new Eu(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new Eu(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new Eu(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new Eu(this.root,t,this.comparator,!0)},t}(),Eu=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),Iu=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw as();if(this.right.isRed())throw as();var t=this.left.check();if(t!==this.right.check())throw as();return t+(this.isRed()?0:1)},t}();Iu.EMPTY=null,Iu.RED=!0,Iu.BLACK=!1,Iu.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw as()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw as()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw as()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw as()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw as()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Iu(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Tu=function(){function t(t){this.comparator=t,this.data=new wu(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new _u(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new _u(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),_u=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),Su=new wu(Fs.comparator);function Au(){return Su}var Nu=new wu(Fs.comparator);function Du(){return Nu}var ku=new wu(Fs.comparator);var Cu=new Tu(Fs.comparator);function xu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Cu,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Ru=new Tu(fs);function Ou(){return Ru}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Lu=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,Pu.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(vs.min(),r,Ou(),Au(),xu())},t}(),Pu=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(Ss.EMPTY_BYTE_STRING,n,xu(),xu(),xu())},t}(),Fu=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},Mu=function(t,e){this.targetId=t,this.V=e},Vu=function(t,e,n,r){void 0===n&&(n=Ss.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Uu=function(){function t(){this.S=0,this.D=Bu(),this.C=Ss.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.F},enumerable:!1,configurable:!0}),t.prototype.O=function(t){t.approximateByteSize()>0&&(this.F=!0,this.C=t)},t.prototype.M=function(){var t=xu(),e=xu(),n=xu();return this.D.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:as()}})),new Pu(this.C,this.N,t,e,n)},t.prototype.L=function(){this.F=!1,this.D=Bu()},t.prototype.B=function(t,e){this.F=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.F=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.F=!0,this.N=!0},t}(),ju=function(){function t(t){this.W=t,this.G=new Map,this.H=Au(),this.J=qu(),this.Y=new Tu(fs)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.tt(r,t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.k||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.k||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:as()}}))},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach((function(t,r){n.st(r)&&e(r)}))},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(ia(i))if(0===n){var o=new Fs(i.path);this.tt(e,o,Zs.newNoDocument(o,vs.min()))}else us(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach((function(r,i){var o=e.ot(i);if(o){if(r.current&&ia(o.target)){var s=new Fs(o.target.path);null!==e.H.get(s)||e.at(i,s)||e.tt(i,s,Zs.newNoDocument(s,t))}r.$&&(n.set(i,r.M()),r.L())}}));var r=xu();this.J.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new Lu(t,n,this.Y,this.H,r);return this.H=Au(),this.J=qu(),this.Y=new Tu(fs),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new Uu,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new Tu(fs),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||rs("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.k?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new Uu),this.W.getRemoteKeysForTarget(t).forEach((function(n){e.tt(t,n,null)}))},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function qu(){return new wu(Fs.comparator)}function Bu(){return new wu(Fs.comparator)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ku={asc:"ASCENDING",desc:"DESCENDING"},zu={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Gu=function(t,e){this.databaseId=t,this.I=e};function $u(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Hu(t,e){return t.I?e.toBase64():e.toUint8Array()}function Qu(t,e){return $u(t,e.toTimestamp())}function Wu(t){return us(!!t),vs.fromTimestamp(function(t){var e=Ns(t);return new gs(e.seconds,e.nanos)}(t))}function Xu(t,e){return function(t){return new Es(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Yu(t){var e=Es.fromString(t);return us(wc(e)),e}function Ju(t,e){return Xu(t.databaseId,e.path)}function Zu(t,e){var n=Yu(e);if(n.get(1)!==t.databaseId.projectId)throw new ts(Zo.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ts(Zo.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Fs(rc(n))}function tc(t,e){return Xu(t.databaseId,e)}function ec(t){var e=Yu(t);return 4===e.length?Es.emptyPath():rc(e)}function nc(t){return new Es(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function rc(t){return us(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function ic(t,e,n){return{name:Ju(t,e),fields:n.value.mapValue.fields}}function oc(t,e){var n;if(e instanceof uu)n={update:ic(t,e.key,e.value)};else if(e instanceof gu)n={delete:Ju(t,e.key)};else if(e instanceof cu)n={update:ic(t,e.key,e.data),updateMask:bc(e.fieldMask)};else{if(!(e instanceof vu))return as();n={verify:Ju(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof za)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ga)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Ha)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Wa)return{fieldPath:e.field.canonicalString(),increment:n.A};throw as()}(0,t)}))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Qu(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:as()}(t,e.precondition)),n}function sc(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?tu.updateTime(Wu(t.updateTime)):void 0!==t.exists?tu.exists(t.exists):tu.none()}(e.currentDocument):tu.none(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)us("REQUEST_TIME"===e.setToServerValue),n=new za;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new Ga(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new Ha(i)}else"increment"in e?n=new Wa(t,e.increment):as();var o=Ts.fromServerFormat(e.fieldPath);return new Ja(o,n)}(t,e)})):[];if(e.update){e.update.name;var i=Zu(t,e.update.name),o=new Ys({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){var e=t.fieldPaths||[];return new _s(e.map((function(t){return Ts.fromServerFormat(t)})))}(e.updateMask);return new cu(i,o,s,n,r)}return new uu(i,o,n,r)}if(e.delete){var a=Zu(t,e.delete);return new gu(a,n)}if(e.verify){var u=Zu(t,e.verify);return new vu(u,n)}return as()}function ac(t,e){return{documents:[tc(t,e.path)]}}function uc(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=tc(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=tc(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(Qs(t.value))return{unaryFilter:{field:gc(t.field),op:"IS_NAN"}};if(Hs(t.value))return{unaryFilter:{field:gc(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Qs(t.value))return{unaryFilter:{field:gc(t.field),op:"IS_NOT_NAN"}};if(Hs(t.value))return{unaryFilter:{field:gc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:gc(t.field),op:dc(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:gc(t.field),direction:pc(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.I||Os(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=hc(e.startAt)),e.endAt&&(n.structuredQuery.endAt=hc(e.endAt)),n}function cc(t){var e=ec(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){us(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=lc(n.where));var a=[];n.orderBy&&(a=n.orderBy.map((function(t){return function(t){return new va(vc(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var u=null;n.limit&&(u=function(t){var e;return Os(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=fc(n.startAt));var l=null;return n.endAt&&(l=fc(n.endAt)),Ea(e,i,a,s,u,"F",c,l)}function lc(t){return t?void 0!==t.unaryFilter?[mc(t)]:void 0!==t.fieldFilter?[yc(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return lc(t)})).reduce((function(t,e){return t.concat(e)})):as():[]}function hc(t){return{before:t.before,values:t.position}}function fc(t){var e=!!t.before,n=t.values||[];return new da(n,e)}function pc(t){return Ku[t]}function dc(t){return zu[t]}function gc(t){return{fieldPath:t.canonicalString()}}function vc(t){return Ts.fromServerFormat(t.fieldPath)}function yc(t){return oa.create(vc(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return as()}}(t.fieldFilter.op),t.fieldFilter.value)}function mc(t){switch(t.unaryFilter.op){case"IS_NAN":var e=vc(t.unaryFilter.field);return oa.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=vc(t.unaryFilter.field);return oa.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=vc(t.unaryFilter.field);return oa.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=vc(t.unaryFilter.field);return oa.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return as()}}function bc(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}}function wc(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ec(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Tc(e)),e=Ic(t.get(n),e);return Tc(e)}function Ic(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function Tc(t){return t+""}function _c(t){var e=t.length;if(us(e>=2),2===e)return us(""===t.charAt(0)&&""===t.charAt(1)),Es.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&as(),t.charAt(s+1)){case"":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:as()}o=s+2}return new Es(r)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Sc=function(t,e){this.seconds=t,this.nanoseconds=e},Ac=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Ac.store="owner",Ac.key="owner";var Nc=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Nc.store="mutationQueues",Nc.keyPath="userId";var Dc=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Dc.store="mutations",Dc.keyPath="batchId",Dc.userMutationsIndex="userMutationsIndex",Dc.userMutationsKeyPath=["userId","batchId"];var kc=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Ec(e)]},t.key=function(t,e,n){return[t,Ec(e),n]},t}();kc.store="documentMutations",kc.PLACEHOLDER=new kc;var Cc=function(t,e){this.path=t,this.readTime=e},xc=function(t,e){this.path=t,this.version=e},Rc=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Rc.store="remoteDocuments",Rc.readTimeIndex="readTimeIndex",Rc.readTimeIndexPath="readTime",Rc.collectionReadTimeIndex="collectionReadTimeIndex",Rc.collectionReadTimeIndexPath=["parentPath","readTime"];var Oc=function(t){this.byteSize=t};Oc.store="remoteDocumentGlobal",Oc.key="remoteDocumentGlobalKey";var Lc=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Lc.store="targets",Lc.keyPath="targetId",Lc.queryTargetsIndexName="queryTargetsIndex",Lc.queryTargetsKeyPath=["canonicalId","targetId"];var Pc=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Pc.store="targetDocuments",Pc.keyPath=["targetId","path"],Pc.documentTargetsIndex="documentTargetsIndex",Pc.documentTargetsKeyPath=["path","targetId"];var Fc=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Fc.key="targetGlobalKey",Fc.store="targetGlobal";var Mc=function(t,e){this.collectionId=t,this.parent=e};Mc.store="collectionParents",Mc.keyPath=["collectionId","parent"];var Vc=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Vc.store="clientMetadata",Vc.keyPath="clientId";var Uc=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Uc.store="bundles",Uc.keyPath="bundleId";var jc=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};jc.store="namedQueries",jc.keyPath="name";var qc=$t($t([],$t($t([],$t($t([],$t($t([],[Nc.store,Dc.store,kc.store,Rc.store,Lc.store,Ac.store,Fc.store,Pc.store]),[Vc.store])),[Oc.store])),[Mc.store])),[Uc.store,jc.store]),Bc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Kc=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},t}(),zc=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},Gc=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&as(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))},t.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.waitFor=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},t}(),$c=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new zc,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new Wc(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=tl(e.target.error);n.ft.reject(new Wc(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new Wc(n,e)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(rs("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Yc(e)},t}(),Hc=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t(Xt())&&is("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return rs("SimpleDb","Removing database:",t),Jc(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=Xt(),n=t._t(e),r=0<n&&n<10,i=t.Et(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.gt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return Bt(this,void 0,void 0,(function(){var e,n=this;return Kt(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(rs("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new Wc(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new ts(Zo.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new Wc(t,n))},i.onupgradeneeded=function(t){rs("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.wt.Rt(e,i.transaction,t.oldVersion,n.version).next((function(){rs("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}}))}))},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Bt(this,void 0,void 0,(function(){var i,o,s,a,u;return Kt(this,(function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,u,c,l;return Kt(this,(function(h){switch(h.label){case 0:++o,h.label=1;case 1:return h.trys.push([1,4,,5]),[4,a.At(t)];case 2:return a.db=h.sent(),e=$c.open(a.db,t,i?"readonly":"readwrite",n),s=r(e).catch((function(t){return e.abort(t),Gc.reject(t)})).toPromise(),u={},s.catch((function(){})),[4,e.dt];case 3:return[2,(u.value=(h.sent(),s),u)];case 4:return c=h.sent(),l="FirebaseError"!==c.name&&o<3,rs("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),a.close(),l?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},a=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),Qc=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return Jc(this.Pt.delete())},t}(),Wc=function(t){function e(e,n){var r=this;return(r=t.call(this,Zo.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return jt(e,t),e}(ts);function Xc(t){return"IndexedDbTransactionError"===t.name}var Yc=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(rs("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(rs("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Jc(n)},t.prototype.add=function(t){return rs("SimpleDb","ADD",this.store.name,t,t),Jc(this.store.add(t))},t.prototype.get=function(t){var e=this;return Jc(this.store.get(t)).next((function(n){return void 0===n&&(n=null),rs("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return rs("SimpleDb","DELETE",this.store.name,t),Jc(this.store.delete(t))},t.prototype.count=function(){return rs("SimpleDb","COUNT",this.store.name),Jc(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.Ft=function(t,e){rs("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.kt=!1;var r=this.cursor(n);return this.xt(r,(function(t,e,n){return n.delete()}))},t.prototype.$t=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new Gc((function(n,r){e.onerror=function(t){var e=tl(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.xt=function(t,e){var n=[];return new Gc((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Qc(i),s=e(i.primaryKey,i.value,o);if(s instanceof Gc){var a=s.catch((function(t){return o.done(),Gc.reject(t)}));n.push(a)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}})).next((function(){return Gc.waitFor(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.kt?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Jc(t){return new Gc((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=tl(t.target.error);n(e)}}))}var Zc=!1;function tl(t){var e=Hc._t(Xt());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new ts("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Zc||(Zc=!0,setTimeout((function(){throw r}),0)),r}}return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var el=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return jt(e,t),e}(Kc);function nl(t,e){var n=cs(t);return Hc.It(n.Mt,e)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var rl=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&ru(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&iu(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&iu(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach((function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(vs.min())}))},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),xu())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&ps(this.mutations,t.mutations,(function(t,e){return su(t,e)}))&&ps(this.baseMutations,t.baseMutations,(function(t,e){return su(t,e)}))},t}(),il=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){us(e.mutations.length===r.length);for(var i=ku,o=e.mutations,s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),ol=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=vs.min()),void 0===o&&(o=vs.min()),void 0===s&&(s=Ss.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),sl=function(t){this.Lt=t};function al(t,e){if(e.document)return function(t,e,n){var r=Zu(t,e.name),i=Wu(e.updateTime),o=new Ys({mapValue:{fields:e.fields}}),s=Zs.newFoundDocument(r,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Fs.fromSegments(e.noDocument.path),r=fl(e.noDocument.readTime),i=Zs.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=Fs.fromSegments(e.unknownDocument.path);return r=fl(e.unknownDocument.version),Zs.newUnknownDocument(o,r)}return as()}function ul(t,e,n){var r=cl(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:Ju(t,e.key),fields:e.data.value.mapValue.fields,updateTime:$u(t,e.version.toTimestamp())}}(t.Lt,e),s=e.hasCommittedMutations;return new Rc(null,null,o,s,r,i)}if(e.isNoDocument()){var a=e.key.path.toArray(),u=hl(e.version);return s=e.hasCommittedMutations,new Rc(null,new Cc(a,u),null,s,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),l=hl(e.version);return new Rc(new xc(c,l),null,null,!0,r,i)}return as()}function cl(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function ll(t){var e=new gs(t[0],t[1]);return vs.fromTimestamp(e)}function hl(t){var e=t.toTimestamp();return new Sc(e.seconds,e.nanoseconds)}function fl(t){var e=new gs(t.seconds,t.nanoseconds);return vs.fromTimestamp(e)}function pl(t,e){for(var n=(e.baseMutations||[]).map((function(e){return sc(t.Lt,e)})),r=0;r<e.mutations.length-1;++r){var i=e.mutations[r];if(r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform){var o=e.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var s=e.mutations.map((function(e){return sc(t.Lt,e)})),a=gs.fromMillis(e.localWriteTimeMs);return new rl(e.batchId,a,n,s)}function dl(t){var e,n,r=fl(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?fl(t.lastLimboFreeSnapshotVersion):vs.min();return void 0!==t.query.documents?(us(1===(n=t.query).documents.length),e=ka(Ia(ec(n.documents[0])))):e=function(t){return ka(cc(t))}(t.query),new ol(e,t.targetId,0,t.lastListenSequenceNumber,r,i,Ss.fromBase64String(t.resumeToken))}function gl(t,e){var n,r=hl(e.snapshotVersion),i=hl(e.lastLimboFreeSnapshotVersion);n=ia(e.target)?ac(t.Lt,e.target):uc(t.Lt,e.target);var o=e.resumeToken.toBase64();return new Lc(e.targetId,na(e.target),r,o,e.sequenceNumber,i,n)}function vl(t){var e=cc({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Ca(e,e.limit,"L"):e}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var yl=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return ml(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:fl(e.createTime),version:e.version};var e}))},t.prototype.saveBundleMetadata=function(t,e){return ml(t).put({bundleId:(n=e).id,createTime:hl(Wu(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return bl(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:vl(e.bundledQuery),readTime:fl(e.readTime)};var e}))},t.prototype.saveNamedQuery=function(t,e){return bl(t).put(function(t){return{name:t.name,readTime:hl(Wu(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function ml(t){return nl(t,Uc.store)}function bl(t){return nl(t,jc.store)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var wl=function(){function t(){this.Bt=new El}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),Gc.resolve()},t.prototype.getCollectionParents=function(t,e){return Gc.resolve(this.Bt.getEntries(e))},t}(),El=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Tu(Es.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Tu(Es.comparator)).toArray()},t}(),Il=function(){function t(){this.qt=new El}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener((function(){n.qt.add(e)}));var o={collectionId:r,parent:Ec(i)};return Tl(t).put(o)}return Gc.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[ds(e),""],!1,!0);return Tl(t).Nt(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(_c(o.parent))}return n}))},t}();function Tl(t){return nl(t,Mc.store)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var _l={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Sl=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Al(t,e,n){var r=t.store(Dc.store),i=t.store(kc.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.$t({range:s},(function(t,e,n){return a++,n.delete()}));o.push(u.next((function(){us(1===a)})));for(var c=[],l=0,h=n.mutations;l<h.length;l++){var f=h[l],p=kc.key(e,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return Gc.waitFor(o).next((function(){return c}))}function Nl(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw as();e=t.noDocument}return JSON.stringify(e).length}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */Sl.DEFAULT_COLLECTION_PERCENTILE=10,Sl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Sl.DEFAULT=new Sl(41943040,Sl.DEFAULT_COLLECTION_PERCENTILE,Sl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Sl.DISABLED=new Sl(-1,0,0);var Dl=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Kt={}}return t.Qt=function(e,n,r,i){return us(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Cl(t).$t({index:Dc.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=xl(t),s=Cl(t);return s.add({}).next((function(a){us("number"==typeof a);for(var u=new rl(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return oc(t.Lt,e)})),i=n.mutations.map((function(e){return oc(t.Lt,e)}));return new Dc(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),l=[],h=new Tu((function(t,e){return fs(t.canonicalString(),e.canonicalString())})),f=0,p=r;f<p.length;f++){var d=p[f],g=kc.key(i.userId,d.key.path,a);h=h.add(d.key.path.popLast()),l.push(s.put(c)),l.push(o.put(g,kc.PLACEHOLDER))}return h.forEach((function(e){l.push(i.Ut.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.Kt[a]=u.keys()})),Gc.waitFor(l).next((function(){return u}))}))},t.prototype.lookupMutationBatch=function(t,e){var n=this;return Cl(t).get(e).next((function(t){return t?(us(t.userId===n.userId),pl(n.R,t)):null}))},t.prototype.jt=function(t,e){var n=this;return this.Kt[e]?Gc.resolve(this.Kt[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var r=t.keys();return n.Kt[e]=r,r}return null}))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Cl(t).$t({index:Dc.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(us(e.batchId>=r),o=pl(n.R,e)),i.done()})).next((function(){return o}))},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Cl(t).$t({index:Dc.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Cl(t).Nt(Dc.userMutationsIndex,n).next((function(t){return t.map((function(t){return pl(e.R,t)}))}))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=kc.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return xl(t).$t({range:i},(function(r,i,s){var a=r[0],u=r[1],c=r[2],l=_c(u);if(a===n.userId&&e.path.isEqual(l))return Cl(t).get(c).next((function(t){if(!t)throw as();us(t.userId===n.userId),o.push(pl(n.R,t))}));s.done()})).next((function(){return o}))},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Tu(fs),i=[];return e.forEach((function(e){var o=kc.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=xl(t).$t({range:s},(function(t,i,o){var s=t[0],a=t[1],u=t[2],c=_c(a);s===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(a)})),Gc.waitFor(i).next((function(){return n.Wt(t,r)}))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=kc.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new Tu(fs);return xl(t).$t({range:s},(function(t,e,o){var s=t[0],u=t[1],c=t[2],l=_c(u);s===n.userId&&r.isPrefixOf(l)?l.length===i&&(a=a.add(c)):o.done()})).next((function(){return n.Wt(t,a)}))},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(Cl(t).get(e).next((function(t){if(null===t)throw as();us(t.userId===n.userId),r.push(pl(n.R,t))})))})),Gc.waitFor(i).next((function(){return r}))},t.prototype.removeMutationBatch=function(t,e){var n=this;return Al(t.Mt,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.Gt(e.batchId)})),Gc.forEach(r,(function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)}))}))},t.prototype.Gt=function(t){delete this.Kt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return Gc.resolve();var r=IDBKeyRange.lowerBound(kc.prefixForUser(e.userId)),i=[];return xl(t).$t({range:r},(function(t,n,r){if(t[0]===e.userId){var o=_c(t[1]);i.push(o)}else r.done()})).next((function(){us(0===i.length)}))}))},t.prototype.containsKey=function(t,e){return kl(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return Rl(t).get(this.userId).next((function(t){return t||new Nc(e.userId,-1,"")}))},t}();function kl(t,e,n){var r=kc.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return xl(t).$t({range:o,kt:!0},(function(t,n,r){var o=t[0],a=t[1];t[2],o===e&&a===i&&(s=!0),r.done()})).next((function(){return s}))}function Cl(t){return nl(t,Dc.store)}function xl(t){return nl(t,kc.store)}function Rl(t){return nl(t,Nc.store)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ol=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),Ll=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next((function(n){var r=new Ol(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next((function(t){return vs.fromTimestamp(new gs(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)}))},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next((function(){return n.Xt(t).next((function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)}))}))},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return Pl(t).delete(e.targetId)})).next((function(){return n.Xt(t)})).next((function(e){return us(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)}))},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return Pl(t).$t((function(s,a){var u=dl(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))})).next((function(){return Gc.waitFor(o)})).next((function(){return i}))},t.prototype.forEachTarget=function(t,e){return Pl(t).$t((function(t,n){var r=dl(n);e(r)}))},t.prototype.Xt=function(t){return Fl(t).get(Fc.key).next((function(t){return us(null!==t),t}))},t.prototype.Zt=function(t,e){return Fl(t).put(Fc.key,e)},t.prototype.te=function(t,e){return Pl(t).put(gl(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next((function(t){return t.targetCount}))},t.prototype.getTargetData=function(t,e){var n=na(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Pl(t).$t({range:r,index:Lc.queryTargetsIndexName},(function(t,n,r){var o=dl(n);ra(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=Ml(t);return e.forEach((function(e){var s=Ec(e.path);i.push(o.put(new Pc(n,s))),i.push(r.referenceDelegate.addReference(t,n,e))})),Gc.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=Ml(t);return Gc.forEach(e,(function(e){var o=Ec(e.path);return Gc.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])}))},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=Ml(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Ml(t),i=xu();return r.$t({range:n,kt:!0},(function(t,e,n){var r=_c(t[1]),o=new Fs(r);i=i.add(o)})).next((function(){return i}))},t.prototype.containsKey=function(t,e){var n=Ec(e.path),r=IDBKeyRange.bound([n],[ds(n)],!1,!0),i=0;return Ml(t).$t({index:Pc.documentTargetsIndex,kt:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.lt=function(t,e){return Pl(t).get(e).next((function(t){return t?dl(t):null}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Pl(t){return nl(t,Lc.store)}function Fl(t){return nl(t,Fc.store)}function Ml(t){return nl(t,Pc.store)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Vl(t){return Bt(this,void 0,void 0,(function(){return Kt(this,(function(e){if(t.code!==Zo.FAILED_PRECONDITION||t.message!==Bc)throw t;return rs("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ul(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=fs(n,i);return 0===s?fs(r,o):s}var jl=function(){function t(t){this.ne=t,this.buffer=new Tu(Ul),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Ul(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),ql=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;rs("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,(function(){return Bt(e,void 0,void 0,(function(){var e;return Kt(this,(function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return Xc(e=n.sent())?(rs("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Vl(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),Bl=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return Gc.resolve(Jo.o);var r=new jl(e);return this.ae.forEachTarget(t,(function(t){return r.re(t.sequenceNumber)})).next((function(){return n.ae.le(t,(function(t){return r.re(t)}))})).next((function(){return r.maxValue}))},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(rs("LruGarbageCollector","Garbage collection skipped; disabled"),Gc.resolve(_l)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(rs("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),_l):n.fe(t,e)}))},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,o,s,a,u,c=this,l=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return e>c.params.maximumSequenceNumbersToCollect?(rs("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)})).next((function(r){return n=r,s=Date.now(),c.removeTargets(t,n,e)})).next((function(e){return i=e,a=Date.now(),c.removeOrphanedDocuments(t,n)})).next((function(t){return u=Date.now(),ns()<=pe.DEBUG&&rs("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-l)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-l)+"ms"),Gc.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})}))},t}(),Kl=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new Bl(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.de=function(t){var e=0;return this.le(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,(function(t,n){return e(n)}))},t.prototype.addReference=function(t,e,n){return zl(t,n)},t.prototype.removeReference=function(t,e,n){return zl(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return zl(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return Rl(t).Ot((function(r){return kl(t,r,e).next((function(t){return t&&(n=!0),Gc.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,(function(s,a){if(a<=e){var u=n._e(t,s).next((function(e){if(!e)return o++,r.getEntry(t,s).next((function(){return r.removeEntry(s),Ml(t).delete([0,Ec(s.path)])}))}));i.push(u)}})).next((function(){return Gc.waitFor(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return zl(t,e)},t.prototype.we=function(t,e){var n,r=Ml(t),i=Jo.o;return r.$t({index:Pc.documentTargetsIndex},(function(t,r){var o=t[0];t[1];var s=r.path,a=r.sequenceNumber;0===o?(i!==Jo.o&&e(new Fs(_c(n)),i),i=a,n=s):i=Jo.o})).next((function(){i!==Jo.o&&e(new Fs(_c(n)),i)}))},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function zl(t,e){return Ml(t).put(function(t,e){return new Pc(0,Ec(t.path),e)}(e,t.currentSequenceNumber))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Gl=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(this.equalsFn(s,t))return a}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){ms(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];t(s,a)}}))},t.prototype.isEmpty=function(){return bs(this.inner)},t}(),$l=function(){function t(){this.changes=new Gl((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:vs.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:Zs.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?Gc.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),Hl=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return Xl(t).put(Yl(e),n)},t.prototype.removeEntry=function(t,e){var n=Xl(t),r=Yl(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.me(t,r)}))},t.prototype.getEntry=function(t,e){var n=this;return Xl(t).get(Yl(e)).next((function(t){return n.ye(e,t)}))},t.prototype.ge=function(t,e){var n=this;return Xl(t).get(Yl(e)).next((function(t){return{document:n.ye(e,t),size:Nl(t)}}))},t.prototype.getEntries=function(t,e){var n=this,r=Au();return this.pe(t,e,(function(t,e){var i=n.ye(t,e);r=r.insert(t,i)})).next((function(){return r}))},t.prototype.Ee=function(t,e){var n=this,r=Au(),i=new wu(Fs.comparator);return this.pe(t,e,(function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,Nl(e))})).next((function(){return{documents:r,Te:i}}))},t.prototype.pe=function(t,e,n){if(e.isEmpty())return Gc.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return Xl(t).$t({range:r},(function(t,e,r){for(var s=Fs.fromSegments(t);o&&Fs.comparator(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=Au(),o=e.path.length+1,s={};if(n.isEqual(vs.min())){var a=e.path.toArray();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.toArray(),c=cl(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=Rc.collectionReadTimeIndex}return Xl(t).$t(s,(function(t,n,s){if(t.length===o){var a=al(r.R,n);e.path.isPrefixOf(a.key.path)?La(e,a)&&(i=i.insert(a.key,a)):s.done()}})).next((function(){return i}))},t.prototype.newChangeBuffer=function(t){return new Ql(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return Wl(t).get(Oc.key).next((function(t){return us(!!t),t}))},t.prototype.me=function(t,e){return Wl(t).put(Oc.key,e)},t.prototype.ye=function(t,e){if(e){var n=al(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(vs.min()))return n}return Zs.newInvalidDocument(t)},t}(),Ql=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new Gl((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return jt(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new Tu((function(t,e){return fs(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,s){var a=e.Ae.get(o);if(s.document.isValidDocument()){var u=ul(e.Ie.R,s.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=Nl(u);r+=c-a,n.push(e.Ie.addEntry(t,o,u))}else if(r-=a,e.trackRemovals){var l=ul(e.Ie.R,Zs.newNoDocument(o,vs.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,l))}else n.push(e.Ie.removeEntry(t,o))})),i.forEach((function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))})),n.push(this.Ie.updateMetadata(t,r)),Gc.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next((function(t){return n.Ae.set(e,t.size),t.document}))},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next((function(t){var e=t.documents;return t.Te.forEach((function(t,e){n.Ae.set(t,e)})),e}))},e}($l);
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Wl(t){return nl(t,Oc.store)}function Xl(t){return nl(t,Rc.store)}function Yl(t){return t.path.toArray()}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Jl=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;us(n<r&&n>=0&&r<=11);var o=new $c("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(Ac.store)}(t),function(t){t.createObjectStore(Nc.store,{keyPath:Nc.keyPath}),t.createObjectStore(Dc.store,{keyPath:Dc.keyPath,autoIncrement:!0}).createIndex(Dc.userMutationsIndex,Dc.userMutationsKeyPath,{unique:!0}),t.createObjectStore(kc.store)}(t),Zl(t),function(t){t.createObjectStore(Rc.store)}(t));var s=Gc.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Pc.store),t.deleteObjectStore(Lc.store),t.deleteObjectStore(Fc.store)}(t),Zl(t)),s=s.next((function(){return function(t){var e=t.store(Fc.store),n=new Fc(0,0,vs.min().toTimestamp(),0);return e.put(Fc.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(Dc.store).Nt().next((function(n){t.deleteObjectStore(Dc.store),t.createObjectStore(Dc.store,{keyPath:Dc.keyPath,autoIncrement:!0}).createIndex(Dc.userMutationsIndex,Dc.userMutationsKeyPath,{unique:!0});var r=e.store(Dc.store),i=n.map((function(t){return r.put(t)}));return Gc.waitFor(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(Vc.store,{keyPath:Vc.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.Re(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(Oc.store)}(t),i.be(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ve(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.Pe(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Rc.store);e.createIndex(Rc.readTimeIndex,Rc.readTimeIndexPath,{unique:!1}),e.createIndex(Rc.collectionReadTimeIndex,Rc.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.Ve(o)}))),n<11&&r>=11&&(s=s.next((function(){!function(t){t.createObjectStore(Uc.store,{keyPath:Uc.keyPath})}(t),function(t){t.createObjectStore(jc.store,{keyPath:jc.keyPath})}(t)}))),s},t.prototype.be=function(t){var e=0;return t.store(Rc.store).$t((function(t,n){e+=Nl(n)})).next((function(){var n=new Oc(e);return t.store(Oc.store).put(Oc.key,n)}))},t.prototype.Re=function(t){var e=this,n=t.store(Nc.store),r=t.store(Dc.store);return n.Nt().next((function(n){return Gc.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(Dc.userMutationsIndex,i).next((function(r){return Gc.forEach(r,(function(r){us(r.userId===n.userId);var i=pl(e.R,r);return Al(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ve=function(t){var e=t.store(Pc.store),n=t.store(Rc.store);return t.store(Fc.store).get(Fc.key).next((function(t){var r=[];return n.$t((function(n,i){var o=new Es(n),s=function(t){return[0,Ec(t)]}(o);r.push(e.get(s).next((function(n){return n?Gc.resolve():function(n){return e.put(new Pc(0,Ec(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return Gc.waitFor(r)}))}))},t.prototype.Pe=function(t,e){t.createObjectStore(Mc.store,{keyPath:Mc.keyPath});var n=e.store(Mc.store),r=new El,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:Ec(i)})}};return e.store(Rc.store).$t({kt:!0},(function(t,e){var n=new Es(t);return i(n.popLast())})).next((function(){return e.store(kc.store).$t({kt:!0},(function(t,e){t[0];var n=t[1];t[2];var r=_c(n);return i(r.popLast())}))}))},t.prototype.Ve=function(t){var e=this,n=t.store(Lc.store);return n.$t((function(t,r){var i=dl(r),o=gl(e.R,i);return n.put(o)}))},t}();function Zl(t){t.createObjectStore(Pc.store,{keyPath:Pc.keyPath}).createIndex(Pc.documentTargetsIndex,Pc.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Lc.store,{keyPath:Lc.keyPath}).createIndex(Lc.queryTargetsIndexName,Lc.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Fc.store)}var th="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",eh=function(){function t(e,n,r,i,o,s,a,u,c,l){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=s,this.document=a,this.De=c,this.Ce=l,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fe=null,this.inForeground=!1,this.ke=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new ts(Zo.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Kl(this,i),this.Le=n+"main",this.R=new sl(u),this.Be=new Hc(this.Le,11,new Jl(this.R)),this.qe=new Ll(this.referenceDelegate,this.R),this.Ut=new Il,this.Ue=function(t,e){return new Hl(t,e)}(this.R,this.Ut),this.Ke=new yl,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,!1===l&&is("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new ts(Zo.FAILED_PRECONDITION,th);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.qe.getHighestSequenceNumber(e)}))})).then((function(e){t.Ne=new Jo(e,t.De)})).then((function(){t.xe=!0})).catch((function(e){return t.Be&&t.Be.close(),Promise.reject(e)}))},t.prototype.He=function(t){var e=this;return this.Me=function(n){return Bt(e,void 0,void 0,(function(){return Kt(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt((function(n){return Bt(e,void 0,void 0,(function(){return Kt(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget((function(){return Bt(e,void 0,void 0,(function(){return Kt(this,(function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return rh(e).put(new Vc(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Je(e).next((function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable((function(){return t.Me(!1)})))}))})).next((function(){return t.Ye(e)})).next((function(n){return t.isPrimary&&!n?t.Xe(e).next((function(){return!1})):!!n&&t.Ze(e).next((function(){return!0}))}))})).catch((function(e){if(Xc(e))return rs("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return rs("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Se.enqueueRetryable((function(){return t.Me(e)})),t.isPrimary=e}))},t.prototype.Je=function(t){var e=this;return nh(t).get(Ac.key).next((function(t){return Gc.resolve(e.tn(t))}))},t.prototype.en=function(t){return rh(t).delete(this.clientId)},t.prototype.nn=function(){return Bt(this,void 0,void 0,(function(){var t,e,n,r,i=this;return Kt(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=nl(t,Vc.store);return e.Nt().next((function(t){var n=i.rn(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return Gc.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.Qe)for(e=0,n=t;e<n.length;e++)r=n[e],this.Qe.removeItem(this.on(r.clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return t.je().then((function(){return t.nn()})).then((function(){return t.ze()}))}))},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?Gc.resolve(!0):nh(t).get(Ac.key).next((function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new ts(Zo.FAILED_PRECONDITION,th);return!1}}return!(!e.networkEnabled||!e.inForeground)||rh(t).Nt().next((function(t){return void 0===e.rn(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&rs("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return Bt(this,void 0,void 0,(function(){var t=this;return Kt(this,(function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[Ac.store,Vc.store],(function(e){var n=new el(e,Jo.o);return t.Xe(n).next((function(){return t.en(n)}))}))];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}}))}))},t.prototype.rn=function(t,e){var n=this;return t.filter((function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)}))},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return rh(e).Nt().next((function(e){return t.rn(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return Dl.Qt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;rs("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Be.runTransaction(t,o,qc,(function(o){return i=new el(o,r.Ne?r.Ne.next():Jo.o),"readwrite-primary"===e?r.Je(i).next((function(t){return!!t||r.Ye(i)})).next((function(e){if(!e)throw is("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Se.enqueueRetryable((function(){return r.Me(!1)})),new ts(Zo.FAILED_PRECONDITION,Bc);return n(i)})).next((function(t){return r.Ze(i).next((function(){return t}))})):r.dn(i).next((function(){return n(i)}))})).then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.dn=function(t){var e=this;return nh(t).get(Ac.key).next((function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new ts(Zo.FAILED_PRECONDITION,th)}))},t.prototype.Ze=function(t){var e=new Ac(this.clientId,this.allowTabSynchronization,Date.now());return nh(t).put(Ac.key,e)},t.yt=function(){return Hc.yt()},t.prototype.Xe=function(t){var e=this,n=nh(t);return n.get(Ac.key).next((function(t){return e.tn(t)?(rs("IndexedDbPersistence","Releasing primary lease."),n.delete(Ac.key)):Gc.resolve()}))},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(is("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ke=function(){t.Se.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.je()}))},this.document.addEventListener("visibilitychange",this.ke),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.ke&&(this.document.removeEventListener("visibilitychange",this.ke),this.ke=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Fe=function(){e.un(),!Yt()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")&&navigator.appVersion.match("Version/14")&&e.Se.enterRestrictedMode(!0),e.Se.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("pagehide",this.Fe))},t.prototype.hn=function(){this.Fe&&(this.window.removeEventListener("pagehide",this.Fe),this.Fe=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Qe)||void 0===e?void 0:e.getItem(this.on(t)));return rs("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return is("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.un=function(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),String(Date.now()))}catch(t){is("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function nh(t){return nl(t,Ac.store)}function rh(t){return nl(t,Vc.store)}function ih(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var oh=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.yn(t,e,r)}))},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next((function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t}))},t.prototype.gn=function(t,e){t.forEach((function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)}))},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next((function(e){return n.En(t,e).next((function(){return e}))}))},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(t){return n.gn(e,t)}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return Fs.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):Na(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new Fs(e)).next((function(t){var e=Du();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=Du();return this.Ut.getCollectionParents(t,i).next((function(s){return Gc.forEach(s,(function(s){var a=function(t,e){return new wa(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.An(t,a,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return i=e,o.Rn(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,l=r.get(c);null==l&&(l=Zs.newInvalidDocument(c),r=r.insert(c,l)),iu(u,l,o.localWriteTime),l.isFoundDocument()||(r=r.remove(c))}}))})).next((function(){return r.forEach((function(t,n){La(e,n)||(r=r.remove(t))})),r}))},t.prototype.Rn=function(t,e,n){for(var r=xu(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof cu&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next((function(t){return t.forEach((function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))})),c}))},t}(),sh=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=xu(),i=xu(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),ah=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(vs.min())?this.Dn(t,e):this.Sn.pn(t,r).next((function(o){var s=i.Cn(e,o);return(Ta(e)||_a(e))&&i.Nn(e.limitType,s,r,n)?i.Dn(t,e):(ns()<=pe.DEBUG&&rs("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Oa(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next((function(t){return s.forEach((function(e){t=t.insert(e.key,e)})),t})))}))},t.prototype.Cn=function(t,e){var n=new Tu(Pa(t));return e.forEach((function(e,r){La(t,r)&&(n=n.add(r))})),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return ns()<=pe.DEBUG&&rs("QueryEngine","Using full collection scan to execute query:",Oa(e)),this.Sn.getDocumentsMatchingQuery(t,e,vs.min())},t}(),uh=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.Fn=new wu(fs),this.kn=new Gl((function(t){return na(t)}),ra),this.$n=vs.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new oh(this.On,this._n,this.persistence.getIndexManager()),this.Ke=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.collect(n,e.Fn)}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ch(t,e,n,r){return new uh(t,e,n,r)}function lh(t,e){return Bt(this,void 0,void 0,(function(){var n,r,i,o;return Kt(this,(function(s){switch(s.label){case 0:return n=cs(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n._n.getAllMutationBatches(t).next((function(s){return o=s,r=n.persistence.getMutationQueue(e),i=new oh(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)})).next((function(e){for(var n=[],r=[],s=xu(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var l=0,h=c.mutations;l<h.length;l++){var f=h[l];s=s.add(f.key)}}for(var p=0,d=e;p<d.length;p++){var g=d[p];r.push(g.batchId);for(var v=0,y=g.mutations;v<y.length;v++){var m=y[v];s=s.add(m.key)}}return i.pn(t,s).next((function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}}))}))}))];case 1:return o=s.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}}))}))}function hh(t,e){var n=cs(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=Gc.resolve();return o.forEach((function(t){s=s.next((function(){return r.getEntry(e,t)})).next((function(e){var o=n.docVersions.get(t);us(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))}))})),s.next((function(){return t._n.removeMutationBatch(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}function fh(t){var e=cs(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.qe.getLastRemoteSnapshotVersion(t)}))}function ph(t,e){var n=cs(t),r=e.snapshotVersion,i=n.Fn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.Fn;var s=[];e.targetChanges.forEach((function(e,o){var a=i.get(o);if(a){s.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next((function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)})));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=a.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return us(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,c,e)&&s.push(n.qe.updateTargetData(t,c))}}}));var a=Au();if(e.documentUpdates.forEach((function(r,i){e.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),s.push(function(t,e,n,r,i){var o=xu();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=Au();return n.forEach((function(n,s){var a=t.get(n),u=(null==i?void 0:i.get(n))||r;s.isNoDocument()&&s.version.isEqual(vs.min())?(e.removeEntry(n,u),o=o.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(s,u),o=o.insert(n,s)):rs("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)})),o}))}(t,o,e.documentUpdates,r,void 0).next((function(t){a=t}))),!r.isEqual(vs.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next((function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)}));s.push(u)}return Gc.waitFor(s).next((function(){return o.apply(t)})).next((function(){return n.Mn.En(t,a)})).next((function(){return a}))})).then((function(t){return n.Fn=i,t}))}function dh(t,e){var n=cs(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)}))}function gh(t,e){var n=cs(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.qe.getTargetData(t,e).next((function(i){return i?(r=i,Gc.resolve(r)):n.qe.allocateTargetId(t).next((function(i){return r=new ol(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.Fn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fn=n.Fn.insert(t.targetId,t),n.kn.set(e,t.targetId)),t}))}function vh(t,e,n){return Bt(this,void 0,void 0,(function(){var r,i,o,s;return Kt(this,(function(a){switch(a.label){case 0:r=cs(t),i=r.Fn.get(e),o=n?"readwrite":"readwrite-primary",a.label=1;case 1:return a.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.referenceDelegate.removeTarget(t,i)}))];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if(!Xc(s=a.sent()))throw s;return rs("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.Fn=r.Fn.remove(e),r.kn.delete(i.target),[2]}}))}))}function yh(t,e,n){var r=cs(t),i=vs.min(),o=xu();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=cs(t),i=r.kn.get(n);return void 0!==i?Gc.resolve(r.Fn.get(i)):r.qe.getTargetData(e,n)}(r,t,ka(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:vs.min(),n?o:xu())})).next((function(t){return{documents:t,Bn:o}}))}))}function mh(t,e){var n=cs(t),r=cs(n.qe),i=n.Fn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.lt(t,e).next((function(t){return t?t.target:null}))}))}function bh(t){var e=cs(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=cs(t),i=Au(),o=cl(n),s=Xl(e),a=IDBKeyRange.lowerBound(o,!0);return s.$t({index:Rc.readTimeIndex,range:a},(function(t,e){var n=al(r.R,e);i=i.insert(n.key,n),o=e.readTime})).next((function(){return{wn:i,readTime:ll(o)}}))}(e.On,t,e.$n)})).then((function(t){var n=t.wn,r=t.readTime;return e.$n=r,n}))}function wh(t){return Bt(this,void 0,void 0,(function(){var e;return Kt(this,(function(n){return[2,(e=cs(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=Xl(t),n=vs.min();return e.$t({index:Rc.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=ll(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.$n=t}))]}))}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Eh=function(){function t(t){this.R=t,this.Qn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return Gc.resolve(this.Qn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Qn.set(e.id,{id:(n=e).id,version:n.version,createTime:Wu(n.createTime)}),Gc.resolve()},t.prototype.getNamedQuery=function(t,e){return Gc.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:vl(t.bundledQuery),readTime:Wu(t.readTime)}}(e)),Gc.resolve()},t}(),Ih=function(){function t(){this.Wn=new Tu(Th.Gn),this.zn=new Tu(Th.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new Th(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},t.prototype.removeReference=function(t,e){this.Yn(new Th(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},t.prototype.Zn=function(t){var e=this,n=new Fs(new Es([])),r=new Th(n,t),i=new Th(n,t+1),o=[];return this.zn.forEachInRange([r,i],(function(t){e.Yn(t),o.push(t.key)})),o},t.prototype.ts=function(){var t=this;this.Wn.forEach((function(e){return t.Yn(e)}))},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new Fs(new Es([])),n=new Th(e,t),r=new Th(e,t+1),i=xu();return this.zn.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.containsKey=function(t){var e=new Th(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),Th=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return Fs.comparator(t.key,e.key)||fs(t.ns,e.ns)},t.Hn=function(t,e){return fs(t.ns,e.ns)||Fs.comparator(t.key,e.key)},t}(),_h=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new Tu(Th.Gn)}return t.prototype.checkEmpty=function(t){return Gc.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];var o=new rl(i,e,n,r);this._n.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.rs=this.rs.add(new Th(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return Gc.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return Gc.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.cs(n),i=r<0?0:r;return Gc.resolve(this._n.length>i?this._n[i]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return Gc.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return Gc.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new Th(e,0),i=new Th(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],(function(t){var e=n.os(t.ns);o.push(e)})),Gc.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Tu(fs);return e.forEach((function(t){var e=new Th(t,0),i=new Th(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],(function(t){r=r.add(t.ns)}))})),Gc.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;Fs.isDocumentKey(i)||(i=i.child(""));var o=new Th(new Fs(i),0),s=new Tu(fs);return this.rs.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(s=s.add(t.ns)),!0)}),o),Gc.resolve(this.us(s))},t.prototype.us=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.os(t);null!==r&&n.push(r)})),n},t.prototype.removeMutationBatch=function(t,e){var n=this;us(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return Gc.forEach(e.mutations,(function(i){var o=new Th(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((function(){n.rs=r}))},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new Th(e,0),r=this.rs.firstAfterOrEqual(n);return Gc.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return this._n.length,Gc.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),Sh=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new wu(Fs.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:s,readTime:n}),this.size+=s-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return Gc.resolve(n?n.document.clone():Zs.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=Au();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():Zs.newInvalidDocument(t))})),Gc.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=Au(),i=new Fs(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.key,u=s.value,c=u.document,l=u.readTime;if(!e.path.isPrefixOf(a.path))break;l.compareTo(n)<=0||La(e,c)&&(r=r.insert(c.key,c.clone()))}return Gc.resolve(r)},t.prototype.fs=function(t,e){return Gc.forEach(this.docs,(function(t){return e(t)}))},t.prototype.newChangeBuffer=function(t){return new Ah(this)},t.prototype.getSize=function(t){return Gc.resolve(this.size)},t}(),Ah=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return jt(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)})),Gc.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}($l),Nh=function(){function t(t){this.persistence=t,this.ds=new Gl((function(t){return na(t)}),ra),this.lastRemoteSnapshotVersion=vs.min(),this.highestTargetId=0,this.ws=0,this._s=new Ih,this.targetCount=0,this.ys=Ol.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach((function(t,n){return e(n)})),Gc.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return Gc.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return Gc.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),Gc.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),Gc.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new Ol(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,Gc.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),Gc.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,Gc.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach((function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.ds.delete(s),o.push(r.removeMatchingKeysForTargetId(t,a.targetId)),i++)})),Gc.waitFor(o).next((function(){return i}))},t.prototype.getTargetCount=function(t){return Gc.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return Gc.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),Gc.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.markPotentiallyOrphaned(t,e))})),Gc.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),Gc.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return Gc.resolve(n)},t.prototype.containsKey=function(t,e){return Gc.resolve(this._s.containsKey(e))},t}(),Dh=function(){function t(t,e){var n=this;this.gs={},this.Ne=new Jo(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new Nh(this),this.Ut=new wl,this.Ue=function(t,e){return new Sh(t,(function(t){return n.referenceDelegate.ps(t)}))}(this.Ut),this.R=new sl(e),this.Ke=new Eh(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new _h(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;rs("MemoryPersistence","Starting transaction:",t);var i=new kh(this.Ne.next());return this.referenceDelegate.Es(),n(i).next((function(t){return r.referenceDelegate.Ts(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.Is=function(t,e){return Gc.or(Object.values(this.gs).map((function(n){return function(){return n.containsKey(t,e)}})))},t}(),kh=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return jt(e,t),e}(Kc),Ch=function(){function t(t){this.persistence=t,this.As=new Ih,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw as()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),Gc.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),Gc.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),Gc.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach((function(t){return n.vs.add(t.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.vs.add(t.toString())}))})).next((function(){return r.removeTargetData(t,e)}))},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Gc.forEach(this.vs,(function(r){var i=Fs.fromPath(r);return e.Ps(t,i).next((function(t){t||n.removeEntry(i)}))})).next((function(){return e.Rs=null,n.apply(t)}))},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next((function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())}))},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return Gc.or([function(){return Gc.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),xh=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Rh(t,e){return"firestore_clients_"+t+"_"+e}function Oh(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function Lh(t,e){return"firestore_targets_"+t+"_"+e}xh.UNAUTHENTICATED=new xh(null),xh.GOOGLE_CREDENTIALS=new xh("google-credentials-uid"),xh.FIRST_PARTY=new xh("first-party-uid");var Ph=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new ts(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(is("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Fh=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new ts(i.error.code,i.error.message)),o?new t(e,i.state,r):(is("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Mh=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Ou(),s=0;i&&s<r.activeTargetIds.length;++s)i=Ps(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(is("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Vh=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(is("SharedClientState","Failed to parse online state: "+e),null)},t}(),Uh=function(){function t(){this.activeTargetIds=Ou()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),jh=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.Fs.bind(this),this.ks=new wu(fs),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=Rh(this.persistenceKey,this.Ns),this.Ms=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.ks=this.ks.insert(this.Ns,new Uh),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Ks=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Bt(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,a,u,c,l,h=this;return Kt(this,(function(f){switch(f.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(Rh(this.persistenceKey,r)))&&(o=Mh.Vs(r,i))&&(this.ks=this.ks.insert(o.clientId,o));for(this.Qs(),(s=this.storage.getItem(this.Us))&&(a=this.js(s))&&this.Ws(a),u=0,c=this.$s;u<c.length;u++)l=c[u],this.Fs(l);return this.$s=[],this.window.addEventListener("pagehide",(function(){return h.shutdown()})),this.started=!0,[2]}}))}))},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.ks)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.ks.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(Lh(this.persistenceKey,t));if(n){var r=Fh.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Qs(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Qs()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(Lh(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.Hs(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return rs("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){rs("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){rs("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Fs=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(rs("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void is("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable((function(){return Bt(e,void 0,void 0,(function(){var t,e,r,i,o,s;return Kt(this,(function(a){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(s=function(t){var e=Jo.o;if(null!=t)try{var n=JSON.parse(t);us("number"==typeof n),e=n}catch(t){is("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Jo.o&&this.sequenceNumberHandler(s);else if(n.key===this.Ks)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.ks.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Qs=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new Ph(this.currentUser,t,e,n),i=Oh(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=Oh(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){var e={clientId:this.Ns,onlineState:t};this.storage.setItem(this.Us,JSON.stringify(e))},t.prototype.Ys=function(t,e,n){var r=Lh(this.persistenceKey,t),i=new Fh(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Ks,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return Mh.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Ph.Vs(new xh(i),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return Fh.Vs(r,e)},t.prototype.js=function(t){return Vh.Vs(t)},t.prototype.ii=function(t){return Bt(this,void 0,void 0,(function(){return Kt(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(rs("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.ks.insert(t,e):this.ks.remove(t),i=this.Gs(this.ks),o=this.Gs(r),s=[],a=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||a.push(t)})),this.syncEngine.hi(s,a).then((function(){n.ks=r}))},t.prototype.Ws=function(t){this.ks.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=Ou();return t.forEach((function(t,n){e=e.unionWith(n.activeTargetIds)})),e},t}(),qh=function(){function t(){this.li=new Uh,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new Uh,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),Bh=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),Kh=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){rs("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){rs("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),zh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Gh=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),$h=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n.useFetchStreams=e.useFetchStreams,n}return jt(e,t),e.prototype.ki=function(t,e,n,r){return new Promise((function(i,o){var s=new Yo;s.listenOnce(Go.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case zo.NO_ERROR:var e=s.getResponseJson();rs("Connection","XHR received:",JSON.stringify(e)),i(e);break;case zo.TIMEOUT:rs("Connection",'RPC "'+t+'" timed out'),o(new ts(Zo.DEADLINE_EXCEEDED,"Request time out"));break;case zo.HTTP_ERROR:var n=s.getStatus();if(rs("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(Zo).indexOf(e)>=0?e:Zo.UNKNOWN}(r.status);o(new ts(a,r.message))}else o(new ts(Zo.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new ts(Zo.UNAVAILABLE,"Connection failed."));break;default:as()}}finally{rs("Connection",'RPC "'+t+'" completed.')}}));var a=JSON.stringify(r);s.send(e,"POST",a,n,15)}))},e.prototype.Oi=function(t,e){var n,r=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new Uo,o=xr(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(s.xmlHttpFactory=new Wo({})),this.Fi(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Xt())||"object"==typeof navigator&&"ReactNative"===navigator.product||Xt().indexOf("Electron/")>=0||function(){var t=Xt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()||Xt().indexOf("MSAppHost/")>=0||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var a=r.join("");rs("Connection","Creating WebChannel: "+a,s);var u=i.createWebChannel(a,s),c=!1,l=!1,h=new Gh({Ei:function(t){l?rs("Connection","Not sending because WebChannel is closed:",t):(c||(rs("Connection","Opening WebChannel transport."),u.open(),c=!0),rs("Connection","WebChannel sending:",t),u.send(t))},Ti:function(){return u.close()}}),f=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return f(u,Xo.EventType.OPEN,(function(){l||rs("Connection","WebChannel transport opened.")})),f(u,Xo.EventType.CLOSE,(function(){l||(l=!0,rs("Connection","WebChannel transport closed"),h.Vi())})),f(u,Xo.EventType.ERROR,(function(t){l||(l=!0,os("Connection","WebChannel transport errored:",t),h.Vi(new ts(Zo.UNAVAILABLE,"The operation could not be completed")))})),f(u,Xo.EventType.MESSAGE,(function(t){var e;if(!l){var n=t.data[0];us(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){rs("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=pu[t];if(void 0!==e)return bu(e)}(o),a=i.message;void 0===s&&(s=Zo.INTERNAL,a="Unknown error status: "+o+" with message "+i.message),l=!0,h.Vi(new ts(s,a)),u.close()}else rs("Connection","WebChannel received:",n),h.Si(n)}})),f(o,$o.STAT_EVENT,(function(t){t.stat===Ho?rs("Connection","Detected buffering proxy"):t.stat===Qo&&rs("Connection","Detected no buffering proxy")})),setTimeout((function(){h.Pi()}),0),h},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.Di=e+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);rs("RestConnection","Sending: ",i,n);var o={};return this.Fi(o,r),this.ki(t,i,o,n).then((function(t){return rs("RestConnection","Received: ",t),t}),(function(e){throw os("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.Fi=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.8.0",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){var n=zh[t];return this.Di+"/v1/"+e+":"+n},t}());
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Hh(){return"undefined"!=typeof window?window:null}function Qh(){return"undefined"!=typeof document?document:null}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Wh(t){return new Gu(t,!0)}var Xh=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Ki=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Qi=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Ki),i=Math.max(0,n-r);i>0&&rs("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,(function(){return e.Ki=Date.now(),t()})),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),Yh=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new Xh(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return Bt(this,void 0,void 0,(function(){return Kt(this,(function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,(function(){return t.rr()})))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return Bt(this,void 0,void 0,(function(){return Kt(this,(function(t){return this.er()?[2,this.close(0)]:[2]}))}))},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return Bt(this,void 0,void 0,(function(){return Kt(this,(function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===Zo.RESOURCE_EXHAUSTED?(is(e.toString()),is("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Qi()):e&&e.code===Zo.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then((function(e){t.Yi===n&&t.lr(e)}),(function(n){e((function(){var e=new ts(Zo.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)}))}))},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii((function(){n((function(){return e.state=2,e.listener.Ii()}))})),this.stream.Ri((function(t){n((function(){return e.dr(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji((function(){return Bt(t,void 0,void 0,(function(){return Kt(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.dr=function(t){return rs("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget((function(){return e.Yi===t?n():(rs("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Jh=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,s}return jt(e,t),e.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:as()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(us(void 0===e||"string"==typeof e),Ss.fromBase64String(e||"")):(us(void 0===e||e instanceof Uint8Array),Ss.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(a=e.targetChange.cause)&&function(t){var e=void 0===t.code?Zo.UNKNOWN:bu(t.code);return new ts(e,t.message||"")}(a);n=new Vu(r,i,o,s||null)}else if("documentChange"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=Zu(t,r.document.name),o=Wu(r.document.updateTime);var a=new Ys({mapValue:{fields:r.document.fields}}),u=(s=Zs.newFoundDocument(i,o,a),r.targetIds||[]),c=r.removedTargetIds||[];n=new Fu(u,c,s.key,s)}else if("documentDelete"in e)e.documentDelete,(r=e.documentDelete).document,i=Zu(t,r.document),o=r.readTime?Wu(r.readTime):vs.min(),a=Zs.newNoDocument(i,o),s=r.removedTargetIds||[],n=new Fu([],s,a.key,a);else if("documentRemove"in e)e.documentRemove,(r=e.documentRemove).document,i=Zu(t,r.document),o=r.removedTargetIds||[],n=new Fu([],o,i,null);else{if(!("filter"in e))return as();e.filter;var l=e.filter;l.targetId,r=l.count||0,i=new yu(r),o=l.targetId,n=new Mu(o,i)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return vs.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?vs.min():e.readTime?Wu(e.readTime):vs.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={};e.database=nc(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=ia(r)?{documents:ac(t,r)}:{query:uc(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=Hu(t,e.resumeToken):e.snapshotVersion.compareTo(vs.min())>0&&(n.readTime=$u(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return as()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.R,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=nc(this.R),e.removeTarget=t,this.cr(e)},e}(Yh),Zh=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,s.gr=!1,s}return jt(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.Oi("Write",t)},e.prototype.onMessage=function(t){if(us(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?(us(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?Wu(t.updateTime):Wu(e);return n.isEqual(vs.min())&&(n=Wu(e)),new Za(n,t.transformResults||[])}(t,e)}))):[]}(t.writeResults,t.commitTime),n=Wu(t.commitTime);return this.listener.Tr(n,e)}return us(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=nc(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return oc(e.R,t)}))};this.cr(n)},e}(Yh),tf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return jt(e,t),e.prototype.br=function(){if(this.Rr)throw new ts(Zo.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Ni(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===Zo.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new ts(Zo.UNKNOWN,t.toString())}))},e.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.$i(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===Zo.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new ts(Zo.UNKNOWN,t.toString())}))},e.prototype.terminate=function(){this.Rr=!0},e}((function(){})),ef=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()})))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.Fr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.Fr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(is(e),this.Vr=!1):rs("OnlineStateTracker",e)},t.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),nf=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di((function(t){n.enqueueAndForget((function(){return Bt(o,void 0,void 0,(function(){return Kt(this,(function(t){switch(t.label){case 0:return ff(this)?(rs("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Bt(this,void 0,void 0,(function(){var e;return Kt(this,(function(n){switch(n.label){case 0:return(e=cs(t)).Or.add(4),[4,of(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,rf(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Br=new ef(n,r)};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function rf(t){return Bt(this,void 0,void 0,(function(){var e,n;return Kt(this,(function(r){switch(r.label){case 0:if(!ff(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function of(t){return Bt(this,void 0,void 0,(function(){var e,n;return Kt(this,(function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function sf(t,e){var n=cs(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),hf(n)?lf(n):Nf(n).er()&&uf(n,e))}function af(t,e){var n=cs(t),r=Nf(n);n.$r.delete(e),r.er()&&cf(n,e),0===n.$r.size&&(r.er()?r.ir():ff(n)&&n.Br.set("Unknown"))}function uf(t,e){t.qr.U(e.targetId),Nf(t).mr(e)}function cf(t,e){t.qr.U(e),Nf(t).yr(e)}function lf(t){t.qr=new ju({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),Nf(t).start(),t.Br.Sr()}function hf(t){return ff(t)&&!Nf(t).tr()&&t.$r.size>0}function ff(t){return 0===cs(t).Or.size}function pf(t){t.qr=void 0}function df(t){return Bt(this,void 0,void 0,(function(){return Kt(this,(function(e){return t.$r.forEach((function(e,n){uf(t,e)})),[2]}))}))}function gf(t,e){return Bt(this,void 0,void 0,(function(){return Kt(this,(function(n){return pf(t),hf(t)?(t.Br.Nr(e),lf(t)):t.Br.set("Unknown"),[2]}))}))}function vf(t,e,n){return Bt(this,void 0,void 0,(function(){var r,i,o;return Kt(this,(function(s){switch(s.label){case 0:if(t.Br.set("Online"),!(e instanceof Vu&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Bt(this,void 0,void 0,(function(){var n,r,i,o;return Kt(this,(function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?(o=i[r],t.$r.has(o)?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]):[3,5];case 2:s.sent(),t.$r.delete(o),t.qr.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),rs("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,yf(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Fu?t.qr.X(e):e instanceof Mu?t.qr.rt(e):t.qr.et(e),n.isEqual(vs.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,fh(t.localStore)];case 8:return i=s.sent(),n.compareTo(i)>=0?[4,function(t,e){var n=t.qr.ut(e);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.$r.get(r);i&&t.$r.set(r,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((function(e){var n=t.$r.get(e);if(n){t.$r.set(e,n.withResumeToken(Ss.EMPTY_BYTE_STRING,n.snapshotVersion)),cf(t,e);var r=new ol(n.target,e,1,n.sequenceNumber);uf(t,r)}})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return rs("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,yf(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}}))}))}function yf(t,e,n){return Bt(this,void 0,void 0,(function(){var r=this;return Kt(this,(function(i){switch(i.label){case 0:if(!Xc(e))throw e;return t.Or.add(1),[4,of(t)];case 1:return i.sent(),t.Br.set("Offline"),n||(n=function(){return fh(t.localStore)}),t.asyncQueue.enqueueRetryable((function(){return Bt(r,void 0,void 0,(function(){return Kt(this,(function(e){switch(e.label){case 0:return rs("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,rf(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function mf(t,e){return e().catch((function(n){return yf(t,n,e)}))}function bf(t){return Bt(this,void 0,void 0,(function(){var e,n,r,i,o;return Kt(this,(function(s){switch(s.label){case 0:e=cs(t),n=Df(e),r=e.kr.length>0?e.kr[e.kr.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return ff(t)&&t.kr.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,dh(e.localStore,r)];case 3:return null===(i=s.sent())?(0===e.kr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.kr.push(e);var n=Df(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,yf(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return wf(e)&&Ef(e),[2]}}))}))}function wf(t){return ff(t)&&!Df(t).tr()&&t.kr.length>0}function Ef(t){Df(t).start()}function If(t){return Bt(this,void 0,void 0,(function(){return Kt(this,(function(e){return Df(t).Ar(),[2]}))}))}function Tf(t){return Bt(this,void 0,void 0,(function(){var e,n,r,i;return Kt(this,(function(o){for(e=Df(t),n=0,r=t.kr;n<r.length;n++)i=r[n],e.Er(i.mutations);return[2]}))}))}function _f(t,e,n){return Bt(this,void 0,void 0,(function(){var r,i;return Kt(this,(function(o){switch(o.label){case 0:return r=t.kr.shift(),i=il.from(r,e,n),[4,mf(t,(function(){return t.remoteSyncer.applySuccessfulWrite(i)}))];case 1:return o.sent(),[4,bf(t)];case 2:return o.sent(),[2]}}))}))}function Sf(t,e){return Bt(this,void 0,void 0,(function(){return Kt(this,(function(n){switch(n.label){case 0:return e&&Df(t).pr?[4,function(t,e){return Bt(this,void 0,void 0,(function(){var n,r;return Kt(this,(function(i){switch(i.label){case 0:return mu(r=e.code)&&r!==Zo.ABORTED?(n=t.kr.shift(),Df(t).sr(),[4,mf(t,(function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,bf(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return wf(t)&&Ef(t),[2]}}))}))}function Af(t,e){return Bt(this,void 0,void 0,(function(){var n;return Kt(this,(function(r){switch(r.label){case 0:return n=cs(t),e?(n.Or.delete(2),[4,rf(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,of(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function Nf(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=cs(t);return r.br(),new Jh(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:df.bind(null,t),Ri:gf.bind(null,t),_r:vf.bind(null,t)}),t.Mr.push((function(n){return Bt(e,void 0,void 0,(function(){return Kt(this,(function(e){switch(e.label){case 0:return n?(t.Ur.sr(),hf(t)?lf(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),pf(t),e.label=3;case 3:return[2]}}))}))}))),t.Ur}function Df(t){var e=this;return t.Kr||(t.Kr=function(t,e,n){var r=cs(t);return r.br(),new Zh(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:If.bind(null,t),Ri:Sf.bind(null,t),Ir:Tf.bind(null,t),Tr:_f.bind(null,t)}),t.Mr.push((function(n){return Bt(e,void 0,void 0,(function(){return Kt(this,(function(e){switch(e.label){case 0:return n?(t.Kr.sr(),[4,bf(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kr.stop()];case 3:e.sent(),t.kr.length>0&&(rs("RemoteStore","Stopping write stream with "+t.kr.length+" pending writes"),t.kr=[]),e.label=4;case 4:return[2]}}))}))}))),t.Kr
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var kf=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new zc,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t.createAndSchedule=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new ts(Zo.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function Cf(t,e){if(is("AsyncQueue",e+": "+t),Xc(t))return new ts(Zo.UNAVAILABLE,e+": "+t);throw t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var xf=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||Fs.comparator(e.key,n.key)}:function(t,e){return Fs.comparator(t.key,e.key)},this.keyedMap=Du(),this.sortedSet=new wu(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),Rf=function(){function t(){this.Qr=new wu(Fs.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Qr.get(e);n?0!==t.type&&3===n.type?this.Qr=this.Qr.insert(e,t):3===t.type&&1!==n.type?this.Qr=this.Qr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Qr=this.Qr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Qr=this.Qr.remove(e):1===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):as():this.Qr=this.Qr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Qr.inorderTraversal((function(e,n){t.push(n)})),t},t}(),Of=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,xf.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&xa(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Lf=function(){this.Wr=void 0,this.listeners=[]},Pf=function(){this.queries=new Gl((function(t){return Ra(t)}),xa),this.onlineState="Unknown",this.Gr=new Set};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ff(t,e){return Bt(this,void 0,void 0,(function(){var n,r,i,o,s,a,u;return Kt(this,(function(c){switch(c.label){case 0:if(n=cs(t),r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new Lf),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.onListen(r)];case 2:return s.Wr=c.sent(),[3,4];case 3:return a=c.sent(),u=Cf(a,"Initialization of query '"+Oa(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&jf(n),[2]}}))}))}function Mf(t,e){return Bt(this,void 0,void 0,(function(){var n,r,i,o,s;return Kt(this,(function(a){return n=cs(t),r=e.query,i=!1,(o=n.queries.get(r))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]}))}))}function Vf(t,e){for(var n=cs(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=s.query,u=n.queries.get(a);if(u){for(var c=0,l=u.listeners;c<l.length;c++)l[c].Hr(s)&&(r=!0);u.Wr=s}}r&&jf(n)}function Uf(t,e,n){var r=cs(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function jf(t){t.Gr.forEach((function(t){t.next()}))}var qf=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Of(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.so&&n||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){if(t.docChanges.length>0)return!0;var e=this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=Of.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),Bf=function(t){this.key=t},Kf=function(t){this.key=t},zf=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=xu(),this.mutatedKeys=xu(),this.lo=Pa(t),this.fo=new xf(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new Rf,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=Ta(this.query)&&i.size===this.query.limit?i.last():null,c=_a(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var l=i.get(t),h=La(n.query,e)?e:null,f=!!l&&n.mutatedKeys.has(l.key),p=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),d=!1;l&&h?l.data.isEqual(h.data)?f!==p&&(r.track({type:3,doc:h}),d=!0):n.yo(l,h)||(r.track({type:2,doc:h}),d=!0,(u&&n.lo(h,u)>0||c&&n.lo(h,c)<0)&&(a=!0)):!l&&h?(r.track({type:0,doc:h}),d=!0):l&&!h&&(r.track({type:1,doc:l}),d=!0,(u||c)&&(a=!0)),d&&(h?(s=s.add(h),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),Ta(this.query)||_a(this.query))for(;s.size>this.query.limit;){var l=Ta(this.query)?s.last():s.first();s=s.delete(l.key),o=o.delete(l.key),r.track({type:1,doc:l})}return{fo:s,mo:r,Nn:a,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return as()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)})),this.po(n);var s=e?this.Eo():[],a=0===this.ho.size&&this.current?1:0,u=a!==this.ao;return this.ao=a,0!==o.length||u?{snapshot:new Of(this.query,t.fo,i,o,t.mutatedKeys,0===a,u,!1),To:s}:{To:s}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new Rf,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e.uo=e.uo.add(t)})),t.modifiedDocuments.forEach((function(t){})),t.removedDocuments.forEach((function(t){return e.uo=e.uo.delete(t)})),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=xu(),this.fo.forEach((function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))}));var n=[];return e.forEach((function(e){t.ho.has(e)||n.push(new Kf(e))})),this.ho.forEach((function(t){e.has(t)||n.push(new Bf(t))})),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=xu();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return Of.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),Gf=function(t,e,n){this.query=t,this.targetId=e,this.view=n},$f=function(t){this.key=t,this.bo=!1},Hf=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new Gl((function(t){return Ra(t)}),xa),this.Vo=new Map,this.So=new Set,this.Do=new wu(Fs.comparator),this.Co=new Map,this.No=new Ih,this.xo={},this.Fo=new Map,this.ko=Ol.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Qf(t,e){return Bt(this,void 0,void 0,(function(){var n,r,i,o,s,a;return Kt(this,(function(u){switch(u.label){case 0:return n=Tp(t),(o=n.Po.get(e))?(r=o.targetId,n.sharedClientState.addLocalQueryTarget(r),i=o.view.Ro(),[3,4]):[3,1];case 1:return[4,gh(n.localStore,ka(e))];case 2:return s=u.sent(),a=n.sharedClientState.addLocalQueryTarget(s.targetId),r=s.targetId,[4,Wf(n,e,r,"current"===a)];case 3:i=u.sent(),n.isPrimaryClient&&sf(n.remoteStore,s),u.label=4;case 4:return[2,i]}}))}))}function Wf(t,e,n,r){return Bt(this,void 0,void 0,(function(){var i,o,s,a,u,c;return Kt(this,(function(l){switch(l.label){case 0:return t.Oo=function(e,n,r){return function(t,e,n,r){return Bt(this,void 0,void 0,(function(){var i,o,s;return Kt(this,(function(a){switch(a.label){case 0:return(i=e.view._o(n)).Nn?[4,yh(t.localStore,e.query,!1).then((function(t){var n=t.documents;return e.view._o(n,i)}))]:[3,2];case 1:i=a.sent(),a.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),s=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(up(t,e.targetId,s.To),s.snapshot)]}}))}))}(t,e,n,r)},[4,yh(t.localStore,e,!0)];case 1:return i=l.sent(),o=new zf(e,i.Bn),s=o._o(i.documents),a=Pu.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),u=o.applyChanges(s,t.isPrimaryClient,a),up(t,n,u.To),c=new Gf(e,n,o),[2,(t.Po.set(e,c),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),u.snapshot)]}}))}))}function Xf(t,e){return Bt(this,void 0,void 0,(function(){var n,r,i;return Kt(this,(function(o){switch(o.label){case 0:return n=cs(t),r=n.Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter((function(t){return!xa(t,e)}))),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,vh(n.localStore,r.targetId,!1).then((function(){n.sharedClientState.clearQueryState(r.targetId),af(n.remoteStore,r.targetId),sp(n,r.targetId)})).catch(Vl)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return sp(n,r.targetId),[4,vh(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function Yf(t,e,n){return Bt(this,void 0,void 0,(function(){var r,i,o,s;return Kt(this,(function(a){switch(a.label){case 0:r=_p(t),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,function(t,e){var n,r=cs(t),i=gs.now(),o=e.reduce((function(t,e){return t.add(e.key)}),xu());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Mn.pn(t,o).next((function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var c=u[a],l=ou(c,n.get(c.key));null!=l&&s.push(new cu(c.key,l,Js(l.value.mapValue),tu.exists(!0)))}return r._n.addMutationBatch(t,i,s,e)}))})).then((function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}}))}(r.localStore,e)];case 2:return i=a.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new wu(fs)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,hp(r,i.changes)];case 3:return a.sent(),[4,bf(r.remoteStore)];case 4:return a.sent(),[3,6];case 5:return o=a.sent(),s=Cf(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}}))}))}function Jf(t,e){return Bt(this,void 0,void 0,(function(){var n,r;return Kt(this,(function(i){switch(i.label){case 0:n=cs(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,ph(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach((function(t,e){var r=n.Co.get(e);r&&(us(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?us(r.bo):t.removedDocuments.size>0&&(us(r.bo),r.bo=!1))})),[4,hp(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Vl(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function Zf(t,e,n){var r=cs(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach((function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=cs(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)})),r&&jf(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function tp(t,e,n){return Bt(this,void 0,void 0,(function(){var r,i,o,s,a,u;return Kt(this,(function(c){switch(c.label){case 0:return(r=cs(t)).sharedClientState.updateQueryState(e,"rejected",n),i=r.Co.get(e),(o=i&&i.key)?(s=(s=new wu(Fs.comparator)).insert(o,Zs.newNoDocument(o,vs.min())),a=xu().add(o),u=new Lu(vs.min(),new Map,new Tu(fs),s,a),[4,Jf(r,u)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),lp(r),[3,4];case 2:return[4,vh(r.localStore,e,!1).then((function(){return sp(r,e,n)})).catch(Vl)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function ep(t,e){return Bt(this,void 0,void 0,(function(){var n,r,i;return Kt(this,(function(o){switch(o.label){case 0:n=cs(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,hh(n.localStore,e)];case 2:return i=o.sent(),op(n,r,null),ip(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,hp(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Vl(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function np(t,e,n){return Bt(this,void 0,void 0,(function(){var r,i;return Kt(this,(function(o){switch(o.label){case 0:r=cs(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=cs(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n._n.lookupMutationBatch(t,e).next((function(e){return us(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}(r.localStore,e)];case 2:return i=o.sent(),op(r,e,n),ip(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,hp(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Vl(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function rp(t,e){return Bt(this,void 0,void 0,(function(){var n,r,i,o,s;return Kt(this,(function(a){switch(a.label){case 0:ff((n=cs(t)).remoteStore)||rs("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,function(t){var e=cs(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e._n.getHighestUnacknowledgedBatchId(t)}))}(n.localStore)];case 2:return-1===(r=a.sent())?[2,void e.resolve()]:((i=n.Fo.get(r)||[]).push(e),n.Fo.set(r,i),[3,4]);case 3:return o=a.sent(),s=Cf(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}}))}))}function ip(t,e){(t.Fo.get(e)||[]).forEach((function(t){t.resolve()})),t.Fo.delete(e)}function op(t,e,n){var r=cs(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function sp(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach((function(e){t.No.containsKey(e)||ap(t,e)}))}function ap(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(af(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),lp(t))}function up(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Bf?(t.No.addReference(o.key,e),cp(t,o)):o instanceof Kf?(rs("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||ap(t,o.key)):as()}}function cp(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(rs("SyncEngine","New document in limbo: "+n),t.So.add(r),lp(t))}function lp(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new Fs(Es.fromString(e)),r=t.ko.next();t.Co.set(r,new $f(n)),t.Do=t.Do.insert(n,r),sf(t.remoteStore,new ol(ka(Ia(n.path)),r,2,Jo.o))}}function hp(t,e,n){return Bt(this,void 0,void 0,(function(){var r,i,o,s;return Kt(this,(function(a){switch(a.label){case 0:return r=cs(t),i=[],o=[],s=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach((function(t,a){s.push(r.Oo(a,e,n).then((function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=sh.Pn(a.targetId,t);o.push(e)}})))})),[4,Promise.all(s)]);case 1:return a.sent(),r.vo._r(i),[4,function(t,e){return Bt(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,l;return Kt(this,(function(h){switch(h.label){case 0:n=cs(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return Gc.forEach(e,(function(e){return Gc.forEach(e.bn,(function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)})).next((function(){return Gc.forEach(e.vn,(function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)}))}))}))}))];case 2:return h.sent(),[3,4];case 3:if(!Xc(r=h.sent()))throw r;return rs("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)s=o[i],a=s.targetId,s.fromCache||(u=n.Fn.get(a),c=u.snapshotVersion,l=u.withLastLimboFreeSnapshotVersion(c),n.Fn=n.Fn.insert(a,l));return[2]}}))}))}(r.localStore,o)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function fp(t,e){return Bt(this,void 0,void 0,(function(){var n,r;return Kt(this,(function(i){switch(i.label){case 0:return(n=cs(t)).currentUser.isEqual(e)?[3,3]:(rs("SyncEngine","User change. New user:",e.toKey()),[4,lh(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Fo.forEach((function(t){t.forEach((function(t){t.reject(new ts(Zo.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Fo.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,hp(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function pp(t,e){var n=cs(t),r=n.Co.get(e);if(r&&r.bo)return xu().add(r.key);var i=xu(),o=n.Vo.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=a[s],c=n.Po.get(u);i=i.unionWith(c.view.wo)}return i}function dp(t,e){return Bt(this,void 0,void 0,(function(){var n,r,i;return Kt(this,(function(o){switch(o.label){case 0:return[4,yh((n=cs(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&up(n,e.targetId,i.To),i)]}}))}))}function gp(t){return Bt(this,void 0,void 0,(function(){var e;return Kt(this,(function(n){return[2,bh((e=cs(t)).localStore).then((function(t){return hp(e,t)}))]}))}))}function vp(t,e,n,r){return Bt(this,void 0,void 0,(function(){var i,o;return Kt(this,(function(s){switch(s.label){case 0:return[4,function(t,e){var n=cs(t),r=cs(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.jt(t,e).next((function(e){return e?n.Mn.pn(t,e):Gc.resolve(null)}))}))}((i=cs(t)).localStore,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,bf(i.remoteStore)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(op(i,e,r||null),ip(i,e),function(t,e){cs(cs(t)._n).Gt(e)}(i.localStore,e)):as(),s.label=4;case 4:return[4,hp(i,o)];case 5:return s.sent(),[3,7];case 6:rs("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}}))}))}function yp(t,e){return Bt(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c;return Kt(this,(function(l){switch(l.label){case 0:return Tp(n=cs(t)),_p(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,mp(n,r.toArray())]);case 1:return i=l.sent(),n.$o=!0,[4,Af(n.remoteStore,!0)];case 2:for(l.sent(),o=0,s=i;o<s.length;o++)a=s[o],sf(n.remoteStore,a);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(u=[],c=Promise.resolve(),n.Vo.forEach((function(t,e){n.sharedClientState.isLocalQueryTarget(e)?u.push(e):c=c.then((function(){return sp(n,e),vh(n.localStore,e,!0)})),af(n.remoteStore,e)})),[4,c]);case 4:return l.sent(),[4,mp(n,u)];case 5:return l.sent(),function(t){var e=cs(t);e.Co.forEach((function(t,n){af(e.remoteStore,n)})),e.No.ts(),e.Co=new Map,e.Do=new wu(Fs.comparator)}(n),n.$o=!1,[4,Af(n.remoteStore,!1)];case 6:l.sent(),l.label=7;case 7:return[2]}}))}))}function mp(t,e,n){return Bt(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,l,h,f,p,d,g;return Kt(this,(function(v){switch(v.label){case 0:n=cs(t),r=[],i=[],o=0,s=e,v.label=1;case 1:return o<s.length?(a=s[o],u=void 0,(c=n.Vo.get(a))&&0!==c.length?[4,gh(n.localStore,ka(c[0]))]:[3,7]):[3,13];case 2:u=v.sent(),l=0,h=c,v.label=3;case 3:return l<h.length?(f=h[l],p=n.Po.get(f),[4,dp(n,p)]):[3,6];case 4:(d=v.sent()).snapshot&&i.push(d.snapshot),v.label=5;case 5:return l++,[3,3];case 6:return[3,11];case 7:return[4,mh(n.localStore,a)];case 8:return g=v.sent(),[4,gh(n.localStore,g)];case 9:return u=v.sent(),[4,Wf(n,bp(g),a,!1)];case 10:v.sent(),v.label=11;case 11:r.push(u),v.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}}))}))}function bp(t){return Ea(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function wp(t){var e=cs(t);return cs(cs(e.localStore).persistence).fn()}function Ep(t,e,n,r){return Bt(this,void 0,void 0,(function(){var i,o,s;return Kt(this,(function(a){switch(a.label){case 0:return(i=cs(t)).$o?(rs("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,bh(i.localStore)];case 3:return o=a.sent(),s=Lu.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,hp(i,o,s)];case 4:return a.sent(),[3,8];case 5:return[4,vh(i.localStore,e,!0)];case 6:return a.sent(),sp(i,e,r),[3,8];case 7:as(),a.label=8;case 8:return[2]}}))}))}function Ip(t,e,n){return Bt(this,void 0,void 0,(function(){var r,i,o,s,a,u,c,l,h,f;return Kt(this,(function(p){switch(p.label){case 0:if(!(r=Tp(t)).$o)return[3,10];i=0,o=e,p.label=1;case 1:return i<o.length?(s=o[i],r.Vo.has(s)?(rs("SyncEngine","Adding an already active target "+s),[3,5]):[4,mh(r.localStore,s)]):[3,6];case 2:return a=p.sent(),[4,gh(r.localStore,a)];case 3:return u=p.sent(),[4,Wf(r,bp(a),u.targetId,!1)];case 4:p.sent(),sf(r.remoteStore,u),p.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Kt(this,(function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,vh(r.localStore,t,!1).then((function(){af(r.remoteStore,t),sp(r,t)})).catch(Vl)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},l=0,h=n,p.label=7;case 7:return l<h.length?(f=h[l],[5,c(f)]):[3,10];case 8:p.sent(),p.label=9;case 9:return l++,[3,7];case 10:return[2]}}))}))}function Tp(t){var e=cs(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Jf.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=pp.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=tp.bind(null,e),e.vo._r=Vf.bind(null,e.eventManager),e.vo.Mo=Uf.bind(null,e.eventManager),e}function _p(t){var e=cs(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ep.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=np.bind(null,e),e}var Sp=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Bt(this,void 0,void 0,(function(){return Kt(this,(function(e){switch(e.label){case 0:return this.R=Wh(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Ko(t),[2]}}))}))},t.prototype.Uo=function(t){return null},t.prototype.Ko=function(t){return ch(this.persistence,new ah,t.initialUser,this.R)},t.prototype.qo=function(t){return new Dh(Ch.bs,this.R)},t.prototype.Bo=function(t){return new qh},t.prototype.terminate=function(){return Bt(this,void 0,void 0,(function(){return Kt(this,(function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}}))}))},t}(),Ap=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qo=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return jt(e,t),e.prototype.initialize=function(e){return Bt(this,void 0,void 0,(function(){return Kt(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,wh(this.localStore)];case 2:return n.sent(),[4,this.Qo.initialize(this,e)];case 3:return n.sent(),[4,_p(this.Qo.syncEngine)];case 4:return n.sent(),[4,bf(this.Qo.remoteStore)];case 5:return n.sent(),[2]}}))}))},e.prototype.Ko=function(t){return ch(this.persistence,new ah,t.initialUser,this.R)},e.prototype.Uo=function(t){var e=this.persistence.referenceDelegate.garbageCollector;return new ql(e,t.asyncQueue)},e.prototype.qo=function(t){var e=ih(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Sl.withCacheSize(this.cacheSizeBytes):Sl.DEFAULT;return new eh(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,Hh(),Qh(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new qh},e}(Sp),Np=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Qo=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return jt(e,t),e.prototype.initialize=function(e){return Bt(this,void 0,void 0,(function(){var n,r=this;return Kt(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Qo.syncEngine,this.sharedClientState instanceof jh?(this.sharedClientState.syncEngine={ui:vp.bind(null,n),ai:Ep.bind(null,n),hi:Ip.bind(null,n),fn:wp.bind(null,n),ci:gp.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He((function(t){return Bt(r,void 0,void 0,(function(){return Kt(this,(function(e){switch(e.label){case 0:return[4,yp(this.Qo.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.Bo=function(t){var e=Hh();if(!jh.yt(e))throw new ts(Zo.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=ih(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new jh(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(Ap),Dp=function(){function t(){}return t.prototype.initialize=function(t,e){return Bt(this,void 0,void 0,(function(){var n=this;return Kt(this,(function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return Zf(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=fp.bind(null,this.syncEngine),[4,Af(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.createEventManager=function(t){return new Pf},t.prototype.createDatastore=function(t){var e,n=Wh(t.databaseInfo.databaseId),r=(e=t.databaseInfo,new $h(e));return function(t,e,n){return new tf(t,e,n)}(t.credentials,r,n)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,s=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return Zf(s.syncEngine,t,0)},o=Kh.yt()?new Kh:new Bh,new nf(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,s){var a=new Hf(t,e,n,r,i,o);return s&&(a.$o=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return Bt(this,void 0,void 0,(function(){var e;return Kt(this,(function(n){switch(n.label){case 0:return e=cs(t),rs("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,of(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}}))}))}(this.remoteStore)},t}(),kp=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),Cp=function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return Bt(this,void 0,void 0,(function(){var e,n=this;return Kt(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new ts(Zo.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Bt(this,void 0,void 0,(function(){var n,r,i,o,s,a;return Kt(this,(function(u){switch(u.label){case 0:return n=cs(t),r=nc(n.R)+"/documents",i={documents:e.map((function(t){return Ju(n.R,t)}))},[4,n.$i("BatchGetDocuments",r,i)];case 1:return o=u.sent(),s=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){us(!!e.found),e.found.name,e.found.updateTime;var n=Zu(t,e.found.name),r=Wu(e.found.updateTime),i=new Ys({mapValue:{fields:e.found.fields}});return Zs.newFoundDocument(n,r,i)}(t,e):"missing"in e?function(t,e){us(!!e.missing),us(!!e.readTime);var n=Zu(t,e.missing),r=Wu(e.readTime);return Zs.newNoDocument(n,r)}(t,e):as()}(n.R,t);s.set(e.key.toString(),e)})),a=[],[2,(e.forEach((function(t){var e=s.get(t.toString());us(!!e),a.push(e)})),a)]}}))}))}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach((function(t){return n.recordVersion(t)})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new gu(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return Bt(this,void 0,void 0,(function(){var t,e=this;return Kt(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=Fs.fromPath(n);e.mutations.push(new vu(r,e.precondition(r)))})),[4,function(t,e){return Bt(this,void 0,void 0,(function(){var n,r,i;return Kt(this,(function(o){switch(o.label){case 0:return n=cs(t),r=nc(n.R)+"/documents",i={writes:e.map((function(t){return oc(n.R,t)}))},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw as();e=vs.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new ts(Zo.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?tu.updateTime(e):tu.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(vs.min()))throw new ts(Zo.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return tu.updateTime(e)}return tu.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}(),xp=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new Xh(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.ec-=1,this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji((function(){return Bt(t,void 0,void 0,(function(){var t,e,n=this;return Kt(this,(function(r){return t=new Cp(this.datastore),(e=this.sc(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.ic(t)}))}))})).catch((function(t){n.ic(t)})),[2]}))}))}))},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!Os(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget((function(){return e.nc(),Promise.resolve()}))):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!mu(e)}return!1},t}(),Rp=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=xh.UNAUTHENTICATED,this.clientId=hs.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,(function(t){return Bt(r,void 0,void 0,(function(){return Kt(this,(function(e){switch(e.label){case 0:return rs("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}}))}))}))}return t.prototype.getConfiguration=function(){return Bt(this,void 0,void 0,(function(){return Kt(this,(function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]}))}))},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new ts(Zo.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new zc;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((function(){return Bt(t,void 0,void 0,(function(){var t,n;return Kt(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=Cf(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Op(t,e){return Bt(this,void 0,void 0,(function(){var n,r,i=this;return Kt(this,(function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),rs("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener((function(t){return Bt(i,void 0,void 0,(function(){return Kt(this,(function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,lh(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}}))}))})),e.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=e,[2]}}))}))}function Lp(t,e){return Bt(this,void 0,void 0,(function(){var n,r;return Kt(this,(function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,Pp(t)];case 1:return n=i.sent(),rs("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener((function(t){return function(t,e){return Bt(this,void 0,void 0,(function(){var n,r;return Kt(this,(function(i){switch(i.label){case 0:return(n=cs(t)).asyncQueue.verifyOperationInProgress(),rs("RemoteStore","RemoteStore received new credentials"),r=ff(n),n.Or.add(3),[4,of(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,rf(n)];case 3:return i.sent(),[2]}}))}))}(e.remoteStore,t)})),t.onlineComponents=e,[2]}}))}))}function Pp(t){return Bt(this,void 0,void 0,(function(){return Kt(this,(function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(rs("FirestoreClient","Using default OfflineComponentProvider"),[4,Op(t,new Sp)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}}))}))}function Fp(t){return Bt(this,void 0,void 0,(function(){return Kt(this,(function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(rs("FirestoreClient","Using default OnlineComponentProvider"),[4,Lp(t,new Dp)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}}))}))}function Mp(t){return Pp(t).then((function(t){return t.persistence}))}function Vp(t){return Pp(t).then((function(t){return t.localStore}))}function Up(t){return Fp(t).then((function(t){return t.remoteStore}))}function jp(t){return Fp(t).then((function(t){return t.syncEngine}))}function qp(t){return Bt(this,void 0,void 0,(function(){var e,n;return Kt(this,(function(r){switch(r.label){case 0:return[4,Fp(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=Qf.bind(null,e.syncEngine),n.onUnlisten=Xf.bind(null,e.syncEngine),n)]}}))}))}function Bp(t,e,n){var r=this;void 0===n&&(n={});var i=new zc;return t.asyncQueue.enqueueAndForget((function(){return Bt(r,void 0,void 0,(function(){var r;return Kt(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new kp({next:function(o){e.enqueueAndForget((function(){return Mf(t,s)}));var a=o.docs.has(n);!a&&o.fromCache?i.reject(new ts(Zo.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new ts(Zo.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new qf(Ia(n.path),o,{includeMetadataChanges:!0,so:!0});return Ff(t,s)},[4,qp(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}function Kp(t,e,n){var r=this;void 0===n&&(n={});var i=new zc;return t.asyncQueue.enqueueAndForget((function(){return Bt(r,void 0,void 0,(function(){var r;return Kt(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new kp({next:function(n){e.enqueueAndForget((function(){return Mf(t,s)})),n.fromCache&&"server"===r.source?i.reject(new ts(Zo.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new qf(n,o,{includeMetadataChanges:!0,so:!0});return Ff(t,s)},[4,qp(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}var zp=function(t,e,n,r,i,o,s,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=a},Gp=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),$p=new Map,Hp=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},Qp=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable((function(){return e(xh.UNAUTHENTICATED)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Wp=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable((function(){return e(n.token.user)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Xp=function(){function t(t){var e=this;this.currentUser=xh.UNAUTHENTICATED,this.oc=new zc,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.ac(),e.oc.resolve(),e.changeListener&&e.asyncQueue.enqueueRetryable((function(){return e.changeListener(e.currentUser)}))};var n=function(t){rs("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.auth.addAuthTokenListener(e.uc)};t.onInit((function(t){return n(t)})),setTimeout((function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):(rs("FirebaseCredentialsProvider","Auth not yet detected"),e.oc.resolve())}}),0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.cc!==e?(rs("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(us("string"==typeof n.accessToken),new Hp(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){var n=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable((function(){return Bt(n,void 0,void 0,(function(){return Kt(this,(function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,e(this.currentUser)];case 2:return t.sent(),this.changeListener=e,[2]}}))}))}))},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return us(null===t||"string"==typeof t),new xh(t)},t}(),Yp=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n,this.type="FirstParty",this.user=xh.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},e=this.hc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),t}(),Jp=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n}return t.prototype.getToken=function(){return Promise.resolve(new Yp(this.hc,this.lc,this.fc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable((function(){return e(xh.FIRST_PARTY)}))},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Zp(t,e,n){if(!n)throw new ts(Zo.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function td(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new ts(Zo.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function ed(t,e,n,r){if(!0===e&&!0===r)throw new ts(Zo.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function nd(t){if(!Fs.isDocumentKey(t))throw new ts(Zo.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function rd(t){if(Fs.isDocumentKey(t))throw new ts(Zo.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function id(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":as()}function od(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ts(Zo.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=id(t);throw new ts(Zo.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function sd(t,e){if(e<=0)throw new ts(Zo.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ad=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new ts(Zo.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new ts(Zo.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,ed("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},t}(),ud=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ad({}),this._settingsFrozen=!1,t instanceof Gp?(this._databaseId=t,this._credentials=new Qp):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new ts(Zo.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Gp(t.options.projectId)}(t),this._credentials=new Xp(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new ts(Zo.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new ts(Zo.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ad(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new Qp;switch(t.type){case"gapi":var e=t.client;return us(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Jp(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new ts(Zo.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return this,(t=$p.get(this))&&(rs("ComponentProvider","Removing Datastore"),$p.delete(this),t.terminate()),Promise.resolve();var t},t}(),cd=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new hd(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),ld=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),hd=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,Ia(r))||this)._path=r,i.type="collection",i}return jt(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new cd(this.firestore,null,new Fs(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(ld);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function fd(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=se(t),Zp("collection","path",e),t instanceof ud)return rd(n=Es.fromString.apply(Es,$t([e],r))),new hd(t,null,n);if(!(t instanceof cd||t instanceof hd))throw new ts(Zo.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return rd(n=Es.fromString.apply(Es,$t([t.path],r)).child(Es.fromString(e))),new hd(t.firestore,null,n)}function pd(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=se(t),1===arguments.length&&(e=hs.u()),Zp("doc","path",e),t instanceof ud)return nd(n=Es.fromString.apply(Es,$t([e],r))),new cd(t,null,new Fs(n));if(!(t instanceof cd||t instanceof hd))throw new ts(Zo.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return nd(n=t._path.child(Es.fromString.apply(Es,$t([e],r)))),new cd(t.firestore,t instanceof hd?t.converter:null,new Fs(n))}function dd(t,e){return t=se(t),e=se(e),(t instanceof cd||t instanceof hd)&&(e instanceof cd||e instanceof hd)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function gd(t,e){return t=se(t),e=se(e),t instanceof ld&&e instanceof ld&&t.firestore===e.firestore&&xa(t._query,e._query)&&t.converter===e.converter
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var vd=function(){function t(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=!1,this.Tc=[],this.Zi=new Xh(this,"async_queue_retry"),this.Ic=function(){var e=Qh();e&&rs("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=Qh();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ic)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ac(),this.Rc(t)},t.prototype.enterRestrictedMode=function(t){if(!this._c){this._c=!0,this.Ec=t||!1;var e=Qh();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Ic)}},t.prototype.enqueue=function(t){var e=this;if(this.Ac(),this._c)return new Promise((function(){}));var n=new zc;return this.Rc((function(){return e._c&&e.Ec?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget((function(){return e.wc.push(t),e.bc()}))},t.prototype.bc=function(){return Bt(this,void 0,void 0,(function(){var t,e=this;return Kt(this,(function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!Xc(t=n.sent()))throw t;return rs("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.wc.length>0&&this.Zi.ji((function(){return e.bc()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Rc=function(t){var e=this,n=this.dc.then((function(){return e.gc=!0,t().catch((function(t){throw e.yc=t,e.gc=!1,is("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.gc=!1,t}))}));return this.dc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Ac(),this.Tc.indexOf(t)>-1&&(e=0);var i=kf.createAndSchedule(this,t,e,n,(function(t){return r.vc(t)}));return this.mc.push(i),i},t.prototype.Ac=function(){this.yc&&as()},t.prototype.verifyOperationInProgress=function(){},t.prototype.Pc=function(){return Bt(this,void 0,void 0,(function(){var t;return Kt(this,(function(e){switch(e.label){case 0:return[4,t=this.dc];case 1:e.sent(),e.label=2;case 2:if(t!==this.dc)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Vc=function(t){for(var e=0,n=this.mc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Sc=function(t){var e=this;return this.Pc().then((function(){e.mc.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.Pc()}))},t.prototype.Dc=function(t){this.Tc.push(t)},t.prototype.vc=function(t){var e=this.mc.indexOf(t);this.mc.splice(e,1)},t}();function yd(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var md=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new vd,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return jt(e,t),e.prototype._terminate=function(){return this._firestoreClient||wd(this),this._firestoreClient.terminate()},e}(ud);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function bd(t){return t._firestoreClient||wd(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function wd(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new zp(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new Rp(t._credentials,t._queue,r)}function Ed(t,e,n){var r=this,i=new zc;return t.asyncQueue.enqueue((function(){return Bt(r,void 0,void 0,(function(){var r;return Kt(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,Op(t,n)];case 1:return o.sent(),[4,Lp(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===Zo.FAILED_PRECONDITION||t.code===Zo.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function Id(t){if(t._initialized||t._terminated)throw new ts(Zo.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Td=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new ts(Zo.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ts(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),_d=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(Ss.fromBase64String(e))}catch(e){throw new ts(Zo.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(Ss.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),Sd=function(t){this._methodName=t},Ad=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new ts(Zo.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new ts(Zo.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return fs(this._lat,t._lat)||fs(this._long,t._long)},t}(),Nd=/^__.*__$/,Dd=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new cu(t,this.data,this.fieldMask,e,this.fieldTransforms):new uu(t,this.data,e,this.fieldTransforms)},t}(),kd=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new cu(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Cd(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw as()}}var xd=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Cc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Nc",{get:function(){return this.settings.Nc},enumerable:!1,configurable:!0}),t.prototype.xc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.Fc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.xc({path:n,kc:!1});return r.$c(t),r},t.prototype.Oc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.xc({path:n,kc:!1});return r.Cc(),r},t.prototype.Mc=function(t){return this.xc({path:void 0,kc:!0})},t.prototype.Lc=function(t){return Yd(t,this.settings.methodName,this.settings.Bc||!1,this.path,this.settings.qc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},t.prototype.Cc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.$c(this.path.get(t))},t.prototype.$c=function(t){if(0===t.length)throw this.Lc("Document fields must not be empty");if(Cd(this.Nc)&&Nd.test(t))throw this.Lc('Document fields cannot begin and end with "__"')},t}(),Rd=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||Wh(t)}return t.prototype.Uc=function(t,e,n,r){return void 0===r&&(r=!1),new xd({Nc:t,methodName:e,qc:n,path:Ts.emptyPath(),kc:!1,Bc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function Od(t){var e=t._freezeSettings(),n=Wh(t._databaseId);return new Rd(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Ld(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Uc(o.merge||o.mergeFields?2:0,e,n,i);Hd("Data must be an object, but it was:",s,r);var a,u,c=Gd(r,s);if(o.merge)a=new _s(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){for(var l=[],h=0,f=o.mergeFields;h<f.length;h++){var p=Qd(e,f[h],n);if(!s.contains(p))throw new ts(Zo.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Jd(l,p)||l.push(p)}a=new _s(l),u=s.fieldTransforms.filter((function(t){return a.covers(t.field)}))}else a=null,u=s.fieldTransforms;return new Dd(new Ys(c),a,u)}var Pd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return jt(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.Nc)throw 1===t.Nc?t.Lc(this._methodName+"() can only appear at the top level of your update data"):t.Lc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(Sd);function Fd(t,e,n){return new xd({Nc:3,qc:e.settings.qc,methodName:t._methodName,kc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var Md=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return jt(e,t),e.prototype._toFieldTransform=function(t){return new Ja(t.path,new za)},e.prototype.isEqual=function(t){return t instanceof e},e}(Sd),Vd=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return jt(e,t),e.prototype._toFieldTransform=function(t){var e=Fd(this,t,!0),n=this.Kc.map((function(t){return zd(t,e)})),r=new Ga(n);return new Ja(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Sd),Ud=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return jt(e,t),e.prototype._toFieldTransform=function(t){var e=Fd(this,t,!0),n=this.Kc.map((function(t){return zd(t,e)})),r=new Ha(n);return new Ja(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Sd),jd=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Qc=n,r}return jt(e,t),e.prototype._toFieldTransform=function(t){var e=new Wa(t.R,Ua(t.R,this.Qc));return new Ja(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(Sd);function qd(t,e,n,r){var i=t.Uc(1,e,n);Hd("Data must be an object, but it was:",i,r);var o=[],s=Ys.empty();ms(r,(function(t,r){var a=Xd(e,t,n);r=se(r);var u=i.Oc(a);if(r instanceof Pd)o.push(a);else{var c=zd(r,u);null!=c&&(o.push(a),s.set(a,c))}}));var a=new _s(o);return new kd(s,a,i.fieldTransforms)}function Bd(t,e,n,r,i,o){var s=t.Uc(1,e,n),a=[Qd(e,r,n)],u=[i];if(o.length%2!=0)throw new ts(Zo.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(Qd(e,o[c])),u.push(o[c+1]);for(var l=[],h=Ys.empty(),f=a.length-1;f>=0;--f)if(!Jd(l,a[f])){var p=a[f],d=u[f];d=se(d);var g=s.Oc(p);if(d instanceof Pd)l.push(p);else{var v=zd(d,g);null!=v&&(l.push(p),h.set(p,v))}}var y=new _s(l);return new kd(h,y,s.fieldTransforms)}function Kd(t,e,n,r){return void 0===r&&(r=!1),zd(n,t.Uc(r?4:3,e))}function zd(t,e){if($d(t=se(t)))return Hd("Unsupported field value:",e,t),Gd(t,e);if(t instanceof Sd)return function(t,e){if(!Cd(e.Nc))throw e.Lc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Lc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.kc&&4!==e.Nc)throw e.Lc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=zd(o[i],e.Mc(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=se(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Ua(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=gs.fromDate(t);return{timestampValue:$u(e.R,n)}}if(t instanceof gs)return n=new gs(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:$u(e.R,n)};if(t instanceof Ad)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof _d)return{bytesValue:Hu(e.R,t._byteString)};if(t instanceof cd){n=e.databaseId;var r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Lc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Xu(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Lc("Unsupported field value: "+id(t))}(t,e)}function Gd(t,e){var n={};return bs(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ms(t,(function(t,r){var i=zd(r,e.Fc(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function $d(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof gs||t instanceof Ad||t instanceof _d||t instanceof cd||t instanceof Sd)}function Hd(t,e,n){if(!$d(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=id(n);throw"an object"===r?e.Lc(t+" a custom object"):e.Lc(t+" "+r)}}function Qd(t,e,n){if((e=se(e))instanceof Td)return e._internalPath;if("string"==typeof e)return Xd(t,e);throw Yd("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Wd=new RegExp("[~\\*/\\[\\]]");function Xd(t,e,n){if(e.search(Wd)>=0)throw Yd("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(Td.bind.apply(Td,$t([void 0],e.split(".")))))._internalPath}catch(r){throw Yd("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Yd(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new ts(Zo.INVALID_ARGUMENT,(a+=". ")+t+u)}function Jd(t,e){return t.some((function(t){return t.isEqual(e)}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Zd=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new cd(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new tg(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(eg("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),tg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return jt(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Zd);function eg(t,e){return"string"==typeof e?Xd(t,e):e instanceof Td?e._internalPath:e._delegate._internalPath}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ng=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),rg=function(t){function e(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this)._firestore=e,a._firestoreImpl=e,a.metadata=o,a}return jt(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new ig(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(eg("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(Zd),ig=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return jt(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(rg),og=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new ng(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach((function(r){t.call(e,new ig(n._firestore,n._userDataWriter,r.key,r,new ng(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new ts(Zo.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map((function(e){return{type:"added",doc:new ig(t._firestore,t._userDataWriter,e.doc.key,e.doc,new ng(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:n++}}))}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new ig(t._firestore,t._userDataWriter,e.doc.key,e.doc,new ng(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:sg(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function sg(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return as()}}function ag(t,e){return t instanceof rg&&e instanceof rg?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof og&&e instanceof og&&t._firestore===e._firestore&&gd(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ug(t){if(_a(t)&&0===t.explicitOrderBy.length)throw new ts(Zo.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var cg=function(){};function lg(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var hg=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).jc=e,i.Wc=n,i.Gc=r,i.type="where",i}return jt(e,t),e.prototype._apply=function(t){var e=Od(t.firestore),n=function(t,e,n,r,i,o,s){var a;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new ts(Zo.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){mg(s,o);for(var u=[],c=0,l=s;c<l.length;c++){var h=l[c];u.push(yg(r,t,h))}a={arrayValue:{values:u}}}else a=yg(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||mg(s,o),a=Kd(n,"where",s,"in"===o||"not-in"===o);var f=oa.create(i,o,a);return function(t,e){if(e.g()){var n=Aa(t);if(null!==n&&!n.isEqual(e.field))throw new ts(Zo.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Sa(t);null!==r&&bg(t,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new ts(Zo.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new ts(Zo.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t._query,0,e,t.firestore._databaseId,this.jc,this.Wc,this.Gc);return new ld(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new wa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(cg),fg=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).jc=e,r.zc=n,r.type="orderBy",r}return jt(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new ts(Zo.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new ts(Zo.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new va(e,n);return function(t,e){if(null===Sa(t)){var n=Aa(t);null!==n&&bg(t,n,e.field)}}(t,r),r}(t._query,this.jc,this.zc);return new ld(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new wa(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(cg),pg=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Hc=n,i.Jc=r,i}return jt(e,t),e.prototype._apply=function(t){return new ld(t.firestore,t.converter,Ca(t._query,this.Hc,this.Jc))},e}(cg),dg=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Yc=n,i.Xc=r,i}return jt(e,t),e.prototype._apply=function(t){var e=vg(t,this.type,this.Yc,this.Xc);return new ld(t.firestore,t.converter,function(t,e){return new wa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(cg),gg=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Yc=n,i.Xc=r,i}return jt(e,t),e.prototype._apply=function(t){var e=vg(t,this.type,this.Yc,this.Xc);return new ld(t.firestore,t.converter,function(t,e){return new wa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(cg);function vg(t,e,n,r){if(n[0]=se(n[0]),n[0]instanceof Zd)return function(t,e,n,r,i){if(!r)throw new ts(Zo.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=Da(t);s<a.length;s++){var u=a[s];if(u.field.isKeyField())o.push(zs(e,r.key));else{var c=r.data.field(u.field);if(Cs(c))throw new ts(Zo.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var l=u.field.canonicalString();throw new ts(Zo.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+l+"' (used as the orderBy) does not exist.")}o.push(c)}}return new da(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=Od(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new ts(Zo.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.isKeyField()){if("string"!=typeof c)throw new ts(Zo.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Na(t)&&-1!==c.indexOf("/"))throw new ts(Zo.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var l=t.path.child(Es.fromString(c));if(!Fs.isDocumentKey(l))throw new ts(Zo.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+l+"' is not because it contains an odd number of segments.");var h=new Fs(l);a.push(zs(e,h))}else{var f=Kd(n,r,c);a.push(f)}}return new da(a,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function yg(t,e,n){if("string"==typeof(n=se(n))){if(""===n)throw new ts(Zo.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Na(e)&&-1!==n.indexOf("/"))throw new ts(Zo.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Es.fromString(n));if(!Fs.isDocumentKey(r))throw new ts(Zo.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return zs(t,new Fs(r))}if(n instanceof cd)return zs(t,n._key);throw new ts(Zo.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+id(n)+".")}function mg(t,e){if(!Array.isArray(t)||0===t.length)throw new ts(Zo.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new ts(Zo.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function bg(t,e,n){if(!n.isEqual(e))throw new ts(Zo.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var wg=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),Ms(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ds(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(ks(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw as()}},t.prototype.convertObject=function(t,e){var n=this,r={};return ms(t.fields,(function(t,i){r[t]=n.convertValue(i,e)})),r},t.prototype.convertGeoPoint=function(t){return new Ad(Ds(t.latitude),Ds(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=xs(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(Rs(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=Ns(t);return new gs(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=Es.fromString(t);us(wc(n));var r=new Gp(n.get(1),n.get(3)),i=new Fs(n.popFirst(5));return r.isEqual(e)||is("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Eg(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Ig=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return jt(e,t),e.prototype.convertBytes=function(t){return new _d(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new cd(this.firestore,null,e)},e}(wg),Tg=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=Od(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=_g(t,this._firestore),i=Eg(r.converter,e,n),o=Ld(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,tu.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,s=_g(t,this._firestore);return o="string"==typeof(e=se(e))||e instanceof Td?Bd(this._dataReader,"WriteBatch.update",s._key,e,n,r):qd(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(o.toMutation(s._key,tu.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=_g(t,this._firestore);return this._mutations=this._mutations.concat(new gu(e._key,tu.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new ts(Zo.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function _g(t,e){if((t=se(t)).firestore!==e)throw new ts(Zo.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Sg=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return jt(e,t),e.prototype.convertBytes=function(t){return new _d(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new cd(this.firestore,null,e)},e}(wg);function Ag(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=od(t,cd);var o=od(t.firestore,md),s=Od(o);return Dg(o,[("string"==typeof(e=se(e))||e instanceof Td?Bd(s,"updateDoc",t._key,e,n,r):qd(s,"updateDoc",t._key,e)).toMutation(t._key,tu.exists(!0))])}function Ng(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t=se(t);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||yd(i[a])||(s=i[a],a++);var u,c,l,h={includeMetadataChanges:s.includeMetadataChanges};if(yd(i[a])){var f=i[a];i[a]=null===(e=f.next)||void 0===e?void 0:e.bind(f),i[a+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),i[a+2]=null===(r=f.complete)||void 0===r?void 0:r.bind(f)}if(t instanceof cd)c=od(t.firestore,md),l=Ia(t._key.path),u={next:function(e){i[a]&&i[a](kg(c,t,e))},error:i[a+1],complete:i[a+2]};else{var p=od(t,ld);c=od(p.firestore,md),l=p._query;var d=new Sg(c);u={next:function(t){i[a]&&i[a](new og(c,d,p,t))},error:i[a+1],complete:i[a+2]},ug(t._query)}return function(t,e,n,r){var i=this,o=new kp(r),s=new qf(e,o,n);return t.asyncQueue.enqueueAndForget((function(){return Bt(i,void 0,void 0,(function(){var e;return Kt(this,(function(n){switch(n.label){case 0:return e=Ff,[4,qp(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))})),function(){o.Wo(),t.asyncQueue.enqueueAndForget((function(){return Bt(i,void 0,void 0,(function(){var e;return Kt(this,(function(n){switch(n.label){case 0:return e=Mf,[4,qp(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))}))}}(bd(c),l,h,u)}function Dg(t,e){return function(t,e){var n=this,r=new zc;return t.asyncQueue.enqueueAndForget((function(){return Bt(n,void 0,void 0,(function(){var n;return Kt(this,(function(i){switch(i.label){case 0:return n=Yf,[4,jp(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(bd(t),e)}function kg(t,e,n){var r=n.docs.get(e._key),i=new Sg(t);return new rg(t,i,e._key,r,new ng(n.hasPendingWrites,n.fromCache),e.converter)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Cg=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return jt(e,t),e.prototype.get=function(e){var n=this,r=_g(e,this._firestore),i=new Sg(this._firestore);return t.prototype.get.call(this,e).then((function(t){return new rg(n._firestore,i,r._key,t._document,new ng(!1,!1),r.converter)}))},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=Od(t)}return t.prototype.get=function(t){var e=this,n=_g(t,this._firestore),r=new Ig(this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return as();var i=t[0];if(i.isFoundDocument())return new Zd(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new Zd(e._firestore,r,n._key,null,n.converter);throw as()}))},t.prototype.set=function(t,e,n){var r=_g(t,this._firestore),i=Eg(r.converter,e,n),o=Ld(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=_g(t,this._firestore);return o="string"==typeof(e=se(e))||e instanceof Td?Bd(this._dataReader,"Transaction.update",s._key,e,n,r):qd(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,o),this},t.prototype.delete=function(t){var e=_g(t,this._firestore);return this._transaction.delete(e._key),this},t}());
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function xg(){if("undefined"==typeof Uint8Array)throw new ts(Zo.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Rg(){if("undefined"==typeof atob)throw new ts(Zo.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Og=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return Rg(),new t(_d.fromBase64String(e))},t.fromUint8Array=function(e){return xg(),new t(_d.fromUint8Array(e))},t.prototype.toBase64=function(){return Rg(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return xg(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),Lg=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Id(t=od(t,md));var n=bd(t),r=t._freezeSettings(),i=new Dp;return Ed(n,i,new Ap(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Id(t=od(t,md));var e=bd(t),n=t._freezeSettings(),r=new Dp;return Ed(e,r,new Np(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new ts(Zo.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new zc;return t._queue.enqueueAndForgetEvenWhileRestricted((function(){return Bt(e,void 0,void 0,(function(){var e;return Kt(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Bt(this,void 0,void 0,(function(){var e;return Kt(this,(function(n){switch(n.label){case 0:return Hc.yt()?(e=t+"main",[4,Hc.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(ih(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._delegate)},t}(),Pg=function(){function t(t,e,n){var r=this;this._delegate=e,this.Zc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof Gp||(this.tu=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||os("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={});var i=(t=od(t,ud))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==e&&os("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:e+":"+n,ssl:!1})),r.mockUserToken){var o=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var o=qt({iss:"https://securetoken.google.com/"+n,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Ht.encodeString(JSON.stringify({alg:"none",type:"JWT"}),!1),Ht.encodeString(JSON.stringify(o),!1),""].join(".")}(r.mockUserToken),s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new ts(Zo.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");t._credentials=new Wp(new Hp(o,new xh(s)))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return Bt(e,void 0,void 0,(function(){var e,n;return Kt(this,(function(r){switch(r.label){case 0:return[4,Mp(t)];case 1:return e=r.sent(),[4,Up(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=cs(t);return e.Or.delete(0),rf(e)}(n))]}}))}))}))}(bd(od(this._delegate,md)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return Bt(e,void 0,void 0,(function(){var e,n;return Kt(this,(function(r){switch(r.label){case 0:return[4,Mp(t)];case 1:return e=r.sent(),[4,Up(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return Bt(this,void 0,void 0,(function(){var e;return Kt(this,(function(n){switch(n.label){case 0:return(e=cs(t)).Or.add(0),[4,of(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(bd(od(this._delegate,md)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&ed("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Zc.enableMultiTabIndexedDbPersistence(this):this.Zc.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.Zc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.tu&&(this.tu._removeServiceInstance("firestore"),this.tu._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new zc;return t.asyncQueue.enqueueAndForget((function(){return Bt(e,void 0,void 0,(function(){var e;return Kt(this,(function(r){switch(r.label){case 0:return e=rp,[4,jp(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(bd(od(this._delegate,md)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new kp(e);return t.asyncQueue.enqueueAndForget((function(){return Bt(n,void 0,void 0,(function(){var e;return Kt(this,(function(n){switch(n.label){case 0:return e=function(t,e){cs(t).Gr.add(e),e.next()},[4,qp(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.Wo(),t.asyncQueue.enqueueAndForget((function(){return Bt(n,void 0,void 0,(function(){var e;return Kt(this,(function(n){switch(n.label){case 0:return e=function(t,e){cs(t).Gr.delete(e)},[4,qp(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(bd(t=od(t,md)),yd(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.tu)throw new ts(Zo.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.tu},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Wg(this,fd(this._delegate,t))}catch(t){throw qg(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new jg(this,pd(this._delegate,t))}catch(t){throw qg(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new $g(this,function(t,e){if(t=od(t,ud),Zp("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new ts(Zo.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new ld(t,null,function(t){return new wa(Es.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw qg(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new zc;return t.asyncQueue.enqueueAndForget((function(){return Bt(n,void 0,void 0,(function(){var n;return Kt(this,(function(i){switch(i.label){case 0:return[4,function(t){return Fp(t).then((function(t){return t.datastore}))}(t)];case 1:return n=i.sent(),new xp(t.asyncQueue,n,e,r).run(),[2]}}))}))})),r.promise}(bd(t),(function(n){return e(new Cg(t,n))}))}(this._delegate,(function(n){return t(new Mg(e,n))}))},t.prototype.batch=function(){var t=this;return bd(this._delegate),new Vg(new Tg(this._delegate,(function(e){return Dg(t._delegate,e)})))},t.prototype.loadBundle=function(t){throw new ts(Zo.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new ts(Zo.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),Fg=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return jt(e,t),e.prototype.convertBytes=function(t){return new Og(new _d(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return jg.eu(e,this.firestore,null)},e}(wg);var Mg=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new Fg(t)}return t.prototype.get=function(t){var e=this,n=Xg(t);return this._delegate.get(n).then((function(t){return new zg(e._firestore,new rg(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))}))},t.prototype.set=function(t,e,n){var r=Xg(t);return n?(td("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Xg(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,$t([s,e,n],i)),this},t.prototype.delete=function(t){var e=Xg(t);return this._delegate.delete(e),this},t}(),Vg=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=Xg(t);return n?(td("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Xg(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,$t([s,e,n],i)),this},t.prototype.delete=function(t){var e=Xg(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),Ug=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new ig(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new Gg(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.nu=function(e,n){var r=t.su,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new Fg(e),n),i.set(n,o)),o},t}();Ug.su=new WeakMap;var jg=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Fg(t)}return t.iu=function(e,n,r){if(e.length%2!=0)throw new ts(Zo.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new cd(n._delegate,r,new Fs(e)))},t.eu=function(e,n,r){return new t(n,new cd(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Wg(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Wg(this.firestore,fd(this._delegate,t))}catch(t){throw qg(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=se(t))instanceof cd&&dd(this._delegate,t)},t.prototype.set=function(t,e){e=td("DocumentReference.set",e);try{return function(t,e,n){t=od(t,cd);var r=od(t.firestore,md),i=Eg(t.converter,e,n);return Dg(r,[Ld(Od(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,tu.none())])}(this._delegate,t,e)}catch(t){throw qg(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Ag(this._delegate,t):Ag.apply(void 0,$t([this._delegate,t,e],n))}catch(t){throw qg(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return Dg(od((t=this._delegate).firestore,md),[new gu(t._key,tu.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Bg(e),i=Kg(e,(function(e){return new zg(t.firestore,new rg(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}));return Ng(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=od(t,cd);var e=od(t.firestore,md),n=bd(e),r=new Sg(e);return function(t,e){var n=this,r=new zc;return t.asyncQueue.enqueueAndForget((function(){return Bt(n,void 0,void 0,(function(){var n;return Kt(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return Bt(this,void 0,void 0,(function(){var r,i;return Kt(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=cs(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Mn.mn(t,e)}))}(t,e)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new ts(Zo.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=Cf(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,Vp(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._key).then((function(n){return new rg(e,r,t._key,n,new ng(null!==n&&n.hasLocalMutations,!0),t.converter)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=od(t,cd);var e=od(t.firestore,md);return Bp(bd(e),t._key,{source:"server"}).then((function(n){return kg(e,t,n)}))}(this._delegate):function(t){t=od(t,cd);var e=od(t.firestore,md);return Bp(bd(e),t._key).then((function(n){return kg(e,t,n)}))}(this._delegate)).then((function(t){return new zg(e.firestore,new rg(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}))},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Ug.nu(this.firestore,e)):this._delegate.withConverter(null))},t}();function qg(t,e,n){return t.message=t.message.replace(e,n),t}function Bg(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!yd(r))return r}return{}}function Kg(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=yd(t[0])?t[0]:yd(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var zg=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new jg(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return ag(this._delegate,t._delegate)},t}(),Gg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return jt(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(zg),$g=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Fg(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,lg(this._delegate,function(t,e,n){var r=e,i=eg("where",t);return new hg(i,r,n)}(e,n,r)))}catch(e){throw qg(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,lg(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=eg("orderBy",t);return new fg(r,n)}(e,n)))}catch(e){throw qg(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,lg(this._delegate,function(t){return sd("limit",t),new pg("limit",t,"F")}(e)))}catch(e){throw qg(e,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,lg(this._delegate,function(t){return sd("limitToLast",t),new pg("limitToLast",t,"L")}(e)))}catch(e){throw qg(e,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,lg(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new dg("startAt",t,!0)}.apply(void 0,e)))}catch(e){throw qg(e,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,lg(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new dg("startAfter",t,!1)}.apply(void 0,e)))}catch(e){throw qg(e,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,lg(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new gg("endBefore",t,!0)}.apply(void 0,e)))}catch(e){throw qg(e,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,lg(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new gg("endAt",t,!1)}.apply(void 0,e)))}catch(e){throw qg(e,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return gd(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=od(t,ld);var e=od(t.firestore,md),n=bd(e),r=new Sg(e);return function(t,e){var n=this,r=new zc;return t.asyncQueue.enqueueAndForget((function(){return Bt(n,void 0,void 0,(function(){var n;return Kt(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return Bt(this,void 0,void 0,(function(){var r,i,o,s,a;return Kt(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,yh(t,e,!0)];case 1:return a=u.sent(),r=new zf(e,a.Bn),i=r._o(a.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=u.sent(),a=Cf(s,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}}))}))},[4,Vp(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._query).then((function(n){return new og(e,r,t,n)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=od(t,ld);var e=od(t.firestore,md),n=bd(e),r=new Sg(e);return Kp(n,t._query,{source:"server"}).then((function(n){return new og(e,r,t,n)}))}(this._delegate):function(t){t=od(t,ld);var e=od(t.firestore,md),n=bd(e),r=new Sg(e);return ug(t._query),Kp(n,t._query).then((function(n){return new og(e,r,t,n)}))}(this._delegate)).then((function(t){return new Qg(e.firestore,new og(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}))},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Bg(e),i=Kg(e,(function(e){return new Qg(t.firestore,new og(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}));return Ng(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Ug.nu(this.firestore,e)):this._delegate.withConverter(null))},t}(),Hg=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new Gg(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),Qg=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new $g(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map((function(e){return new Gg(t._firestore,e)}))},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map((function(t){return new Hg(e._firestore,t)}))},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach((function(r){t.call(e,new Gg(n._firestore,r))}))},t.prototype.isEqual=function(t){return ag(this._delegate,t._delegate)},t}(),Wg=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return jt(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new jg(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new jg(this.firestore,void 0===t?pd(this._delegate):pd(this._delegate,t))}catch(t){throw qg(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=od(t.firestore,md),r=pd(t),i=Eg(t.converter,e);return Dg(n,[Ld(Od(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,tu.exists(!1))]).then((function(){return r}))}(this._delegate,t).then((function(t){return new jg(e.firestore,t)}))},e.prototype.isEqual=function(t){return dd(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(Ug.nu(this.firestore,t)):this._delegate.withConverter(null))},e}($g);function Xg(t){return od(t,cd)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Yg,Jg=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(Td.bind.apply(Td,$t([void 0],t)))}return t.documentId=function(){return new t(Ts.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=se(t))instanceof Td&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),Zg=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new Md("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new Pd("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Vd("arrayUnion",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ud("arrayRemove",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(t){return new jd("increment",t)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}(),tv={Firestore:Pg,GeoPoint:Ad,Timestamp:gs,Blob:Og,Transaction:Mg,WriteBatch:Vg,DocumentReference:jg,DocumentSnapshot:zg,Query:$g,QueryDocumentSnapshot:Gg,QuerySnapshot:Qg,CollectionReference:Wg,FieldPath:Jg,FieldValue:Zg,setLogLevel:function(t){var e;e=t,es.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new ae("firestore",(function(t){return function(t,e){return new Pg(t,new md(t,e),new Lg)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},tv)))})(Yg=Pe),Yg.registerVersion("@firebase/firestore","2.3.9");
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var ev={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},nv=function(t){function e(n,r,i){var o=t.call(this,r)||this;return Object.setPrototypeOf(o,e.prototype),o.code=n,o.details=i,o}return jt(e,t),e}(Error);var rv=function(){function t(t,e){var n=this;this.auth=null,this.messaging=null,this.auth=t.getImmediate({optional:!0}),this.messaging=e.getImmediate({optional:!0}),this.auth||t.get().then((function(t){return n.auth=t}),(function(){})),this.messaging||e.get().then((function(t){return n.messaging=t}),(function(){}))}return t.prototype.getAuthToken=function(){return Bt(this,void 0,void 0,(function(){var t;return Kt(this,(function(e){switch(e.label){case 0:if(!this.auth)return[2,void 0];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return(t=e.sent())?[2,t.accessToken]:[2,void 0];case 3:return e.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getInstanceIdToken=function(){return Bt(this,void 0,void 0,(function(){return Kt(this,(function(t){switch(t.label){case 0:if(!this.messaging||!("Notification"in self)||"granted"!==Notification.permission)return[2,void 0];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.messaging.getToken()];case 2:return[2,t.sent()];case 3:return t.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getContext=function(){return Bt(this,void 0,void 0,(function(){var t,e;return Kt(this,(function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return t=n.sent(),[4,this.getInstanceIdToken()];case 2:return e=n.sent(),[2,{authToken:t,instanceIdToken:e}]}}))}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function iv(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}var ov=function(){function t(){}return t.prototype.encode=function(t){var e=this;if(null==t)return null;if(t instanceof Number&&(t=t.valueOf()),"number"==typeof t&&isFinite(t))return t;if(!0===t||!1===t)return t;if("[object String]"===Object.prototype.toString.call(t))return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map((function(t){return e.encode(t)}));if("function"==typeof t||"object"==typeof t)return iv(t,(function(t){return e.encode(t)}));throw new Error("Data cannot be encoded in JSON: "+t)},t.prototype.decode=function(t){var e=this;if(null==t)return t;if(t["@type"])switch(t["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var n=Number(t.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+t);return n;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map((function(t){return e.decode(t)})):"function"==typeof t||"object"==typeof t?iv(t,(function(t){return e.decode(t)})):t},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var sv=function(){function t(t,e,n,r,i,o){var s=this;void 0===i&&(i="us-central1"),this.app_=t,this.appCheckProvider=r,this.fetchImpl=o,this.serializer=new ov,this.emulatorOrigin=null,this.INTERNAL={delete:function(){return Promise.resolve(s.deleteService())}},this.contextProvider=new rv(e,n),this.cancelAllRequests=new Promise((function(t){s.deleteService=function(){return t()}}));try{var a=new URL(i);this.customDomain=a.origin,this.region="us-central1"}catch(t){this.customDomain=null,this.region=i}}return Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!1,configurable:!0}),t.prototype._url=function(t){var e=this.app_.options.projectId;return null!==this.emulatorOrigin?this.emulatorOrigin+"/"+e+"/"+this.region+"/"+t:null!==this.customDomain?this.customDomain+"/"+t:"https://"+this.region+"-"+e+".cloudfunctions.net/"+t},t.prototype.useEmulator=function(t,e){this.emulatorOrigin="http://"+t+":"+e},t.prototype.useFunctionsEmulator=function(t){this.emulatorOrigin=t},t.prototype.httpsCallable=function(t,e){var n=this;return function(r){return n.call(t,r,e||{})}},t.prototype.postJSON=function(t,e,n){return Bt(this,void 0,void 0,(function(){var r,i,o;return Kt(this,(function(s){switch(s.label){case 0:return n["Content-Type"]="application/json",[4,this.getAppCheckToken()];case 1:null!==(r=s.sent())&&(n["X-Firebase-AppCheck"]=r),s.label=2;case 2:return s.trys.push([2,4,,5]),[4,this.fetchImpl(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 3:return i=s.sent(),[3,5];case 4:return s.sent(),[2,{status:0,json:null}];case 5:o=null,s.label=6;case 6:return s.trys.push([6,8,,9]),[4,i.json()];case 7:return o=s.sent(),[3,9];case 8:return s.sent(),[3,9];case 9:return[2,{status:i.status,json:o}]}}))}))},t.prototype.getAppCheckToken=function(){return Bt(this,void 0,void 0,(function(){var t;return Kt(this,(function(e){switch(e.label){case 0:return(t=this.appCheckProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:return[2,e.sent().token];case 2:return[2,null]}}))}))},t.prototype.call=function(t,e,n){return Bt(this,void 0,void 0,(function(){var r,i,o,s,a,u,c,l,h,f,p;return Kt(this,(function(d){switch(d.label){case 0:return r=this._url(t),e=this.serializer.encode(e),i={data:e},o={},[4,this.contextProvider.getContext()];case 1:return(s=d.sent()).authToken&&(o.Authorization="Bearer "+s.authToken),s.instanceIdToken&&(o["Firebase-Instance-ID-Token"]=s.instanceIdToken),a=n.timeout||7e4,u=function(t){var e,n=new Promise((function(n,r){e=setTimeout((function(){r(new nv("deadline-exceeded","deadline-exceeded"))}),t)}));return{timer:e,promise:n}}(a),c=u.timer,l=u.promise,[4,Promise.race([av(c,this.postJSON(r,i,o)),l,av(c,this.cancelAllRequests)])];case 2:if(!(h=d.sent()))throw new nv("cancelled","Firebase Functions instance was deleted.");if(f=function(t,e,n){var r=function(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),i=r,o=void 0;try{var s=e&&e.error;if(s){var a=s.status;if("string"==typeof a){if(!ev[a])return new nv("internal","internal");r=ev[a],i=a}var u=s.message;"string"==typeof u&&(i=u),void 0!==(o=s.details)&&(o=n.decode(o))}}catch(t){}return"ok"===r?null:new nv(r,i,o)}(h.status,h.json,this.serializer))throw f;if(!h.json)throw new nv("internal","Response is not valid JSON object.");if(void 0===(p=h.json.data)&&(p=h.json.result),void 0===p)throw new nv("internal","Response is missing data field.");return[2,{data:this.serializer.decode(p)}]}}))}))},t}();function av(t,e){return Bt(this,void 0,void 0,(function(){var n;return Kt(this,(function(r){switch(r.label){case 0:return[4,e];case 1:return n=r.sent(),clearTimeout(t),[2,n]}}))}))}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
!function(t,e){var n={Functions:sv};t.INTERNAL.registerComponent(new ae("functions",(function(t,n){var r=n.instanceIdentifier,i=t.getProvider("app").getImmediate(),o=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal"),a=t.getProvider("messaging");return new sv(i,o,a,s,r,e)}),"PUBLIC").setServiceProps(n).setMultipleInstances(!0))}(Pe,fetch.bind(self)),Pe.registerVersion("@firebase/functions","0.6.13");Pe.initializeApp({apiKey:"AIzaSyAq59lK80pPZj_-DmD8swIckq2TYTt8Meo",authDomain:"anime-corner-rankings.firebaseapp.com",projectId:"anime-corner-rankings",storageBucket:"anime-corner-rankings.appspot.com",messagingSenderId:"1056575402361",appId:"1:1056575402361:web:0fd9790f5ef43a94897fa8",measurementId:"G-264NJGB06X"});const uv=Pe.firestore(),cv=Pe.functions();function lv(e){let n,r;return{c(){n=v("div"),r=y(e[0]),E(n,"class","svelte-w1ujin")},m(t,e){p(t,n,e),f(n,r)},p(t,[e]){1&e&&I(r,t[0])},i:t,o:t,d(t){t&&d(n)}}}function hv(t,e,n){let{rank:r}=e;return t.$$set=t=>{"rank"in t&&n(0,r=t.rank)},[r]}class fv extends J{constructor(t){super(),Y(this,t,hv,lv,s,{rank:0})}}function pv(e){let n,r,i;return{c(){n=v("div"),r=v("div"),i=y(e[1]),E(r,"class","title svelte-1fnl7eo"),E(n,"class","banner svelte-1fnl7eo"),T(n,"background-image","linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url("+e[0]+")")},m(t,e){p(t,n,e),f(n,r),f(r,i)},p(t,[e]){2&e&&I(i,t[1]),1&e&&T(n,"background-image","linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url("+t[0]+")")},i:t,o:t,d(t){t&&d(n)}}}function dv(t,e,n){let{banner:r}=e,{title:i}=e;return t.$$set=t=>{"banner"in t&&n(0,r=t.banner),"title"in t&&n(1,i=t.title)},[r,i]}class gv extends J{constructor(t){super(),Y(this,t,dv,pv,s,{banner:0,title:1})}}function vv(t){let e;return{c(){e=y(t[4])},m(t,n){p(t,e,n)},p(t,n){16&n&&I(e,t[4])},d(t){t&&d(e)}}}function yv(t){let e,n=t[4].toString().replace("-","")+"";return{c(){e=y(n)},m(t,n){p(t,e,n)},p(t,r){16&r&&n!==(n=t[4].toString().replace("-","")+"")&&I(e,n)},d(t){t&&d(e)}}}function mv(t){let e,n,r;return{c(){e=v("div"),n=y("FROM RANK "),r=y(t[1]),E(e,"class","label svelte-4h068f"),A(e,"gain",t[4]>0),A(e,"drop",t[4]<0)},m(t,i){p(t,e,i),f(e,n),f(e,r)},p(t,n){2&n&&I(r,t[1]),16&n&&A(e,"gain",t[4]>0),16&n&&A(e,"drop",t[4]<0)},d(t){t&&d(e)}}}function bv(t){let e;return{c(){e=v("div"),e.textContent="SAME RANK",E(e,"class","label svelte-4h068f"),A(e,"neutral",t[1]==t[0])},m(t,n){p(t,e,n)},p(t,n){3&n&&A(e,"neutral",t[1]==t[0])},d(t){t&&d(e)}}}function wv(t){let e;return{c(){e=v("div"),e.textContent="NEW ENTRY",E(e,"class","label svelte-4h068f"),A(e,"neutral",null==t[1])},m(t,n){p(t,e,n)},p(t,n){2&n&&A(e,"neutral",null==t[1])},d(t){t&&d(e)}}}function Ev(t){let e;return{c(){e=v("div"),e.textContent="NEW ENTRY",E(e,"class","label border-br svelte-4h068f"),A(e,"neutral",0==t[5]),A(e,"no-border-br",t[3])},m(t,n){p(t,e,n)},p(t,n){32&n&&A(e,"neutral",0==t[5]),8&n&&A(e,"no-border-br",t[3])},d(t){t&&d(e)}}}function Iv(t){let e,n,r;return{c(){e=v("div"),n=y(t[5]),r=y("% DROP"),E(e,"class","label border-br svelte-4h068f"),A(e,"drop",t[5]<0),A(e,"no-border-br",t[3])},m(t,i){p(t,e,i),f(e,n),f(e,r)},p(t,r){32&r&&I(n,t[5]),32&r&&A(e,"drop",t[5]<0),8&r&&A(e,"no-border-br",t[3])},d(t){t&&d(e)}}}function Tv(t){let e,n,r,i;return{c(){e=v("div"),n=y("+"),r=y(t[5]),i=y("% GAIN"),E(e,"class","label border-br svelte-4h068f"),A(e,"gain",t[5]>0),A(e,"no-border-br",t[3])},m(t,o){p(t,e,o),f(e,n),f(e,r),f(e,i)},p(t,n){32&n&&I(r,t[5]),32&n&&A(e,"gain",t[5]>0),8&n&&A(e,"no-border-br",t[3])},d(t){t&&d(e)}}}function _v(e){let n,r,i,o,s,a,u,c,l,h;function g(t,e){return t[4]<0?yv:vv}let b=g(e),w=b(e);function T(t,e){return null==t[1]?wv:t[1]==t[0]?bv:mv}let _=T(e),S=_(e);function N(t,e){return t[5]>0?Tv:t[5]<0?Iv:Ev}let D=N(e),k=D(e);return{c(){n=v("div"),r=v("div"),i=v("div"),w.c(),o=m(),S.c(),s=m(),a=v("div"),u=v("div"),c=y(e[2]),l=y("%"),h=m(),k.c(),E(i,"class","figure svelte-4h068f"),A(i,"arrow-gain",e[4]>0),A(i,"arrow-neutral",0==e[4]),A(i,"arrow-drop",e[4]<0),E(r,"class","sub-container svelte-4h068f"),E(u,"class","figure border-br svelte-4h068f"),E(a,"class","sub-container border-br svelte-4h068f"),E(n,"class","container border-tr border-br svelte-4h068f")},m(t,e){p(t,n,e),f(n,r),f(r,i),w.m(i,null),f(r,o),S.m(r,null),f(n,s),f(n,a),f(a,u),f(u,c),f(u,l),f(a,h),k.m(a,null)},p(t,[e]){b===(b=g(t))&&w?w.p(t,e):(w.d(1),w=b(t),w&&(w.c(),w.m(i,null))),16&e&&A(i,"arrow-gain",t[4]>0),16&e&&A(i,"arrow-neutral",0==t[4]),16&e&&A(i,"arrow-drop",t[4]<0),_===(_=T(t))&&S?S.p(t,e):(S.d(1),S=_(t),S&&(S.c(),S.m(r,null))),4&e&&I(c,t[2]),D===(D=N(t))&&k?k.p(t,e):(k.d(1),k=D(t),k&&(k.c(),k.m(a,null)))},i:t,o:t,d(t){t&&d(n),w.d(),S.d(),k.d()}}}function Sv(t,e,n){let r,i,{rank:o}=e,{previousRank:s}=e,{votes:a}=e,{previousVotes:u}=e,{isActive:c}=e;return function(t){k().$$.after_update.push(t)}((()=>{n(4,r=function(t,e){return null==e?0:t<e?e-t:e==t?0:e-t}(o,s)),n(5,i=function(t,e){if(null==e)return 0;return(t-e).toFixed(2)}(a,u))})),t.$$set=t=>{"rank"in t&&n(0,o=t.rank),"previousRank"in t&&n(1,s=t.previousRank),"votes"in t&&n(2,a=t.votes),"previousVotes"in t&&n(6,u=t.previousVotes),"isActive"in t&&n(3,c=t.isActive)},[o,s,a,c,r,i,u]}class Av extends J{constructor(t){super(),Y(this,t,Sv,_v,s,{rank:0,previousRank:1,votes:2,previousVotes:6,isActive:3})}}function Nv(t){let e,n=localStorage.getItem(`${t}`);return n&&(n=JSON.parse(n),e=parseInt(Date.now()/1e3)-n.cachetime>86400,console.log(`${t} expired:`,e)),{cachedData:n,expired:e}}function Dv(t,e){const n={data:e,cachetime:parseInt(Date.now()/1e3)};localStorage.setItem(`${t}`,JSON.stringify(n))}function kv(t,e,n){const r=t.slice();return r[10]=e[n],r}function Cv(t,e,n){const r=t.slice();return r[13]=e[n],r}function xv(t){let e,n={ctx:t,current:null,token:null,hasCatch:!1,pending:Vv,then:Ov,catch:Rv,value:9};return function(t,e){const n=e.token={};function r(t,r,i,o){if(e.token!==n)return;e.resolved=o;let s=e.ctx;void 0!==i&&(s=s.slice(),s[i]=o);const a=t&&(e.current=t)(s);let u=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==r&&t&&(K(),$(t,1,1,(()=>{e.blocks[n]===t&&(e.blocks[n]=null)})),z())})):e.block.d(1),a.c(),G(a,1),a.m(e.mount(),e.anchor),u=!0),e.block=a,e.blocks&&(e.blocks[r]=a),u&&U()}if((i=t)&&"object"==typeof i&&"function"==typeof i.then){const n=k();if(t.then((t=>{D(n),r(e.then,1,e.value,t),D(null)}),(t=>{if(D(n),r(e.catch,2,e.error,t),D(null),!e.hasCatch)throw t})),e.current!==e.pending)return r(e.pending,0),!0}else{if(e.current!==e.then)return r(e.then,1,e.value,t),!0;e.resolved=t}var i}(t[8](),n),{c(){e=b(),n.block.c()},m(t,r){p(t,e,r),n.block.m(t,n.anchor=r),n.mount=()=>e.parentNode,n.anchor=e},p(e,r){!function(t,e,n){const r=e.slice(),{resolved:i}=t;t.current===t.then&&(r[t.value]=i),t.current===t.catch&&(r[t.error]=i),t.block.p(r,n)}(n,t=e,r)},d(t){t&&d(e),n.block.d(t),n.token=null,n=null}}}function Rv(e){return{c:t,m:t,p:t,d:t}}function Ov(t){let e,n,r,i,o,s,a,u=t[9].description+"",c=t[9].genres,l=[];for(let e=0;e<c.length;e+=1)l[e]=Lv(Cv(t,c,e));let h=t[9].externalLinks,b=[];for(let e=0;e<h.length;e+=1)b[e]=Mv(kv(t,h,e));return{c(){e=v("div"),n=v("div");for(let t=0;t<l.length;t+=1)l[t].c();r=m(),i=v("div"),o=y("Watch on:\n          ");for(let t=0;t<b.length;t+=1)b[t].c();s=m(),a=new N,E(n,"class","pills svelte-tf1vsp"),E(i,"class","links svelte-tf1vsp"),a.a=null,E(e,"class","card-content svelte-tf1vsp")},m(t,c){p(t,e,c),f(e,n);for(let t=0;t<l.length;t+=1)l[t].m(n,null);f(e,r),f(e,i),f(i,o);for(let t=0;t<b.length;t+=1)b[t].m(i,null);f(e,s),a.m(u,e)},p(t,e){if(256&e){let r;for(c=t[9].genres,r=0;r<c.length;r+=1){const i=Cv(t,c,r);l[r]?l[r].p(i,e):(l[r]=Lv(i),l[r].c(),l[r].m(n,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=c.length}if(256&e){let n;for(h=t[9].externalLinks,n=0;n<h.length;n+=1){const r=kv(t,h,n);b[n]?b[n].p(r,e):(b[n]=Mv(r),b[n].c(),b[n].m(i,null))}for(;n<b.length;n+=1)b[n].d(1);b.length=h.length}},d(t){t&&d(e),g(l,t),g(b,t)}}}function Lv(e){let n,r,i=e[13]+"";return{c(){n=v("div"),r=y(i),E(n,"class","pill svelte-tf1vsp")},m(t,e){p(t,n,e),f(n,r)},p:t,d(t){t&&d(n)}}}function Pv(e){let n,r,i,o;return{c(){n=v("a"),r=v("img"),o=m(),c(r.src,i="logos/Funimation.svg")||E(r,"src","logos/Funimation.svg"),E(r,"alt",""),E(r,"class","site funimation svelte-tf1vsp"),E(n,"href",e[10].url),E(n,"class","fun-pill svelte-tf1vsp")},m(t,e){p(t,n,e),f(n,r),f(n,o)},p:t,d(t){t&&d(n)}}}function Fv(e){let n,r,i,o;return{c(){n=v("a"),r=v("img"),o=m(),c(r.src,i="logos/Crunchyroll.svg")||E(r,"src","logos/Crunchyroll.svg"),E(r,"alt",""),E(r,"class","crunchyroll svelte-tf1vsp"),E(n,"href",e[10].url),E(n,"class","crunchy-pill svelte-tf1vsp")},m(t,e){p(t,n,e),f(n,r),f(n,o)},p:t,d(t){t&&d(n)}}}function Mv(t){let e;let n=function(t,e){return"Crunchyroll"==t[10].site?Fv:"Funimation"==t[10].site?Pv:void 0}(t),r=n&&n(t);return{c(){r&&r.c(),e=b()},m(t,n){r&&r.m(t,n),p(t,e,n)},p(t,e){r&&r.p(t,e)},d(t){r&&r.d(t),t&&d(e)}}}function Vv(e){let n;return{c(){n=v("div"),n.innerHTML="<p>Loading...</p>",E(n,"class","card-content svelte-tf1vsp")},m(t,e){p(t,n,e)},p:t,d(t){t&&d(n)}}}function Uv(t){let e,n,r,i,o,s,a,u,c,l,h;r=new fv({props:{rank:t[1]}}),o=new gv({props:{banner:t[4],title:t[2]}}),a=new Av({props:{rank:t[1],previousRank:t[5],votes:t[3],previousVotes:t[6],isActive:t[0]}});let g=t[0]&&xv(t);return{c(){e=v("div"),n=v("div"),H(r.$$.fragment),i=m(),H(o.$$.fragment),s=m(),H(a.$$.fragment),u=m(),g&&g.c(),E(n,"class","card svelte-tf1vsp"),A(n,"straight-bottom-border",t[0]),E(e,"class","wrapper svelte-tf1vsp")},m(d,v){p(d,e,v),f(e,n),Q(r,n,null),f(n,i),Q(o,n,null),f(n,s),Q(a,n,null),f(e,u),g&&g.m(e,null),c=!0,l||(h=w(e,"click",t[7]),l=!0)},p(t,[i]){const s={};2&i&&(s.rank=t[1]),r.$set(s);const u={};16&i&&(u.banner=t[4]),4&i&&(u.title=t[2]),o.$set(u);const c={};2&i&&(c.rank=t[1]),32&i&&(c.previousRank=t[5]),8&i&&(c.votes=t[3]),64&i&&(c.previousVotes=t[6]),1&i&&(c.isActive=t[0]),a.$set(c),1&i&&A(n,"straight-bottom-border",t[0]),t[0]?g?g.p(t,i):(g=xv(t),g.c(),g.m(e,null)):g&&(g.d(1),g=null)},i(t){c||(G(r.$$.fragment,t),G(o.$$.fragment,t),G(a.$$.fragment,t),c=!0)},o(t){$(r.$$.fragment,t),$(o.$$.fragment,t),$(a.$$.fragment,t),c=!1},d(t){t&&d(e),W(r),W(o),W(a),g&&g.d(),l=!1,h()}}}function jv(t,e,n){let{rank:r}=e,{title:i}=e,{votes:o}=e,{banner:s}=e,{previousRank:a}=e,{previousVotes:u}=e,{isActive:c}=e;return t.$$set=t=>{"rank"in t&&n(1,r=t.rank),"title"in t&&n(2,i=t.title),"votes"in t&&n(3,o=t.votes),"banner"in t&&n(4,s=t.banner),"previousRank"in t&&n(5,a=t.previousRank),"previousVotes"in t&&n(6,u=t.previousVotes),"isActive"in t&&n(0,c=t.isActive)},[c,r,i,o,s,a,u,function(){n(0,c=!c)},async()=>{let t,e=`${i} Details`,n=Nv(e);if(n.cachedData&&!n.expired)return n.cachedData.data;{const n="\n  query ($title: String){\n    Media (search: $title, type: ANIME) {\n      description\n      genres\n      externalLinks {\n        site\n        url\n      }\n    }\n  } \n  ",r={title:i},o={"Content-Type":"application/json",Accept:"application/json"};return await Vt({method:"post",url:"https://graphql.anilist.co/",headers:o,data:JSON.stringify({query:n,variables:r})}).then((e=>t=e.data.data.Media)).catch((async e=>{console.log(e.message),console.log("Trying Kitsu...");t=await(async()=>{const t={},e={title:i};return await Vt({method:"post",url:"https://kitsu.io/api/graphql",headers:{"Content-Type":"application/json",Accept:"application/json"},data:JSON.stringify({query:"\n            query($title: String!) {\n  searchAnimeByTitle(first: 1, title: $title) {\n    nodes {\n      description\n      categories(first: 10) {\n        nodes {\n          slug\n        }\n      }\n      streamingLinks(first: 5) {\n        nodes {\n          streamer {\n            siteName\n          }\n          url\n        }\n      }\n    }\n  }\n}\n  ",variables:e})}).then((e=>{console.log(e),t.description=e.data.data.searchAnimeByTitle.nodes[0].description.en;let n=[],r=e.data.data.searchAnimeByTitle.nodes[0].categories.nodes;for(let t=0;t<r.length;t++)n.push(r[t].slug);t.genres=n;let i=e.data.data.searchAnimeByTitle.nodes[0].streamingLinks.nodes,o=[];for(let t=0;t<i.length;t++)"Crunchyroll"!=i[t].streamer.siteName&&"Funimation"!=i[t].streamer.siteName||o.push({site:i[t].streamer.siteName,url:i[t].url});t.externalLinks=o})).catch((t=>console.log(t.message))),t})()})),function(t){let e=[];for(let n=0;n<t.externalLinks.length;n++)"Crunchyroll"!=t.externalLinks[n].site&&"Funimation"!=t.externalLinks[n].site||e.push({site:t.externalLinks[n].site,url:t.externalLinks[n].url});t.externalLinks=e}(t),Dv(e,t),console.log(`${i} details fetched`,t),t}}]}class qv extends J{constructor(t){super(),Y(this,t,jv,Uv,s,{rank:1,title:2,votes:3,banner:4,previousRank:5,previousVotes:6,isActive:0})}}const Bv=[];function Kv(e,n=t){let r;const i=new Set;function o(t){if(s(e,t)&&(e=t,r)){const t=!Bv.length;for(const t of i)t[1](),Bv.push(t,e);if(t){for(let t=0;t<Bv.length;t+=2)Bv[t][0](Bv[t+1]);Bv.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(s,a=t){const u=[s,a];return i.add(u),1===i.size&&(r=n(o)||t),s(e),()=>{i.delete(u),0===i.size&&(r(),r=null)}}}}const zv=Kv("2021"),Gv=Kv("Summer"),$v=Kv("Week-06"),Hv=Kv(1),Qv=Kv(!1);function Wv(t,e,n){const r=t.slice();return r[22]=e[n],r}function Xv(t,e,n){const r=t.slice();return r[25]=e[n],r}function Yv(t,e,n){const r=t.slice();return r[28]=e[n],r}function Jv(t){let e,n,r,o=t[0],s=[];for(let e=0;e<o.length;e+=1)s[e]=ty(Yv(t,o,e));return{c(){e=v("select");for(let t=0;t<s.length;t+=1)s[t].c();void 0===t[4]&&F((()=>t[11].call(e)))},m(i,o){p(i,e,o);for(let t=0;t<s.length;t+=1)s[t].m(e,null);_(e,t[4]),n||(r=[w(e,"change",t[11]),w(e,"change",t[7])],n=!0)},p(t,n){if(1&n){let r;for(o=t[0],r=0;r<o.length;r+=1){const i=Yv(t,o,r);s[r]?s[r].p(i,n):(s[r]=ty(i),s[r].c(),s[r].m(e,null))}for(;r<s.length;r+=1)s[r].d(1);s.length=o.length}17&n&&_(e,t[4])},d(t){t&&d(e),g(s,t),n=!1,i(r)}}}function Zv(e){let n,r;return{c(){n=v("select"),r=v("option"),r.textContent="Loading...",r.__value="",r.value=r.__value},m(t,e){p(t,n,e),f(n,r)},p:t,d(t){t&&d(n)}}}function ty(t){let e,n,r,i=t[28]+"";return{c(){e=v("option"),n=y(i),e.__value=r=t[28],e.value=e.__value},m(t,r){p(t,e,r),f(e,n)},p(t,o){1&o&&i!==(i=t[28]+"")&&I(n,i),1&o&&r!==(r=t[28])&&(e.__value=r,e.value=e.__value)},d(t){t&&d(e)}}}function ey(t){let e,n,r,o=t[1],s=[];for(let e=0;e<o.length;e+=1)s[e]=ry(Xv(t,o,e));return{c(){e=v("select");for(let t=0;t<s.length;t+=1)s[t].c();void 0===t[3]&&F((()=>t[12].call(e)))},m(i,o){p(i,e,o);for(let t=0;t<s.length;t+=1)s[t].m(e,null);_(e,t[3]),n||(r=[w(e,"change",t[12]),w(e,"change",t[8])],n=!0)},p(t,n){if(2&n){let r;for(o=t[1],r=0;r<o.length;r+=1){const i=Xv(t,o,r);s[r]?s[r].p(i,n):(s[r]=ry(i),s[r].c(),s[r].m(e,null))}for(;r<s.length;r+=1)s[r].d(1);s.length=o.length}10&n&&_(e,t[3])},d(t){t&&d(e),g(s,t),n=!1,i(r)}}}function ny(e){let n,r;return{c(){n=v("select"),r=v("option"),r.textContent="Loading...",r.__value="",r.value=r.__value},m(t,e){p(t,n,e),f(n,r)},p:t,d(t){t&&d(n)}}}function ry(t){let e,n,r,i=t[25].replace("-"," ")+"";return{c(){e=v("option"),n=y(i),e.__value=r=t[25],e.value=e.__value},m(t,r){p(t,e,r),f(e,n)},p(t,o){2&o&&i!==(i=t[25].replace("-"," ")+"")&&I(n,i),2&o&&r!==(r=t[25])&&(e.__value=r,e.value=e.__value)},d(t){t&&d(e)}}}function iy(t){let e,n,r=t[2],i=[];for(let e=0;e<r.length;e+=1)i[e]=sy(Wv(t,r,e));const o=t=>$(i[t],1,1,(()=>{i[t]=null}));return{c(){for(let t=0;t<i.length;t+=1)i[t].c();e=b()},m(t,r){for(let e=0;e<i.length;e+=1)i[e].m(t,r);p(t,e,r),n=!0},p(t,n){if(36&n){let s;for(r=t[2],s=0;s<r.length;s+=1){const o=Wv(t,r,s);i[s]?(i[s].p(o,n),G(i[s],1)):(i[s]=sy(o),i[s].c(),G(i[s],1),i[s].m(e.parentNode,e))}for(K(),s=r.length;s<i.length;s+=1)o(s);z()}},i(t){if(!n){for(let t=0;t<r.length;t+=1)G(i[t]);n=!0}},o(t){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)$(i[t]);n=!1},d(t){g(i,t),t&&d(e)}}}function oy(e){let n;return{c(){n=v("p"),n.textContent="Loading..."},m(t,e){p(t,n,e)},p:t,i:t,o:t,d(t){t&&d(n)}}}function sy(t){let n,r;const i=[t[22],{isActive:t[5]}];let o={};for(let t=0;t<i.length;t+=1)o=e(o,i[t]);return n=new qv({props:o}),{c(){H(n.$$.fragment)},m(t,e){Q(n,t,e),r=!0},p(t,e){const r=36&e?function(t,e){const n={},r={},i={$$scope:1};let o=t.length;for(;o--;){const s=t[o],a=e[o];if(a){for(const t in s)t in a||(r[t]=1);for(const t in a)i[t]||(n[t]=a[t],i[t]=1);t[o]=a}else for(const t in s)i[t]=1}for(const t in r)t in n||(n[t]=void 0);return n}(i,[4&e&&(o=t[22],"object"==typeof o&&null!==o?o:{}),32&e&&{isActive:t[5]}]):{};var o;n.$set(r)},i(t){r||(G(n.$$.fragment,t),r=!0)},o(t){$(n.$$.fragment,t),r=!1},d(t){W(n,t)}}}function ay(t){let e,n,r,o,s,a,u,c,l,h,g,b,T,_,S,A,N,D,k,C;function x(t,e){return 0==t[0]?Zv:Jv}let R=x(t),O=R(t);function L(t,e){return 0==t[1].length?ny:ey}let P=L(t),F=P(t);const M=[oy,iy],V=[];function U(t,e){return 0==t[2].length?0:1}return _=U(t),S=V[_]=M[_](t),{c(){e=v("button"),e.textContent="Previous",n=m(),O.c(),r=m(),F.c(),o=m(),s=v("button"),s.textContent="Next",a=m(),u=v("p"),c=y("The current params are "),l=y(t[4]),h=m(),g=y(t[3]),b=m(),T=v("div"),S.c(),A=m(),N=v("button"),N.textContent="Show more rankings",E(e,"id","prev-btn"),E(e,"class","svelte-1hn3a7v"),E(s,"id","next-btn"),E(s,"class","svelte-1hn3a7v"),E(T,"class","svelte-1hn3a7v"),E(N,"id","showMore"),E(N,"class","svelte-1hn3a7v")},m(i,d){p(i,e,d),p(i,n,d),O.m(i,d),p(i,r,d),F.m(i,d),p(i,o,d),p(i,s,d),p(i,a,d),p(i,u,d),f(u,c),f(u,l),f(u,h),f(u,g),p(i,b,d),p(i,T,d),V[_].m(T,null),p(i,A,d),p(i,N,d),D=!0,k||(C=[w(e,"click",t[9]),w(s,"click",t[10]),w(N,"click",t[6])],k=!0)},p(t,[e]){R===(R=x(t))&&O?O.p(t,e):(O.d(1),O=R(t),O&&(O.c(),O.m(r.parentNode,r))),P===(P=L(t))&&F?F.p(t,e):(F.d(1),F=P(t),F&&(F.c(),F.m(o.parentNode,o))),(!D||16&e)&&I(l,t[4]),(!D||8&e)&&I(g,t[3]);let n=_;_=U(t),_===n?V[_].p(t,e):(K(),$(V[n],1,1,(()=>{V[n]=null})),z(),S=V[_],S?S.p(t,e):(S=V[_]=M[_](t),S.c()),G(S,1),S.m(T,null))},i(t){D||(G(S),D=!0)},o(t){$(S),D=!1},d(t){t&&d(e),t&&d(n),O.d(t),t&&d(r),F.d(t),t&&d(o),t&&d(s),t&&d(a),t&&d(u),t&&d(b),t&&d(T),V[_].d(),t&&d(A),t&&d(N),k=!1,i(C)}}}function uy(t,e,n){let r,i,o,s,a;l(t,$v,(t=>n(3,r=t))),l(t,Gv,(t=>n(4,i=t))),l(t,zv,(t=>n(14,o=t))),l(t,Hv,(t=>n(15,s=t))),l(t,Qv,(t=>n(5,a=t)));let u=[],c=[],f=[],p=uv.collection(o).doc(i).collection(r).orderBy("rank","asc").limit(10);!function(t){k().$$.on_mount.push(t)}((async()=>{n(2,f=await d()),n(0,u=await g()),n(1,c=await v()),document.getElementById("next-btn").disabled=!0}));const d=async()=>{document.getElementById("prev-btn").disabled=!0,document.getElementById("next-btn").disabled=!0;let t=`${i}-${r}-page-${s}`,e=Nv(t);if(e.cachedData&&!e.expired)return document.getElementById("prev-btn").disabled=!1,document.getElementById("next-btn").disabled=!1,e.cachedData.data;{let e=await p.get().then((t=>t.docs.map((t=>t.data()))));return await m(e),await w(e),Dv(t,e),console.log("Data fetched:",e),document.getElementById("prev-btn").disabled=!1,document.getElementById("next-btn").disabled=!1,e}},g=async()=>{let t="Seasons",e=Nv(t);if(e.cachedData&&!e.expired)return e.cachedData.data;{let e=uv.collection(o).orderBy("order","asc");return await e.get().then((t=>{t.forEach((t=>{n(0,u=[...u,t.id])}))})),Dv(t,u),console.log("Seasons fetched:",u),u}},v=async()=>{let t=`${i}-Weeks`,e=Nv(t);if(e.cachedData&&!e.expired)return n(1,c.length=0,c),n(1,c=e.cachedData.data),c;{n(1,c.length=0,c);const e=cv.httpsCallable("fetchSubCollections");return await e({year:o,season:i}).then((t=>{n(1,c=t.data)})),Dv(t,c),console.log("Weeks fetched:",c),c}},y=async()=>{document.getElementById("prev-btn").disabled=!0,document.getElementById("next-btn").disabled=!0;let t=`${i}-${r}-page-${s}`,e=Nv(t);if(e.cachedData&&!e.expired)n(2,f.length=0,f),n(2,f=e.cachedData.data);else{let e=[];n(2,f.length=0,f),p=uv.collection(o).doc(i).collection(r).orderBy("rank","asc").limit(10);let s=await p.get().then((t=>t.docs.map((t=>t.data()))));await m(s),await w(s);for(let t=0;t<s.length;t++)e={rank:s[t].rank,title:s[t].title,votes:s[t].votes,banner:s[t].banner,previousRank:s[t].previousRank,previousVotes:s[t].previousVotes},n(2,f=[...f,e]);Dv(t,s),console.log("Items array updated. New Items:",f)}document.getElementById("next-btn").disabled=!1,document.getElementById("prev-btn").disabled="Week-01"==r,document.getElementById("showMore").disabled=!1},m=async t=>{let e;for(let n=0;n<t.length;n++){let r;e=t[n].title;const i="\n  query ($title: String){\n    Media (search: $title, type: ANIME) {\n      bannerImage\n    }\n  }\n  ",o={title:e},s={"Content-Type":"application/json",Accept:"application/json"};await Vt({method:"post",url:"https://graphql.anilist.co/",headers:s,data:JSON.stringify({query:i,variables:o})}).then((async t=>{r=t.data.data.Media.bannerImage,null===r&&(r=await b(e))})).catch((async t=>{console.log(t.message),r=await b(e)})),t[n].banner=r}},b=async t=>{let e;const n={title:t};return await Vt({method:"post",url:"https://kitsu.io/api/graphql",headers:{"Content-Type":"application/json",Accept:"application/json"},data:JSON.stringify({query:"\n  query ($title: String!){\n    searchAnimeByTitle (first: 1, title: $title) {\n      nodes {\n        bannerImage {\n          original {\n            url\n          }\n        }\n      }\n    }\n  }\n  ",variables:n})}).then((async t=>{e="/cover_images/original/missing.png"==t.data.data.searchAnimeByTitle.nodes[0].bannerImage.original.url?"https://raw.githubusercontent.com/arlandfran/anime-corner-rankings/main/assets/img/404-banner.jpg":t.data.data.searchAnimeByTitle.nodes[0].bannerImage.original.url})).catch((t=>{e="https://raw.githubusercontent.com/arlandfran/anime-corner-rankings/main/assets/img/404-banner.jpg",console.log(t.message)})),e},w=async t=>{let e,n,s=parseInt(r.split("-")[1]);if(s-=1,e=s>10?"Week-"+s.toString():"Week-0"+s.toString(),n=uv.collection(o).doc(i).collection(e),"Week-00"==e)for(let e=0;e<t.length;e++)t[e].previousRank=null,t[e].previousVotes=null;else for(let e=0;e<t.length;e++){let r=await n.where("title","==",t[e].title).get().then((t=>t.docs.map((t=>t.data()))));null==r[0]?(t[e].previousRank=null,t[e].previousVotes=null):(t[e].previousRank=r[0].rank,t[e].previousVotes=r[0].votes)}};return[u,c,f,r,i,a,async()=>{let t;h(Hv,s+=1,s);let e=`${i}-${r}-page-${s}`,a=Nv(e);if(a.cachedData&&!a.expired){let e=a.cachedData.data;for(let r=0;r<e.length;r++)t={rank:e[r].rank,title:e[r].title,votes:e[r].votes,banner:e[r].banner,previousRank:e[r].previousRank,previousVotes:e[r].previousVotes},n(2,f=[...f,t])}else await p.get().then((s=>{let a=s.docs[s.docs.length-1];p=uv.collection(o).doc(i).collection(r).orderBy("rank","asc").startAfter(a).limit(10),p.get().then((async r=>{let i=r.docs.map((t=>t.data()));await m(i),await w(i);for(let e=0;e<i.length;e++)t={rank:i[e].rank,title:i[e].title,votes:i[e].votes,banner:i[e].banner,previousRank:i[e].previousRank,previousVotes:i[e].previousVotes},n(2,f=[...f,t]);Dv(e,i),r.size<10?(document.getElementById("showMore").disabled=!0,console.log("No more data to be fetched")):console.log("Next batch of data fetched")}))}))},async()=>{h($v,r="Week-01",r),document.getElementById("prev-btn").disabled=!0,document.getElementById("next-btn").disabled=!1,await y(),await v()},y,function(){let t=c.indexOf(r);(document.getElementById("next-btn").disabled=!0)&&(document.getElementById("next-btn").disabled=!1),1==t?(h($v,r=c[t-1],r),y(),document.getElementById("prev-btn").disabled=!0):(h($v,r=c[t-1],r),y()),console.log("Previous clicked")},function(){let t=c.indexOf(r);(document.getElementById("prev-btn").disabled=!0)&&(document.getElementById("prev-btn").disabled=!1),t+1==c.length-1?(h($v,r=c[t+1],r),y(),document.getElementById("next-btn").disabled=!0):(h($v,r=c[t+1],r),y()),console.log("Next clicked")},function(){i=S(this),Gv.set(i),n(0,u)},function(){r=S(this),$v.set(r),n(1,c)}]}class cy extends J{constructor(t){super(),Y(this,t,uy,ay,s,{})}}function ly(e){let n,r,i,o,s;return o=new cy({}),{c(){n=v("main"),r=v("h1"),r.textContent="Anime Corner Rankings",i=m(),H(o.$$.fragment),E(r,"class","svelte-ihkqe0"),E(n,"class","svelte-ihkqe0")},m(t,e){p(t,n,e),f(n,r),f(n,i),Q(o,n,null),s=!0},p:t,i(t){s||(G(o.$$.fragment,t),s=!0)},o(t){$(o.$$.fragment,t),s=!1},d(t){t&&d(n),W(o)}}}return new class extends J{constructor(t){super(),Y(this,t,null,ly,s,{})}}({target:document.body,props:{name:"world"}})}();
//# sourceMappingURL=bundle.js.map
