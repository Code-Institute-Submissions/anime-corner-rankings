var app=function(){"use strict";function t(){}function e(t,e){for(const n in e)t[n]=e[n];return t}function n(t){return t()}function r(){return Object.create(null)}function i(t){t.forEach(n)}function o(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function a(e,n,r){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}function u(t,e,n){return t.set(n),e}function c(t,e){t.appendChild(e)}function h(t,e,n){t.insertBefore(e,n||null)}function l(t){t.parentNode.removeChild(t)}function f(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function p(t){return document.createElement(t)}function d(t){return document.createTextNode(t)}function y(){return d(" ")}function g(){return d("")}function v(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function m(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function b(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function w(t,e){for(let n=0;n<t.options.length;n+=1){const r=t.options[n];if(r.__value===e)return void(r.selected=!0)}}function E(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}let I;function T(t){I=t}function _(){if(!I)throw new Error("Function called outside component initialization");return I}const S=[],A=[],N=[],D=[],C=Promise.resolve();let k=!1;function x(t){N.push(t)}let O=!1;const R=new Set;function L(){if(!O){O=!0;do{for(let t=0;t<S.length;t+=1){const e=S[t];T(e),P(e.$$)}for(T(null),S.length=0;A.length;)A.pop()();for(let t=0;t<N.length;t+=1){const e=N[t];R.has(e)||(R.add(e),e())}N.length=0}while(S.length);for(;D.length;)D.pop()();k=!1,O=!1,R.clear()}}function P(t){if(null!==t.fragment){t.update(),i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(x)}}const F=new Set;let M;function V(){M={r:0,c:[],p:M}}function U(){M.r||i(M.c),M=M.p}function j(t,e){t&&t.i&&(F.delete(t),t.i(e))}function q(t,e,n,r){if(t&&t.o){if(F.has(t))return;F.add(t),M.c.push((()=>{F.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}function B(t){t&&t.c()}function K(t,e,r,s){const{fragment:a,on_mount:u,on_destroy:c,after_update:h}=t.$$;a&&a.m(e,r),s||x((()=>{const e=u.map(n).filter(o);c?c.push(...e):i(e),t.$$.on_mount=[]})),h.forEach(x)}function z(t,e){const n=t.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function G(t,e){-1===t.$$.dirty[0]&&(S.push(t),k||(k=!0,C.then(L)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function H(e,n,o,s,a,u,c,h=[-1]){const f=I;T(e);const p=e.$$={fragment:null,ctx:null,props:u,update:t,not_equal:a,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:n.context||[]),callbacks:r(),dirty:h,skip_bound:!1,root:n.target||f.$$.root};c&&c(p.root);let d=!1;if(p.ctx=o?o(e,n.props||{},((t,n,...r)=>{const i=r.length?r[0]:n;return p.ctx&&a(p.ctx[t],p.ctx[t]=i)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](i),d&&G(e,t)),n})):[],p.update(),d=!0,i(p.before_update),p.fragment=!!s&&s(p.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);p.fragment&&p.fragment.l(t),t.forEach(l)}else p.fragment&&p.fragment.c();n.intro&&j(e.$$.fragment),K(e,n.target,n.anchor,n.customElement),L()}T(f)}class Q{$destroy(){z(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var W=function(t,e){return(W=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function $(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}W(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var X=function(){return(X=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function Y(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function J(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function Z(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function tt(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function et(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||e)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var nt={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=o>>2,l=(3&o)<<4|a>>4,f=(15&a)<<2|c>>6,p=63&c;u||(p=64,s||(f=64)),r.push(n[h],n[l],n[f],n[p])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e}(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var s=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{o=t[n++];var a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();var c=o<<2|s>>4;if(r.push(c),64!==a){var h=s<<4&240|a>>2;if(r.push(h),64!==u){var l=a<<6&192|u;r.push(l)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};function rt(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=rt(t[n],e[n]));return t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var it=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function ot(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function st(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(t){return!1}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var at=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,ut.prototype.create),o}return $(e,t),e}(Error),ut=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?ct(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",u=new at(i,a,r);return u},t}();function ct(t,e){return t.replace(ht,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var ht=/\{\$([^}]+)}/g;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function lt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function ft(t,e){var n=new pt(t,e);return n.subscribe.bind(n)}var pt=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=dt),void 0===r.error&&(r.error=dt),void 0===r.complete&&(r.complete=dt);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function dt(){}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function yt(t){return t&&t._delegate?t._delegate:t}var gt=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),vt="[DEFAULT]",mt=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.onInitCallbacks=new Map}return t.prototype.get=function(t){var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new it;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e,n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),r=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(r)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t))try{this.getOrInitializeService({instanceIdentifier:vt})}catch(t){}try{for(var r=Z(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=tt(i.value,2),s=o[0],a=o[1],u=this.normalizeInstanceIdentifier(s);try{var c=this.getOrInitializeService({instanceIdentifier:u});a.resolve(c)}catch(t){}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t=vt),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return Y(this,void 0,void 0,(function(){var t;return J(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(et(et([],tt(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),tt(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=vt),this.instances.has(t)},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var r=t.options,i=void 0===r?{}:r,o=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(o))throw Error(this.name+"("+o+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var s=this.getOrInitializeService({instanceIdentifier:o,options:i});try{for(var a=Z(this.instancesDeferred.entries()),u=a.next();!u.done;u=a.next()){var c=tt(u.value,2),h=c[0],l=c[1];o===this.normalizeInstanceIdentifier(h)&&l.resolve(s)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return s},t.prototype.onInit=function(t,e){var n,r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);var o=this.instances.get(r);return o&&t(o,r),function(){i.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,r,i=this.onInitCallbacks.get(e);if(i)try{for(var o=Z(i),s=o.next();!s.done;s=o.next()){var a=s.value;try{a(t,e)}catch(t){}}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,r=t.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,e===vt?void 0:e),options:i}),this.instances.set(n,o),this.invokeOnInitCallbacks(o,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(t){}return o||null},t.prototype.normalizeInstanceIdentifier=function(t){return void 0===t&&(t=vt),this.component?this.component.multipleInstances?t:vt:t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var bt,wt=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new mt(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function Et(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var It,Tt=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(It||(It={}));var _t,St={debug:It.DEBUG,verbose:It.VERBOSE,info:It.INFO,warn:It.WARN,error:It.ERROR,silent:It.SILENT},At=It.INFO,Nt=((bt={})[It.DEBUG]="log",bt[It.VERBOSE]="log",bt[It.INFO]="info",bt[It.WARN]="warn",bt[It.ERROR]="error",bt),Dt=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=Nt[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,Et(["["+i+"]  "+t.name+":"],n))}},Ct=function(){function t(t){this.name=t,this._logLevel=At,this._logHandler=Dt,this._userLogHandler=null,Tt.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in It))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?St[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Et([this,It.DEBUG],t)),this._logHandler.apply(this,Et([this,It.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Et([this,It.VERBOSE],t)),this._logHandler.apply(this,Et([this,It.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Et([this,It.INFO],t)),this._logHandler.apply(this,Et([this,It.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Et([this,It.WARN],t)),this._logHandler.apply(this,Et([this,It.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Et([this,It.ERROR],t)),this._logHandler.apply(this,Et([this,It.ERROR],t))},t}();function kt(t){Tt.forEach((function(e){e.setLogLevel(t)}))}var xt,Ot=((_t={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",_t["bad-app-name"]="Illegal App name: '{$appName}",_t["duplicate-app"]="Firebase App named '{$appName}' already exists",_t["app-deleted"]="Firebase App named '{$appName}' already deleted",_t["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",_t["invalid-log-argument"]="First argument to `onLog` must be null or a function.",_t),Rt=new ut("app","Firebase",Ot),Lt="@firebase/app",Pt="[DEFAULT]",Ft=((xt={})[Lt]="fire-core",xt["@firebase/analytics"]="fire-analytics",xt["@firebase/app-check"]="fire-app-check",xt["@firebase/auth"]="fire-auth",xt["@firebase/database"]="fire-rtdb",xt["@firebase/functions"]="fire-fn",xt["@firebase/installations"]="fire-iid",xt["@firebase/messaging"]="fire-fcm",xt["@firebase/performance"]="fire-perf",xt["@firebase/remote-config"]="fire-rc",xt["@firebase/storage"]="fire-gcs",xt["@firebase/firestore"]="fire-fst",xt["fire-js"]="fire-js",xt["firebase-wrapper"]="fire-js-all",xt),Mt=new Ct("@firebase/app"),Vt=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=rt(void 0,t),this.container=new wt(e.name),this._addComponent(new gt("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(t){return r._addComponent(t)}))}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){var n;void 0===e&&(e=Pt),this.checkDestroyed_();var r=this.container.getProvider(t);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=Pt),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){Mt.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw Rt.create("app-deleted",{appName:this.name_})},t}();Vt.prototype.name&&Vt.prototype.options||Vt.prototype.delete||console.log("dc");
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Ut(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={});if("object"!=typeof i||null===i){i={name:i}}var o=i;void 0===o.name&&(o.name=Pt);var s=o.name;if("string"!=typeof s||!s)throw Rt.create("bad-app-name",{appName:String(s)});if(lt(e,s))throw Rt.create("duplicate-app",{appName:s});var a=new t(n,o,r);return e[s]=a,a},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=Ft[t])&&void 0!==r?r:t;n&&(i+="-"+n);var s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return s&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),s&&a&&u.push("and"),a&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void Mt.warn(u.join(" "))}o(new gt(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:kt,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw Rt.create("invalid-log-argument");!function(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=St[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:It[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=Tt;r<i.length;r++)n(i[r])}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t,e)},apps:null,SDK_VERSION:"8.7.0",INTERNAL:{registerComponent:o,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){if("serverAuth"===e)return null;return e}}};function i(t){if(!lt(e,t=t||Pt))throw Rt.create("no-app",{appName:t});return e[t]}function o(o){var s=o.name;if(n.has(s))return Mt.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===o.type?r[s]:null;if(n.set(s,o),"PUBLIC"===o.type){var a=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[s])throw Rt.create("invalid-app-argument",{appName:s});return t[s]()};void 0!==o.serviceProps&&rt(a,o.serviceProps),r[s]=a,t.prototype[s]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,s);return n.apply(this,o.multipleInstances?t:[])}}for(var u=0,c=Object.keys(e);u<c.length;u++){var h=c[u];e[h]._addComponent(o)}return"PUBLIC"===o.type?r[s]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var jt=function t(){var e=Ut(Vt);return e.INTERNAL=X(X({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){rt(e,t)},createSubscribe:ft,ErrorFactory:ut,deepExtend:rt}),e}(),qt=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
if("object"==typeof self&&self.self===self&&void 0!==self.firebase){Mt.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var Bt=self.firebase.SDK_VERSION;Bt&&Bt.indexOf("LITE")>=0&&Mt.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var Kt=jt.initializeApp;jt.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return st()&&Mt.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),Kt.apply(void 0,t)};var zt=jt;!function(t,e){t.INTERNAL.registerComponent(new gt("platform-logger",(function(t){return new qt(t)}),"PRIVATE")),t.registerVersion(Lt,"0.6.28",e),t.registerVersion("fire-js","")}(zt);var Gt="8.8.0";
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
zt.registerVersion("firebase",Gt,"app"),zt.SDK_VERSION=Gt;
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var Ht=function(t,e){return(Ht=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function Qt(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var Wt,$t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Xt=Xt||{},Yt=$t||self;function Jt(){}function Zt(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function te(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var ee="closure_uid_"+(1e9*Math.random()>>>0),ne=0;function re(t,e,n){return t.call.apply(t.bind,arguments)}function ie(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function oe(t,e,n){return(oe=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?re:ie).apply(null,arguments)}function se(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function ae(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function ue(){this.s=this.s,this.o=this.o}var ce={};ue.prototype.s=!1,ue.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,ee)&&t[ee]||(t[ee]=++ne)}(this);delete ce[t]}},ue.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var he=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},le=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function fe(t){return Array.prototype.concat.apply([],arguments)}function pe(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function de(t){return/^[\s\xa0]*$/.test(t)}var ye,ge=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function ve(t,e){return-1!=t.indexOf(e)}function me(t,e){return t<e?-1:t>e?1:0}t:{var be=Yt.navigator;if(be){var we=be.userAgent;if(we){ye=we;break t}}ye=""}function Ee(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Ie(t){var e={};for(var n in t)e[n]=t[n];return e}var Te="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function _e(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<Te.length;o++)n=Te[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Se(t){return Se[" "](t),t}Se[" "]=Jt;var Ae,Ne,De=ve(ye,"Opera"),Ce=ve(ye,"Trident")||ve(ye,"MSIE"),ke=ve(ye,"Edge"),xe=ke||Ce,Oe=ve(ye,"Gecko")&&!(ve(ye.toLowerCase(),"webkit")&&!ve(ye,"Edge"))&&!(ve(ye,"Trident")||ve(ye,"MSIE"))&&!ve(ye,"Edge"),Re=ve(ye.toLowerCase(),"webkit")&&!ve(ye,"Edge");function Le(){var t=Yt.document;return t?t.documentMode:void 0}t:{var Pe="",Fe=(Ne=ye,Oe?/rv:([^\);]+)(\)|;)/.exec(Ne):ke?/Edge\/([\d\.]+)/.exec(Ne):Ce?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Ne):Re?/WebKit\/(\S+)/.exec(Ne):De?/(?:Version)[ \/]?(\S+)/.exec(Ne):void 0);if(Fe&&(Pe=Fe?Fe[1]:""),Ce){var Me=Le();if(null!=Me&&Me>parseFloat(Pe)){Ae=String(Me);break t}}Ae=Pe}var Ve,Ue={};function je(){return function(t){var e=Ue;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}((function(){for(var t=0,e=ge(String(Ae)).split("."),n=ge("9").split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=me(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||me(0==o[2].length,0==s[2].length)||me(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t}))}if(Yt.document&&Ce){var qe=Le();Ve=qe||(parseInt(Ae,10)||void 0)}else Ve=void 0;var Be=Ve,Ke=function(){if(!Yt.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{Yt.addEventListener("test",Jt,e),Yt.removeEventListener("test",Jt,e)}catch(t){}return t}();function ze(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function Ge(t,e){if(ze.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(Oe){t:{try{Se(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:He[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Ge.Z.h.call(this)}}ze.prototype.h=function(){this.defaultPrevented=!0},ae(Ge,ze);var He={2:"touch",3:"pen",4:"mouse"};Ge.prototype.h=function(){Ge.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Qe="closure_listenable_"+(1e6*Math.random()|0),We=0;function $e(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=i,this.key=++We,this.ca=this.fa=!1}function Xe(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function Ye(t){this.src=t,this.g={},this.h=0}function Je(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],o=he(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Xe(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function Ze(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ca&&o.listener==e&&o.capture==!!n&&o.ia==r)return i}return-1}Ye.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.g[o])||(t=this.g[o]=[],this.h++);var s=Ze(t,e,r,i);return-1<s?(e=t[s],n||(e.fa=!1)):((e=new $e(e,this.src,o,!!r,i)).fa=n,t.push(e)),e};var tn="closure_lm_"+(1e6*Math.random()|0),en={};function nn(t,e,n,r,i){if(r&&r.once)return on(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)nn(t,e[o],n,r,i);return null}return n=fn(n),t&&t[Qe]?t.N(e,n,te(r)?!!r.capture:!!r,i):rn(t,e,n,!1,r,i)}function rn(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=te(i)?!!i.capture:!!i,a=hn(t);if(a||(t[tn]=a=new Ye(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){function t(n){return e.call(t.src,t.listener,n)}var e=cn;return t}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Ke||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(un(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function on(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)on(t,e[o],n,r,i);return null}return n=fn(n),t&&t[Qe]?t.O(e,n,te(r)?!!r.capture:!!r,i):rn(t,e,n,!0,r,i)}function sn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)sn(t,e[o],n,r,i);else r=te(r)?!!r.capture:!!r,n=fn(n),t&&t[Qe]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(n=Ze(o=t.g[e],n,r,i))&&(Xe(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.g[e],t.h--)))):t&&(t=hn(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Ze(e,n,r,i)),(n=-1<t?e[t]:null)&&an(n))}function an(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[Qe])Je(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(un(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=hn(e))?(Je(n,t),0==n.h&&(n.src=null,e[tn]=null)):Xe(t)}}}function un(t){return t in en?en[t]:en[t]="on"+t}function cn(t,e){if(t.ca)t=!0;else{e=new Ge(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&an(t),t=n.call(r,e)}return t}function hn(t){return(t=t[tn])instanceof Ye?t:null}var ln="__closure_events_fn_"+(1e9*Math.random()>>>0);function fn(t){return"function"==typeof t?t:(t[ln]||(t[ln]=function(e){return t.handleEvent(e)}),t[ln])}function pn(){ue.call(this),this.i=new Ye(this),this.P=this,this.I=null}function dn(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,"string"==typeof e)e=new ze(e,t);else if(e instanceof ze)e.target=e.target||t;else{var i=e;_e(e=new ze(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.g=n[o];i=yn(s,r,!0,e)&&i}if(i=yn(s=e.g=t,r,!0,e)&&i,i=yn(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=yn(s=e.g=n[o],r,!1,e)&&i}function yn(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.ca&&s.capture==n){var a=s.listener,u=s.ia||s.src;s.fa&&Je(t.i,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}ae(pn,ue),pn.prototype[Qe]=!0,pn.prototype.removeEventListener=function(t,e,n,r){sn(this,t,e,n,r)},pn.prototype.M=function(){if(pn.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)Xe(n[r]);delete e.g[t],e.h--}}this.I=null},pn.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},pn.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var gn=Yt.JSON.stringify;function vn(){var t=Sn,e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var mn,bn=function(){function t(){this.h=this.g=null}return t.prototype.add=function(t,e){var n=wn.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n},t}(),wn=new(function(){function t(t,e){this.i=t,this.j=e,this.h=0,this.g=null}return t.prototype.get=function(){var t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t},t}())((function(){return new En}),(function(t){return t.reset()})),En=function(){function t(){this.next=this.g=this.h=null}return t.prototype.set=function(t,e){this.h=t,this.g=e,this.next=null},t.prototype.reset=function(){this.next=this.g=this.h=null},t}();function In(t){Yt.setTimeout((function(){throw t}),0)}function Tn(t,e){mn||function(){var t=Yt.Promise.resolve(void 0);mn=function(){t.then(An)}}(),_n||(mn(),_n=!0),Sn.add(t,e)}var _n=!1,Sn=new bn;function An(){for(var t;t=vn();){try{t.h.call(t.g)}catch(t){In(t)}var e=wn;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}_n=!1}function Nn(t,e){pn.call(this),this.h=t||1,this.g=e||Yt,this.j=oe(this.kb,this),this.l=Date.now()}function Dn(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function Cn(t,e,n){if("function"==typeof t)n&&(t=oe(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=oe(t.handleEvent,t)}return 2147483647<Number(e)?-1:Yt.setTimeout(t,e||0)}function kn(t){t.g=Cn((function(){t.g=null,t.i&&(t.i=!1,kn(t))}),t.j);var e=t.h;t.h=null,t.m.apply(null,e)}ae(Nn,pn),(Wt=Nn.prototype).da=!1,Wt.S=null,Wt.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),dn(this,"tick"),this.da&&(Dn(this),this.start()))}},Wt.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Wt.M=function(){Nn.Z.M.call(this),Dn(this),delete this.g};var xn=function(t){function e(e,n){var r=t.call(this)||this;return r.m=e,r.j=n,r.h=null,r.i=!1,r.g=null,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Ht(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.l=function(t){this.h=arguments,this.g?this.i=!0:kn(this)},e.prototype.M=function(){t.prototype.M.call(this),this.g&&(Yt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},e}(ue);function On(t){ue.call(this),this.h=t,this.g={}}ae(On,ue);var Rn=[];function Ln(t,e,n,r){Array.isArray(n)||(n&&(Rn[0]=n.toString()),n=Rn);for(var i=0;i<n.length;i++){var o=nn(e,n[i],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}}function Pn(t){Ee(t.g,(function(t,e){this.g.hasOwnProperty(e)&&an(t)}),t),t.g={}}function Fn(){this.g=!0}function Mn(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return gn(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}On.prototype.M=function(){On.Z.M.call(this),Pn(this)},On.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Fn.prototype.Aa=function(){this.g=!1},Fn.prototype.info=function(){};var Vn={},Un=null;function jn(){return Un=Un||new pn}function qn(t){ze.call(this,Vn.Ma,t)}function Bn(t){var e=jn();dn(e,new qn(e,t))}function Kn(t,e){ze.call(this,Vn.STAT_EVENT,t),this.stat=e}function zn(t){var e=jn();dn(e,new Kn(e,t))}function Gn(t,e){ze.call(this,Vn.Na,t),this.size=e}function Hn(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Yt.setTimeout((function(){t()}),e)}Vn.Ma="serverreachability",ae(qn,ze),Vn.STAT_EVENT="statevent",ae(Kn,ze),Vn.Na="timingevent",ae(Gn,ze);var Qn={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Wn={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function $n(){}function Xn(t){return t.h||(t.h=t.i())}function Yn(){}$n.prototype.h=null;var Jn,Zn={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function tr(){ze.call(this,"d")}function er(){ze.call(this,"c")}function nr(){}function rr(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new On(this),this.P=or,t=xe?125:void 0,this.W=new Nn(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new ir}function ir(){this.i=null,this.g="",this.h=!1}ae(tr,ze),ae(er,ze),ae(nr,$n),nr.prototype.g=function(){return new XMLHttpRequest},nr.prototype.i=function(){return{}},Jn=new nr;var or=45e3,sr={},ar={};function ur(t,e,n){t.K=1,t.v=xr(Sr(e)),t.s=n,t.U=!0,cr(t,null)}function cr(t,e){t.F=Date.now(),pr(t),t.A=Sr(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),zr(n.h,"t",r),t.C=0,n=t.l.H,t.h=new ir,t.g=Gi(t.l,n?e:null,!t.s),0<t.O&&(t.L=new xn(oe(t.Ia,t,t.g),t.O)),Ln(t.V,t.g,"readystatechange",t.gb),e=t.H?Ie(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),Bn(1),function(t,e,n,r,i,o){t.info((function(){if(t.g)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");s=2<=l.length&&"type"==l[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}(t.j,t.u,t.A,t.m,t.X,t.s)}function hr(t){return!!t.g&&("GET"==t.u&&2!=t.K&&t.l.Ba)}function lr(t,e,n){for(var r,i=!0;!t.I&&t.C<n.length;){if((r=fr(t,n))==ar){4==e&&(t.o=4,zn(14),i=!1),Mn(t.j,t.m,null,"[Incomplete Response]");break}if(r==sr){t.o=4,zn(15),Mn(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}Mn(t.j,t.m,r,null),mr(t,r)}hr(t)&&r!=ar&&r!=sr&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,zn(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Mi(e),e.L=!0,zn(11))):(Mn(t.j,t.m,n,"[Invalid Chunked Response]"),vr(t),gr(t))}function fr(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?ar:(n=Number(e.substring(n,r)),isNaN(n)?sr:(r+=1)+n>e.length?ar:(e=e.substr(r,n),t.C=r+n,e))}function pr(t){t.Y=Date.now()+t.P,dr(t,t.P)}function dr(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Hn(oe(t.eb,t),e)}function yr(t){t.B&&(Yt.clearTimeout(t.B),t.B=null)}function gr(t){0==t.l.G||t.I||ji(t.l,t)}function vr(t){yr(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,Dn(t.W),Pn(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function mr(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||Yr(n.i,t)))if(n.I=t.N,!t.J&&Yr(n.i,t)&&3==n.G){try{var r=n.Ca.g.parse(e)}catch(o){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;Ui(n),Di(n)}Fi(n),zn(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=Hn(oe(n.ab,n),6e3));if(1>=Xr(n.i)&&n.ka){try{n.ka()}catch(o){}n.ka=void 0}}else Bi(n,11)}else if((t.J||n.g==t)&&Ui(n),!de(e))for(i=n.Ca.g.parse(e),e=0;e<i.length;e++){var o=i[e];if(n.U=o[0],o=o[1],2==n.G)if("c"==o[0]){n.J=o[1],n.la=o[2];var s=o[3];null!=s&&(n.ma=s,n.h.info("VER="+n.ma));var a=o[4];null!=a&&(n.za=a,n.h.info("SVER="+n.za));var u=o[5];null!=u&&"number"==typeof u&&0<u&&(r=1.5*u,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=t.g;if(c){var h=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=r.i;!l.g&&(ve(h,"spdy")||ve(h,"quic")||ve(h,"h2"))&&(l.j=l.l,l.g=new Set,l.h&&(Jr(l,l.h),l.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,kr(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var p=t;if((r=n).oa=zi(r,r.H?r.la:null,r.W),p.J){Zr(r.i,p);var d=p,y=r.K;y&&d.setTimeout(y),d.B&&(yr(d),pr(d)),r.g=p}else Pi(r);0<n.l.length&&xi(n)}else"stop"!=o[0]&&"close"!=o[0]||Bi(n,7);else 3==n.G&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?Bi(n,7):Ni(n):"noop"!=o[0]&&n.j&&n.j.wa(o),n.A=0)}Bn(4)}catch(o){}}function br(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(Zt(t)||"string"==typeof t)le(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(Zt(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(Zt(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function wr(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof wr)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Er(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];Ir(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var i={};for(n=e=0;e<t.g.length;)Ir(i,r=t.g[e])||(t.g[n++]=r,i[r]=1),e++;t.g.length=n}}function Ir(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(Wt=rr.prototype).setTimeout=function(t){this.P=t},Wt.gb=function(t){t=t.target;var e=this.L;e&&3==Ii(t)?e.l():this.Ia(t)},Wt.Ia=function(t){try{if(t==this.g)t:{var e=Ii(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>e)&&(3!=e||xe||this.g&&(this.h.h||this.g.ga()||Ti(this.g)))){this.I||4!=e||7==n||Bn(8==n||0>=r?3:2),yr(this);var i=this.g.ba();this.N=i;e:if(hr(this)){var o=Ti(this.g);t="";var s=o.length,a=4==Ii(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){vr(this),gr(this);var u="";break e}this.h.i=new Yt.TextDecoder}for(n=0;n<s;n++)this.h.h=!0,t+=this.h.i.decode(o[n],{stream:a&&n==s-1});o.splice(0,s),this.h.g+=t,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}(this.j,this.u,this.A,this.m,this.X,e,i),this.i){if(this.$&&!this.J){e:{if(this.g){var c,h=this.g;if((c=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!de(c)){var l=c;break e}}l=null}if(!(i=l)){this.i=!1,this.o=3,zn(12),vr(this),gr(this);break t}Mn(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,mr(this,i)}this.U?(lr(this,e,u),xe&&this.i&&3==e&&(Ln(this.V,this.W,"tick",this.fb),this.W.start())):(Mn(this.j,this.m,u,null),mr(this,u)),4==e&&vr(this),this.i&&!this.I&&(4==e?ji(this.l,this):(this.i=!1,pr(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,zn(12)):(this.o=0,zn(13)),vr(this),gr(this)}}}catch(e){}},Wt.fb=function(){if(this.g){var t=Ii(this.g),e=this.g.ga();this.C<e.length&&(yr(this),lr(this,t,e),this.i&&4!=t&&pr(this))}},Wt.cancel=function(){this.I=!0,vr(this)},Wt.eb=function(){this.B=null;var t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(Bn(3),zn(17)),vr(this),this.o=2,gr(this)):dr(this,this.Y-t)},(Wt=wr.prototype).R=function(){Er(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},Wt.T=function(){return Er(this),this.g.concat()},Wt.get=function(t,e){return Ir(this.h,t)?this.h[t]:e},Wt.set=function(t,e){Ir(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},Wt.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Tr=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function _r(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof _r){this.g=void 0!==e?e:t.g,Ar(this,t.j),this.s=t.s,Nr(this,t.i),Dr(this,t.m),this.l=t.l,e=t.h;var n=new jr;n.i=e.i,e.g&&(n.g=new wr(e.g),n.h=e.h),Cr(this,n),this.o=t.o}else t&&(n=String(t).match(Tr))?(this.g=!!e,Ar(this,n[1]||"",!0),this.s=Or(n[2]||""),Nr(this,n[3]||"",!0),Dr(this,n[4]),this.l=Or(n[5]||"",!0),Cr(this,n[6]||"",!0),this.o=Or(n[7]||"")):(this.g=!!e,this.h=new jr(null,this.g))}function Sr(t){return new _r(t)}function Ar(t,e,n){t.j=n?Or(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Nr(t,e,n){t.i=n?Or(e,!0):e}function Dr(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Cr(t,e,n){e instanceof jr?(t.h=e,function(t,e){e&&!t.j&&(qr(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Br(this,e),zr(this,n,t))}),t)),t.j=e}(t.h,t.g)):(n||(e=Rr(e,Vr)),t.h=new jr(e,t.g))}function kr(t,e,n){t.h.set(e,n)}function xr(t){return kr(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Or(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Rr(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Lr),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Lr(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}_r.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Rr(e,Pr,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(Rr(e,Pr,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(Rr(n,"/"==n.charAt(0)?Mr:Fr,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Rr(n,Ur)),t.join("")};var Pr=/[#\/\?@]/g,Fr=/[#\?:]/g,Mr=/[#\?]/g,Vr=/[#\?@]/g,Ur=/#/g;function jr(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function qr(t){t.g||(t.g=new wr,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Br(t,e){qr(t),e=Gr(t,e),Ir(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,Ir((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&Er(t)))}function Kr(t,e){return qr(t),e=Gr(t,e),Ir(t.g.h,e)}function zr(t,e,n){Br(t,e),0<n.length&&(t.i=null,t.g.set(Gr(t,e),pe(n)),t.h+=n.length)}function Gr(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(Wt=jr.prototype).add=function(t,e){qr(this),this.i=null,t=Gr(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},Wt.forEach=function(t,e){qr(this),this.g.forEach((function(n,r){le(n,(function(n){t.call(e,n,r,this)}),this)}),this)},Wt.T=function(){qr(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},Wt.R=function(t){qr(this);var e=[];if("string"==typeof t)Kr(this,t)&&(e=fe(e,this.g.get(Gr(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=fe(e,t[n])}return e},Wt.set=function(t,e){return qr(this),this.i=null,Kr(this,t=Gr(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},Wt.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},Wt.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.R(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.i=t.join("&")};var Hr=function(t,e){this.h=t,this.g=e};function Qr(t){this.l=t||Wr,Yt.PerformanceNavigationTiming?t=0<(t=Yt.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(Yt.g&&Yt.g.Ea&&Yt.g.Ea()&&Yt.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Wr=10;function $r(t){return!!t.h||!!t.g&&t.g.size>=t.j}function Xr(t){return t.h?1:t.g?t.g.size:0}function Yr(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function Jr(t,e){t.g?t.g.add(e):t.h=e}function Zr(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function ti(t){var e,n;if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){var r=t.i;try{for(var i=Qt(t.g.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.D)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return pe(t.i)}function ei(){}function ni(){this.g=new ei}function ri(t,e,n){var r=n||"";try{br(t,(function(t,n){var i=t;te(t)&&(i=gn(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function ii(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}function oi(t){this.l=t.$b||null,this.j=t.ib||!1}function si(t,e){pn.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=ai,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Qr.prototype.cancel=function(){var t,e;if(this.i=ti(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=Qt(this.g.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.g.clear()}},ei.prototype.stringify=function(t){return Yt.JSON.stringify(t,void 0)},ei.prototype.parse=function(t){return Yt.JSON.parse(t,void 0)},ae(oi,$n),oi.prototype.g=function(){return new si(this.l,this.j)},oi.prototype.i=function(t){return function(){return t}}({}),ae(si,pn);var ai=0;function ui(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function ci(t){t.readyState=4,t.l=null,t.j=null,t.A=null,hi(t)}function hi(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(Wt=si.prototype).open=function(t,e){if(this.readyState!=ai)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,hi(this)},Wt.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||Yt).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},Wt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,ci(this)),this.readyState=ai},Wt.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,hi(this)),this.g&&(this.readyState=3,hi(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==Yt.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;ui(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},Wt.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?ci(this):hi(this),3==this.readyState&&ui(this)}},Wt.Ua=function(t){this.g&&(this.response=this.responseText=t,ci(this))},Wt.Ta=function(t){this.g&&(this.response=t,ci(this))},Wt.ha=function(){this.g&&ci(this)},Wt.setRequestHeader=function(t,e){this.v.append(t,e)},Wt.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},Wt.getAllResponseHeaders=function(){if(!this.h)return"";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(si.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var li=Yt.JSON.parse;function fi(t){pn.call(this),this.headers=new wr,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=pi,this.K=this.L=!1}ae(fi,pn);var pi="",di=/^https?$/i,yi=["POST","PUT"];function gi(t){return"content-type"==t.toLowerCase()}function vi(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,mi(t),wi(t)}function mi(t){t.D||(t.D=!0,dn(t,"complete"),dn(t,"error"))}function bi(t){if(t.h&&void 0!==Xt&&(!t.C[1]||4!=Ii(t)||2!=t.ba()))if(t.v&&4==Ii(t))Cn(t.Fa,0,t);else if(dn(t,"readystatechange"),4==Ii(t)){t.h=!1;try{var e,n=t.ba();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.H).match(Tr)[1]||null;if(!o&&Yt.self&&Yt.self.location){var s=Yt.self.location.protocol;o=s.substr(0,s.length-1)}i=!di.test(o?o.toLowerCase():"")}e=i}if(e)dn(t,"complete"),dn(t,"success");else{t.m=6;try{var a=2<Ii(t)?t.g.statusText:""}catch(t){a=""}t.j=a+" ["+t.ba()+"]",mi(t)}}finally{wi(t)}}}function wi(t,e){if(t.g){Ei(t);var n=t.g,r=t.C[0]?Jt:null;t.g=null,t.C=null,e||dn(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Ei(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(Yt.clearTimeout(t.A),t.A=null)}function Ii(t){return t.g?t.g.readyState:0}function Ti(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case pi:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function _i(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return Ee(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):kr(t,e,n))}function Si(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Ai(t){this.za=0,this.l=[],this.h=new Fn,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Si("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Si("baseRetryDelayMs",5e3,t),this.$a=Si("retryDelaySeedMs",1e4,t),this.Ya=Si("forwardChannelMaxRetries",2,t),this.ra=Si("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new Qr(t&&t.concurrentRequestLimit),this.Ca=new ni,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function Ni(t){if(Ci(t),3==t.G){var e=t.V++,n=Sr(t.F);kr(n,"SID",t.J),kr(n,"RID",e),kr(n,"TYPE","terminate"),Ri(t,n),(e=new rr(t,t.h,e,void 0)).K=2,e.v=xr(Sr(n)),n=!1,Yt.navigator&&Yt.navigator.sendBeacon&&(n=Yt.navigator.sendBeacon(e.v.toString(),"")),!n&&Yt.Image&&((new Image).src=e.v,n=!0),n||(e.g=Gi(e.l,null),e.g.ea(e.v)),e.F=Date.now(),pr(e)}Ki(t)}function Di(t){t.g&&(Mi(t),t.g.cancel(),t.g=null)}function Ci(t){Di(t),t.u&&(Yt.clearTimeout(t.u),t.u=null),Ui(t),t.i.cancel(),t.m&&("number"==typeof t.m&&Yt.clearTimeout(t.m),t.m=null)}function ki(t,e){t.l.push(new Hr(t.Za++,e)),3==t.G&&xi(t)}function xi(t){$r(t.i)||t.m||(t.m=!0,Tn(t.Ha,t),t.C=0)}function Oi(t,e){var n;n=e?e.m:t.V++;var r=Sr(t.F);kr(r,"SID",t.J),kr(r,"RID",n),kr(r,"AID",t.U),Ri(t,r),t.o&&t.s&&_i(r,t.o,t.s),n=new rr(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=Li(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),Jr(t.i,n),ur(n,r,e)}function Ri(t,e){t.j&&br({},(function(t,n){kr(e,n,t)}))}function Li(t,e,n){n=Math.min(t.l.length,n);var r=t.j?oe(t.j.Oa,t.j,t):null;t:for(var i=t.l,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].h,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].h,h=i[u].g;if(0>(c-=o))o=Math.max(0,i[u].h-100),a=!1;else try{ri(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(a){r=s.join("&");break t}}return t=t.l.splice(0,n),e.D=t,r}function Pi(t){t.g||t.u||(t.Y=1,Tn(t.Ga,t),t.A=0)}function Fi(t){return!(t.g||t.u||3<=t.A)&&(t.Y++,t.u=Hn(oe(t.Ga,t),qi(t,t.A)),t.A++,!0)}function Mi(t){null!=t.B&&(Yt.clearTimeout(t.B),t.B=null)}function Vi(t){t.g=new rr(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=Sr(t.oa);kr(e,"RID","rpc"),kr(e,"SID",t.J),kr(e,"CI",t.N?"0":"1"),kr(e,"AID",t.U),Ri(t,e),kr(e,"TYPE","xmlhttp"),t.o&&t.s&&_i(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=xr(Sr(e)),n.s=null,n.U=!0,cr(n,t)}function Ui(t){null!=t.v&&(Yt.clearTimeout(t.v),t.v=null)}function ji(t,e){var n=null;if(t.g==e){Ui(t),Mi(t),t.g=null;var r=2}else{if(!Yr(t.i,e))return;n=e.D,Zr(t.i,e),r=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==r){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;dn(r=jn(),new Gn(r,n,e,i)),xi(t)}else Pi(t);else if(3==(i=e.o)||0==i&&0<t.I||!(1==r&&function(t,e){return!(Xr(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.l=e.D.concat(t.l),0):1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya)||(t.m=Hn(oe(t.Ha,t,e),qi(t,t.C)),t.C++,0)))}(t,e)||2==r&&Fi(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Bi(t,5);break;case 4:Bi(t,10);break;case 3:Bi(t,6);break;default:Bi(t,2)}}function qi(t,e){var n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function Bi(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var r=oe(t.jb,t);n||(n=new _r("//www.google.com/images/cleardot.gif"),Yt.location&&"http"==Yt.location.protocol||Ar(n,"https"),xr(n)),function(t,e){var n=new Fn;if(Yt.Image){var r=new Image;r.onload=se(ii,n,r,"TestLoadImage: loaded",!0,e),r.onerror=se(ii,n,r,"TestLoadImage: error",!1,e),r.onabort=se(ii,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=se(ii,n,r,"TestLoadImage: timeout",!1,e),Yt.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else zn(2);t.G=0,t.j&&t.j.va(e),Ki(t),Ci(t)}function Ki(t){t.G=0,t.I=-1,t.j&&(0==ti(t.i).length&&0==t.l.length||(t.i.i.length=0,pe(t.l),t.l.length=0),t.j.ua())}function zi(t,e,n){var r=function(t){return t instanceof _r?Sr(t):new _r(t,void 0)}(n);if(""!=r.i)e&&Nr(r,e+"."+r.i),Dr(r,r.m);else{var i=Yt.location;r=function(t,e,n,r){var i=new _r(null,void 0);return t&&Ar(i,t),e&&Nr(i,e),n&&Dr(i,n),r&&(i.l=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.aa&&Ee(t.aa,(function(t,e){kr(r,e,t)})),e=t.D,n=t.sa,e&&n&&kr(r,e,n),kr(r,"VER",t.ma),Ri(t,r),r}function Gi(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ba&&!t.qa?new fi(new oi({ib:!0})):new fi(t.qa)).L=t.H,e}function Hi(){}function Qi(){if(Ce&&!(10<=Number(Be)))throw Error("Environmental error: no available transport.")}function Wi(t,e){pn.call(this),this.g=new Ai(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!de(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!de(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new Yi(this)}function $i(t){tr.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Xi(){er.call(this),this.status=1}function Yi(t){this.g=t}(Wt=fi.prototype).ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Jn.g(),this.C=this.u?Xn(this.u):Xn(Jn),this.g.onreadystatechange=oe(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(t){return void vi(this,t)}t=n||"";var i=new wr(this.headers);r&&br(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=gi,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.T()),n=Yt.FormData&&t instanceof Yt.FormData,!(0<=he(yi,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.g.setRequestHeader(e,t)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Ei(this),0<this.B&&((this.K=function(t){return Ce&&je()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=oe(this.pa,this)):this.A=Cn(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){vi(this,t)}},Wt.pa=function(){void 0!==Xt&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,dn(this,"timeout"),this.abort(8))},Wt.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,dn(this,"complete"),dn(this,"abort"),wi(this))},Wt.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),wi(this,!0)),fi.Z.M.call(this)},Wt.Fa=function(){this.s||(this.F||this.v||this.l?bi(this):this.cb())},Wt.cb=function(){bi(this)},Wt.ba=function(){try{return 2<Ii(this)?this.g.status:-1}catch(t){return-1}},Wt.ga=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},Wt.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),li(e)}},Wt.Da=function(){return this.m},Wt.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(Wt=Ai.prototype).ma=8,Wt.G=1,Wt.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(t){}},Wt.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;var e=new rr(this,this.h,t,void 0),n=this.s;if(this.P&&(n?_e(n=Ie(n),this.P):n=this.P),null===this.o&&(e.H=n),this.ja)t:{for(var r=0,i=0;i<this.l.length;i++){var o=this.l[i];if(void 0===(o="__data__"in o.g&&"string"==typeof(o=o.g.__data__)?o.length:void 0))break;if(4096<(r+=o)){r=i;break t}if(4096===r||i===this.l.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=Li(this,e,r),kr(i=Sr(this.F),"RID",t),kr(i,"CVER",22),this.D&&kr(i,"X-HTTP-Session-Id",this.D),Ri(this,i),this.o&&n&&_i(i,this.o,n),Jr(this.i,e),this.Ra&&kr(i,"TYPE","init"),this.ja?(kr(i,"$req",r),kr(i,"SID","null"),e.$=!0,ur(e,i,null)):ur(e,i,r),this.G=2}}else 3==this.G&&(t?Oi(this,t):0==this.l.length||$r(this.i)||Oi(this))},Wt.Ga=function(){if(this.u=null,Vi(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=Hn(oe(this.bb,this),t)}},Wt.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,zn(10),Di(this),Vi(this))},Wt.ab=function(){null!=this.v&&(this.v=null,Di(this),Fi(this),zn(19))},Wt.jb=function(t){t?(this.h.info("Successfully pinged google.com"),zn(2)):(this.h.info("Failed to ping google.com"),zn(1))},(Wt=Hi.prototype).xa=function(){},Wt.wa=function(){},Wt.va=function(){},Wt.ua=function(){},Wt.Oa=function(){},Qi.prototype.g=function(t,e){return new Wi(t,e)},ae(Wi,pn),Wi.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),Tn(oe(t.hb,t,e))),zn(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=zi(t,null,t.W),xi(t)},Wi.prototype.close=function(){Ni(this.g)},Wi.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,ki(this.g,e)}else this.v?((e={}).__data__=gn(t),ki(this.g,e)):ki(this.g,t)},Wi.prototype.M=function(){this.g.j=null,delete this.j,Ni(this.g),delete this.g,Wi.Z.M.call(this)},ae($i,tr),ae(Xi,er),ae(Yi,Hi),Yi.prototype.xa=function(){dn(this.g,"a")},Yi.prototype.wa=function(t){dn(this.g,new $i(t))},Yi.prototype.va=function(t){dn(this.g,new Xi(t))},Yi.prototype.ua=function(){dn(this.g,"b")},Qi.prototype.createWebChannel=Qi.prototype.g,Wi.prototype.send=Wi.prototype.u,Wi.prototype.open=Wi.prototype.m,Wi.prototype.close=Wi.prototype.close,Qn.NO_ERROR=0,Qn.TIMEOUT=8,Qn.HTTP_ERROR=6,Wn.COMPLETE="complete",Yn.EventType=Zn,Zn.OPEN="a",Zn.CLOSE="b",Zn.ERROR="c",Zn.MESSAGE="d",pn.prototype.listen=pn.prototype.N,fi.prototype.listenOnce=fi.prototype.O,fi.prototype.getLastError=fi.prototype.La,fi.prototype.getLastErrorCode=fi.prototype.Da,fi.prototype.getStatus=fi.prototype.ba,fi.prototype.getResponseJson=fi.prototype.Qa,fi.prototype.getResponseText=fi.prototype.ga,fi.prototype.send=fi.prototype.ea;var Ji=Qn,Zi=Wn,to=Vn,eo=10,no=11,ro=oi,io=Yn,oo=fi,so=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();so.o=-1;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var ao={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},uo=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return $(e,t),e}(Error),co=new Ct("@firebase/firestore");function ho(){return co.logLevel}function lo(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(co.logLevel<=It.DEBUG){var r=e.map(yo);co.debug.apply(co,et(["Firestore (8.8.0): "+t],r))}}function fo(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(co.logLevel<=It.ERROR){var r=e.map(yo);co.error.apply(co,et(["Firestore (8.8.0): "+t],r))}}function po(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(co.logLevel<=It.WARN){var r=e.map(yo);co.warn.apply(co,et(["Firestore (8.8.0): "+t],r))}}function yo(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function go(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.8.0) INTERNAL ASSERTION FAILED: "+t;throw fo(e),new Error(e)}function vo(t,e){t||go()}function mo(t,e){return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function bo(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var wo=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=bo(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Eo(t,e){return t<e?-1:t>e?1:0}function Io(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function To(t){return t+"\0"}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var _o=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new uo(ao.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new uo(ao.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new uo(ao.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new uo(ao.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?Eo(this.nanoseconds,t.nanoseconds):Eo(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),So=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new _o(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ao(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function No(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Do(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Co=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&go(),void 0===n?n=t.length-e:n>t.length-e&&go(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),ko=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new uo(ao.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.emptyPath=function(){return new e([])},e}(Co),xo=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Oo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return xo.test(t)},e.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new uo(ao.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new uo(ao.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new uo(ao.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new uo(ao.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(Co),Ro=function(){function t(t){this.fields=t,t.sort(Oo.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return Io(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),Lo=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return Eo(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();Lo.EMPTY_BYTE_STRING=new Lo("");var Po=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Fo(t){if(vo(!!t),"string"==typeof t){var e=0,n=Po.exec(t);if(vo(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Mo(t.seconds),nanos:Mo(t.nanos)}}function Mo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Vo(t){return"string"==typeof t?Lo.fromBase64String(t):Lo.fromUint8Array(t)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Uo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function jo(t){var e=t.mapValue.fields.__previous_value__;return Uo(e)?jo(e):e}function qo(t){var e=Fo(t.mapValue.fields.__local_write_time__.timestampValue);return new _o(e.seconds,e.nanos)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Bo(t){return null==t}function Ko(t){return 0===t&&1/t==-1/0}function zo(t){return"number"==typeof t&&Number.isInteger(t)&&!Ko(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Go=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(ko.fromString(e))},t.fromName=function(e){return new t(ko.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===ko.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return ko.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new ko(e.slice()))},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ho(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Uo(t)?4:10:go()}function Qo(t,e){var n=Ho(t);if(n!==Ho(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return qo(t).isEqual(qo(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=Fo(t.timestampValue),r=Fo(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Vo(t.bytesValue).isEqual(Vo(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Mo(t.geoPointValue.latitude)===Mo(e.geoPointValue.latitude)&&Mo(t.geoPointValue.longitude)===Mo(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Mo(t.integerValue)===Mo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Mo(t.doubleValue),r=Mo(e.doubleValue);return n===r?Ko(n)===Ko(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Io(t.arrayValue.values||[],e.arrayValue.values||[],Qo);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Ao(n)!==Ao(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Qo(n[i],r[i])))return!1;return!0}(t,e);default:return go()}}function Wo(t,e){return void 0!==(t.values||[]).find((function(t){return Qo(t,e)}))}function $o(t,e){var n=Ho(t),r=Ho(e);if(n!==r)return Eo(n,r);switch(n){case 0:return 0;case 1:return Eo(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=Mo(t.integerValue||t.doubleValue),r=Mo(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Xo(t.timestampValue,e.timestampValue);case 4:return Xo(qo(t),qo(e));case 5:return Eo(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Vo(t),r=Vo(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Eo(n[i],r[i]);if(0!==o)return o}return Eo(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Eo(Mo(t.latitude),Mo(e.latitude));return 0!==n?n:Eo(Mo(t.longitude),Mo(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=$o(n[i],r[i]);if(o)return o}return Eo(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=Eo(r[s],o[s]);if(0!==a)return a;var u=$o(n[r[s]],i[o[s]]);if(0!==u)return u}return Eo(r.length,o.length)}(t.mapValue,e.mapValue);default:throw go()}}function Xo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Eo(t,e);var n=Fo(t),r=Fo(e),i=Eo(n.seconds,r.seconds);return 0!==i?i:Eo(n.nanos,r.nanos)}function Yo(t){return Jo(t)}function Jo(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=Fo(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Vo(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Go.fromName(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=Jo(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+Jo(t.fields[o])}return e+"}"}(t.mapValue):go();var e,n}function Zo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function ts(t){return!!t&&"integerValue"in t}function es(t){return!!t&&"arrayValue"in t}function ns(t){return!!t&&"nullValue"in t}function rs(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function is(t){return!!t&&"mapValue"in t}function os(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){var e={mapValue:{fields:{}}};return No(t.mapValue.fields,(function(t,n){return e.mapValue.fields[t]=os(n)})),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=os(t.arrayValue.values[r]);return n}return Object.assign({},t)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ss=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!is(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=os(e)},t.prototype.setAll=function(t){var e=this,n=Oo.emptyPath(),r={},i=[];t.forEach((function(t,o){if(!n.isImmediateParentOf(o)){var s=e.getFieldsMap(n);e.applyChanges(s,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=os(t):i.push(o.lastSegment())}));var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());is(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return Qo(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];is(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){No(e,(function(e,n){return t[e]=n}));for(var r=0,i=n;r<i.length;r++){var o=i[r];delete t[o]}},t.prototype.clone=function(){return new t(os(this.value))},t}();function as(t){var e=[];return No(t.fields,(function(t,n){var r=new Oo([t]);if(is(n)){var i=as(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var a=s[o];e.push(r.child(a))}}else e.push(r)})),new Ro(e)
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var us=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,So.min(),ss.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,ss.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,ss.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=ss.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=ss.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),cs=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function hs(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new cs(t,e,n,r,i,o,s)}function ls(t){var e=mo(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.canonicalString()+t.op.toString()+Yo(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.canonicalString()+t.dir}(t)})).join(","),Bo(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=_s(e.startAt)),e.endAt&&(n+="|ub:",n+=_s(e.endAt)),e.h=n}return e.h}function fs(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!As(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!Qo(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ds(t.startAt,e.startAt)&&Ds(t.endAt,e.endAt)}function ps(t){return Go.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var ds=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return $(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new ys(t,n,r):"array-contains"===n?new bs(t,r):"in"===n?new ws(t,r):"not-in"===n?new Es(t,r):"array-contains-any"===n?new Is(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new gs(t,n):new vs(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m($o(e,this.value)):null!==e&&Ho(this.value)===Ho(e)&&this.m($o(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return go()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),ys=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Go.fromName(r.referenceValue),i}return $(e,t),e.prototype.matches=function(t){var e=Go.comparator(t.key,this.key);return this.m(e)},e}(ds),gs=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=ms("in",n),r}return $(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(ds),vs=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=ms("not-in",n),r}return $(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(ds);function ms(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return Go.fromName(t.referenceValue)}))}var bs=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return $(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return es(e)&&Wo(e.arrayValue,this.value)},e}(ds),ws=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return $(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&Wo(this.value.arrayValue,e)},e}(ds),Es=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return $(e,t),e.prototype.matches=function(t){if(Wo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!Wo(this.value.arrayValue,e)},e}(ds),Is=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return $(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!es(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return Wo(e.value.arrayValue,t)}))},e}(ds),Ts=function(t,e){this.position=t,this.before=e};function _s(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return Yo(t)})).join(",")}var Ss=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function As(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Ns(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.isKeyField()?Go.comparator(Go.fromName(s.referenceValue),n.key):$o(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Ds(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Qo(t.position[n],e.position[n]))return!1;return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Cs=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null,this.startAt,this.endAt};function ks(t,e,n,r,i,o,s,a){return new Cs(t,e,n,r,i,o,s,a)}function xs(t){return new Cs(t)}function Os(t){return!Bo(t.limit)&&"F"===t.limitType}function Rs(t){return!Bo(t.limit)&&"L"===t.limitType}function Ls(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Ps(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function Fs(t){return null!==t.collectionGroup}function Ms(t){var e=mo(t);if(null===e.p){e.p=[];var n=Ps(e),r=Ls(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new Ss(n)),e.p.push(new Ss(Oo.keyField(),"asc"));else{for(var i=!1,o=0,s=e.explicitOrderBy;o<s.length;o++){var a=s[o];e.p.push(a),a.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new Ss(Oo.keyField(),u))}}}return e.p}function Vs(t){var e=mo(t);if(!e.T)if("F"===e.limitType)e.T=hs(e.path,e.collectionGroup,Ms(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Ms(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Ss(o.field,s))}var a=e.endAt?new Ts(e.endAt.position,!e.endAt.before):null,u=e.startAt?new Ts(e.startAt.position,!e.startAt.before):null;e.T=hs(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.T}function Us(t,e,n){return new Cs(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function js(t,e){return fs(Vs(t),Vs(e))&&t.limitType===e.limitType}function qs(t){return ls(Vs(t))+"|lt:"+t.limitType}function Bs(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.canonicalString()+" "+e.op+" "+Yo(e.value);var e})).join(", ")+"]"),Bo(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+_s(t.startAt)),t.endAt&&(e+=", endAt: "+_s(t.endAt)),"Target("+e+")"}(Vs(t))+"; limitType="+t.limitType+")"}function Ks(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Go.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Ns(t.startAt,Ms(t),e)||t.endAt&&Ns(t.endAt,Ms(t),e))}(t,e)}function zs(t){return function(e,n){for(var r=!1,i=0,o=Ms(t);i<o.length;i++){var s=o[i],a=Gs(s,e,n);if(0!==a)return a;r=r||s.field.isKeyField()}return 0}}function Gs(t,e,n){var r=t.field.isKeyField()?Go.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?$o(r,i):go()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return go()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Hs(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ko(e)?"-0":e}}function Qs(t){return{integerValue:""+t}}function Ws(t,e){return zo(e)?Qs(e):Hs(t,e)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var $s=function(){this._=void 0};function Xs(t,e,n){return t instanceof Zs?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof ta?ea(t,e):t instanceof na?ra(t,e):function(t,e){var n=Js(t,e),r=oa(n)+oa(t.A);return ts(n)&&ts(t.A)?Qs(r):Hs(t.R,r)}(t,e)}function Ys(t,e,n){return t instanceof ta?ea(t,e):t instanceof na?ra(t,e):n}function Js(t,e){return t instanceof ia?ts(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var Zs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $(e,t),e}($s),ta=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return $(e,t),e}($s);function ea(t,e){for(var n=sa(e),r=function(t){n.some((function(e){return Qo(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var na=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return $(e,t),e}($s);function ra(t,e){for(var n=sa(e),r=function(t){n=n.filter((function(e){return!Qo(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var ia=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return $(e,t),e}($s);function oa(t){return Mo(t.integerValue||t.doubleValue)}function sa(t){return es(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var aa=function(t,e){this.field=t,this.transform=e},ua=function(t,e){this.version=t,this.transformResults=e},ca=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function ha(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var la=function(){};function fa(t,e,n){t instanceof va?function(t,e,n){var r=t.value.clone(),i=wa(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof ma?function(t,e,n){if(ha(t.precondition,e)){var r=wa(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(ba(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function pa(t,e,n){t instanceof va?function(t,e,n){if(ha(t.precondition,e)){var r=t.value.clone(),i=Ea(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(ga(e),r).setHasLocalMutations()}}(t,e,n):t instanceof ma?function(t,e,n){if(ha(t.precondition,e)){var r=Ea(t.fieldTransforms,n,e),i=e.data;i.setAll(ba(t)),i.setAll(r),e.convertToFoundDocument(ga(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){ha(t.precondition,e)&&e.convertToNoDocument(So.min())}(t,e)}function da(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e.data.field(o.field),a=Js(o.transform,s||null);null!=a&&(null==n&&(n=ss.empty()),n.set(o.field,a))}return n||null}function ya(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Io(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof ta&&e instanceof ta||t instanceof na&&e instanceof na?Io(t.elements,e.elements,Qo):t instanceof ia&&e instanceof ia?Qo(t.A,e.A):t instanceof Zs&&e instanceof Zs}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function ga(t){return t.isFoundDocument()?t.version:So.min()}var va=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return $(e,t),e}(la),ma=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.fieldMask=r,s.precondition=i,s.fieldTransforms=o,s.type=1,s}return $(e,t),e}(la);function ba(t){var e=new Map;return t.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}})),e}function wa(t,e,n){var r=new Map;vo(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,Ys(s,a,n[i]))}return r}function Ea(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var s=o[i],a=s.transform,u=n.data.field(s.field);r.set(s.field,Xs(a,u,e))}return r}var Ia,Ta,_a=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return $(e,t),e}(la),Sa=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return $(e,t),e}(la),Aa=function(t){this.count=t};function Na(t){switch(t){case ao.OK:return go();case ao.CANCELLED:case ao.UNKNOWN:case ao.DEADLINE_EXCEEDED:case ao.RESOURCE_EXHAUSTED:case ao.INTERNAL:case ao.UNAVAILABLE:case ao.UNAUTHENTICATED:return!1;case ao.INVALID_ARGUMENT:case ao.NOT_FOUND:case ao.ALREADY_EXISTS:case ao.PERMISSION_DENIED:case ao.FAILED_PRECONDITION:case ao.ABORTED:case ao.OUT_OF_RANGE:case ao.UNIMPLEMENTED:case ao.DATA_LOSS:return!0;default:return go()}}function Da(t){if(void 0===t)return fo("GRPC error has no .code"),ao.UNKNOWN;switch(t){case Ia.OK:return ao.OK;case Ia.CANCELLED:return ao.CANCELLED;case Ia.UNKNOWN:return ao.UNKNOWN;case Ia.DEADLINE_EXCEEDED:return ao.DEADLINE_EXCEEDED;case Ia.RESOURCE_EXHAUSTED:return ao.RESOURCE_EXHAUSTED;case Ia.INTERNAL:return ao.INTERNAL;case Ia.UNAVAILABLE:return ao.UNAVAILABLE;case Ia.UNAUTHENTICATED:return ao.UNAUTHENTICATED;case Ia.INVALID_ARGUMENT:return ao.INVALID_ARGUMENT;case Ia.NOT_FOUND:return ao.NOT_FOUND;case Ia.ALREADY_EXISTS:return ao.ALREADY_EXISTS;case Ia.PERMISSION_DENIED:return ao.PERMISSION_DENIED;case Ia.FAILED_PRECONDITION:return ao.FAILED_PRECONDITION;case Ia.ABORTED:return ao.ABORTED;case Ia.OUT_OF_RANGE:return ao.OUT_OF_RANGE;case Ia.UNIMPLEMENTED:return ao.UNIMPLEMENTED;case Ia.DATA_LOSS:return ao.DATA_LOSS;default:return go()}}(Ta=Ia||(Ia={}))[Ta.OK=0]="OK",Ta[Ta.CANCELLED=1]="CANCELLED",Ta[Ta.UNKNOWN=2]="UNKNOWN",Ta[Ta.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ta[Ta.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ta[Ta.NOT_FOUND=5]="NOT_FOUND",Ta[Ta.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ta[Ta.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ta[Ta.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ta[Ta.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ta[Ta.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ta[Ta.ABORTED=10]="ABORTED",Ta[Ta.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ta[Ta.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ta[Ta.INTERNAL=13]="INTERNAL",Ta[Ta.UNAVAILABLE=14]="UNAVAILABLE",Ta[Ta.DATA_LOSS=15]="DATA_LOSS";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Ca=function(){function t(t,e){this.comparator=t,this.root=e||xa.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,xa.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,xa.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new ka(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new ka(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new ka(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new ka(this.root,t,this.comparator,!0)},t}(),ka=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),xa=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw go();if(this.right.isRed())throw go();var t=this.left.check();if(t!==this.right.check())throw go();return t+(this.isRed()?0:1)},t}();xa.EMPTY=null,xa.RED=!0,xa.BLACK=!1,xa.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw go()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw go()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw go()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw go()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw go()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new xa(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Oa=function(){function t(t){this.comparator=t,this.data=new Ca(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new Ra(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new Ra(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),Ra=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),La=new Ca(Go.comparator);function Pa(){return La}var Fa=new Ca(Go.comparator);function Ma(){return Fa}var Va=new Ca(Go.comparator);var Ua=new Oa(Go.comparator);function ja(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Ua,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var qa=new Oa(Eo);function Ba(){return qa}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ka=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,za.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(So.min(),r,Ba(),Pa(),ja())},t}(),za=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(Lo.EMPTY_BYTE_STRING,n,ja(),ja(),ja())},t}(),Ga=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},Ha=function(t,e){this.targetId=t,this.V=e},Qa=function(t,e,n,r){void 0===n&&(n=Lo.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Wa=function(){function t(){this.S=0,this.D=Ya(),this.C=Lo.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.F},enumerable:!1,configurable:!0}),t.prototype.O=function(t){t.approximateByteSize()>0&&(this.F=!0,this.C=t)},t.prototype.M=function(){var t=ja(),e=ja(),n=ja();return this.D.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:go()}})),new za(this.C,this.N,t,e,n)},t.prototype.L=function(){this.F=!1,this.D=Ya()},t.prototype.B=function(t,e){this.F=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.F=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.F=!0,this.N=!0},t}(),$a=function(){function t(t){this.W=t,this.G=new Map,this.H=Pa(),this.J=Xa(),this.Y=new Oa(Eo)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.tt(r,t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.k||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.k||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:go()}}))},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach((function(t,r){n.st(r)&&e(r)}))},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(ps(i))if(0===n){var o=new Go(i.path);this.tt(e,o,us.newNoDocument(o,So.min()))}else vo(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach((function(r,i){var o=e.ot(i);if(o){if(r.current&&ps(o.target)){var s=new Go(o.target.path);null!==e.H.get(s)||e.at(i,s)||e.tt(i,s,us.newNoDocument(s,t))}r.$&&(n.set(i,r.M()),r.L())}}));var r=ja();this.J.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new Ka(t,n,this.Y,this.H,r);return this.H=Pa(),this.J=Xa(),this.Y=new Oa(Eo),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new Wa,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new Oa(Eo),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||lo("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.k?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new Wa),this.W.getRemoteKeysForTarget(t).forEach((function(n){e.tt(t,n,null)}))},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function Xa(){return new Ca(Go.comparator)}function Ya(){return new Ca(Go.comparator)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ja={asc:"ASCENDING",desc:"DESCENDING"},Za={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},tu=function(t,e){this.databaseId=t,this.I=e};function eu(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function nu(t,e){return t.I?e.toBase64():e.toUint8Array()}function ru(t,e){return eu(t,e.toTimestamp())}function iu(t){return vo(!!t),So.fromTimestamp(function(t){var e=Fo(t);return new _o(e.seconds,e.nanos)}(t))}function ou(t,e){return function(t){return new ko(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function su(t){var e=ko.fromString(t);return vo(Cu(e)),e}function au(t,e){return ou(t.databaseId,e.path)}function uu(t,e){var n=su(e);if(n.get(1)!==t.databaseId.projectId)throw new uo(ao.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new uo(ao.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Go(fu(n))}function cu(t,e){return ou(t.databaseId,e)}function hu(t){var e=su(t);return 4===e.length?ko.emptyPath():fu(e)}function lu(t){return new ko(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function fu(t){return vo(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function pu(t,e,n){return{name:au(t,e),fields:n.value.mapValue.fields}}function du(t,e){var n;if(e instanceof va)n={update:pu(t,e.key,e.value)};else if(e instanceof _a)n={delete:au(t,e.key)};else if(e instanceof ma)n={update:pu(t,e.key,e.data),updateMask:Du(e.fieldMask)};else{if(!(e instanceof Sa))return go();n={verify:au(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof Zs)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof ta)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof na)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof ia)return{fieldPath:e.field.canonicalString(),increment:n.A};throw go()}(0,t)}))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:ru(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:go()}(t,e.precondition)),n}function yu(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?ca.updateTime(iu(t.updateTime)):void 0!==t.exists?ca.exists(t.exists):ca.none()}(e.currentDocument):ca.none(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)vo("REQUEST_TIME"===e.setToServerValue),n=new Zs;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new ta(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new na(i)}else"increment"in e?n=new ia(t,e.increment):go();var o=Oo.fromServerFormat(e.fieldPath);return new aa(o,n)}(t,e)})):[];if(e.update){e.update.name;var i=uu(t,e.update.name),o=new ss({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){var e=t.fieldPaths||[];return new Ro(e.map((function(t){return Oo.fromServerFormat(t)})))}(e.updateMask);return new ma(i,o,s,n,r)}return new va(i,o,n,r)}if(e.delete){var a=uu(t,e.delete);return new _a(a,n)}if(e.verify){var u=uu(t,e.verify);return new Sa(u,n)}return go()}function gu(t,e){return{documents:[cu(t,e.path)]}}function vu(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=cu(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=cu(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(rs(t.value))return{unaryFilter:{field:_u(t.field),op:"IS_NAN"}};if(ns(t.value))return{unaryFilter:{field:_u(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(rs(t.value))return{unaryFilter:{field:_u(t.field),op:"IS_NOT_NAN"}};if(ns(t.value))return{unaryFilter:{field:_u(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:_u(t.field),op:Tu(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:_u(t.field),direction:Iu(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.I||Bo(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=wu(e.startAt)),e.endAt&&(n.structuredQuery.endAt=wu(e.endAt)),n}function mu(t){var e=hu(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){vo(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=bu(n.where));var a=[];n.orderBy&&(a=n.orderBy.map((function(t){return function(t){return new Ss(Su(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var u=null;n.limit&&(u=function(t){var e;return Bo(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Eu(n.startAt));var h=null;return n.endAt&&(h=Eu(n.endAt)),ks(e,i,a,s,u,"F",c,h)}function bu(t){return t?void 0!==t.unaryFilter?[Nu(t)]:void 0!==t.fieldFilter?[Au(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return bu(t)})).reduce((function(t,e){return t.concat(e)})):go():[]}function wu(t){return{before:t.before,values:t.position}}function Eu(t){var e=!!t.before,n=t.values||[];return new Ts(n,e)}function Iu(t){return Ja[t]}function Tu(t){return Za[t]}function _u(t){return{fieldPath:t.canonicalString()}}function Su(t){return Oo.fromServerFormat(t.fieldPath)}function Au(t){return ds.create(Su(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return go()}}(t.fieldFilter.op),t.fieldFilter.value)}function Nu(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Su(t.unaryFilter.field);return ds.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Su(t.unaryFilter.field);return ds.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Su(t.unaryFilter.field);return ds.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Su(t.unaryFilter.field);return ds.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return go()}}function Du(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}}function Cu(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ku(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Ou(e)),e=xu(t.get(n),e);return Ou(e)}function xu(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function Ou(t){return t+""}function Ru(t){var e=t.length;if(vo(e>=2),2===e)return vo(""===t.charAt(0)&&""===t.charAt(1)),ko.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&go(),t.charAt(s+1)){case"":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:go()}o=s+2}return new ko(r)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Lu=function(t,e){this.seconds=t,this.nanoseconds=e},Pu=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Pu.store="owner",Pu.key="owner";var Fu=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Fu.store="mutationQueues",Fu.keyPath="userId";var Mu=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Mu.store="mutations",Mu.keyPath="batchId",Mu.userMutationsIndex="userMutationsIndex",Mu.userMutationsKeyPath=["userId","batchId"];var Vu=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,ku(e)]},t.key=function(t,e,n){return[t,ku(e),n]},t}();Vu.store="documentMutations",Vu.PLACEHOLDER=new Vu;var Uu=function(t,e){this.path=t,this.readTime=e},ju=function(t,e){this.path=t,this.version=e},qu=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};qu.store="remoteDocuments",qu.readTimeIndex="readTimeIndex",qu.readTimeIndexPath="readTime",qu.collectionReadTimeIndex="collectionReadTimeIndex",qu.collectionReadTimeIndexPath=["parentPath","readTime"];var Bu=function(t){this.byteSize=t};Bu.store="remoteDocumentGlobal",Bu.key="remoteDocumentGlobalKey";var Ku=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Ku.store="targets",Ku.keyPath="targetId",Ku.queryTargetsIndexName="queryTargetsIndex",Ku.queryTargetsKeyPath=["canonicalId","targetId"];var zu=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};zu.store="targetDocuments",zu.keyPath=["targetId","path"],zu.documentTargetsIndex="documentTargetsIndex",zu.documentTargetsKeyPath=["path","targetId"];var Gu=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Gu.key="targetGlobalKey",Gu.store="targetGlobal";var Hu=function(t,e){this.collectionId=t,this.parent=e};Hu.store="collectionParents",Hu.keyPath=["collectionId","parent"];var Qu=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Qu.store="clientMetadata",Qu.keyPath="clientId";var Wu=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Wu.store="bundles",Wu.keyPath="bundleId";var $u=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};$u.store="namedQueries",$u.keyPath="name";var Xu=et(et([],et(et([],et(et([],et(et([],[Fu.store,Mu.store,Vu.store,qu.store,Ku.store,Pu.store,Gu.store,zu.store]),[Qu.store])),[Bu.store])),[Hu.store])),[Wu.store,$u.store]),Yu="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ju=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},t}(),Zu=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},tc=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&go(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))},t.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.waitFor=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},t}(),ec=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new Zu,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new ic(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=cc(e.target.error);n.ft.reject(new ic(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new ic(n,e)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(lo("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new sc(e)},t}(),nc=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t(ot())&&fo("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return lo("SimpleDb","Removing database:",t),ac(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=ot(),n=t._t(e),r=0<n&&n<10,i=t.Et(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.gt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return Y(this,void 0,void 0,(function(){var e,n=this;return J(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(lo("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new ic(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new uo(ao.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new ic(t,n))},i.onupgradeneeded=function(t){lo("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.wt.Rt(e,i.transaction,t.oldVersion,n.version).next((function(){lo("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}}))}))},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Y(this,void 0,void 0,(function(){var i,o,s,a,u;return J(this,(function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,u,c,h;return J(this,(function(l){switch(l.label){case 0:++o,l.label=1;case 1:return l.trys.push([1,4,,5]),[4,a.At(t)];case 2:return a.db=l.sent(),e=ec.open(a.db,t,i?"readonly":"readwrite",n),s=r(e).catch((function(t){return e.abort(t),tc.reject(t)})).toPromise(),u={},s.catch((function(){})),[4,e.dt];case 3:return[2,(u.value=(l.sent(),s),u)];case 4:return c=l.sent(),h="FirebaseError"!==c.name&&o<3,lo("SimpleDb","Transaction failed with error:",c.message,"Retrying:",h),a.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},a=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),rc=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return ac(this.Pt.delete())},t}(),ic=function(t){function e(e,n){var r=this;return(r=t.call(this,ao.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return $(e,t),e}(uo);function oc(t){return"IndexedDbTransactionError"===t.name}var sc=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(lo("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(lo("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),ac(n)},t.prototype.add=function(t){return lo("SimpleDb","ADD",this.store.name,t,t),ac(this.store.add(t))},t.prototype.get=function(t){var e=this;return ac(this.store.get(t)).next((function(n){return void 0===n&&(n=null),lo("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return lo("SimpleDb","DELETE",this.store.name,t),ac(this.store.delete(t))},t.prototype.count=function(){return lo("SimpleDb","COUNT",this.store.name),ac(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.Ft=function(t,e){lo("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.kt=!1;var r=this.cursor(n);return this.xt(r,(function(t,e,n){return n.delete()}))},t.prototype.$t=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new tc((function(n,r){e.onerror=function(t){var e=cc(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.xt=function(t,e){var n=[];return new tc((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new rc(i),s=e(i.primaryKey,i.value,o);if(s instanceof tc){var a=s.catch((function(t){return o.done(),tc.reject(t)}));n.push(a)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}})).next((function(){return tc.waitFor(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.kt?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function ac(t){return new tc((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=cc(t.target.error);n(e)}}))}var uc=!1;function cc(t){var e=nc._t(ot());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new uo("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return uc||(uc=!0,setTimeout((function(){throw r}),0)),r}}return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var hc=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return $(e,t),e}(Ju);function lc(t,e){var n=mo(t);return nc.It(n.Mt,e)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var fc=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&fa(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&pa(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&pa(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach((function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(So.min())}))},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),ja())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Io(this.mutations,t.mutations,(function(t,e){return ya(t,e)}))&&Io(this.baseMutations,t.baseMutations,(function(t,e){return ya(t,e)}))},t}(),pc=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){vo(e.mutations.length===r.length);for(var i=Va,o=e.mutations,s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),dc=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=So.min()),void 0===o&&(o=So.min()),void 0===s&&(s=Lo.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),yc=function(t){this.Lt=t};function gc(t,e){if(e.document)return function(t,e,n){var r=uu(t,e.name),i=iu(e.updateTime),o=new ss({mapValue:{fields:e.fields}}),s=us.newFoundDocument(r,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Go.fromSegments(e.noDocument.path),r=Ec(e.noDocument.readTime),i=us.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=Go.fromSegments(e.unknownDocument.path);return r=Ec(e.unknownDocument.version),us.newUnknownDocument(o,r)}return go()}function vc(t,e,n){var r=mc(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:au(t,e.key),fields:e.data.value.mapValue.fields,updateTime:eu(t,e.version.toTimestamp())}}(t.Lt,e),s=e.hasCommittedMutations;return new qu(null,null,o,s,r,i)}if(e.isNoDocument()){var a=e.key.path.toArray(),u=wc(e.version);return s=e.hasCommittedMutations,new qu(null,new Uu(a,u),null,s,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),h=wc(e.version);return new qu(new ju(c,h),null,null,!0,r,i)}return go()}function mc(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function bc(t){var e=new _o(t[0],t[1]);return So.fromTimestamp(e)}function wc(t){var e=t.toTimestamp();return new Lu(e.seconds,e.nanoseconds)}function Ec(t){var e=new _o(t.seconds,t.nanoseconds);return So.fromTimestamp(e)}function Ic(t,e){for(var n=(e.baseMutations||[]).map((function(e){return yu(t.Lt,e)})),r=0;r<e.mutations.length-1;++r){var i=e.mutations[r];if(r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform){var o=e.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var s=e.mutations.map((function(e){return yu(t.Lt,e)})),a=_o.fromMillis(e.localWriteTimeMs);return new fc(e.batchId,a,n,s)}function Tc(t){var e,n,r=Ec(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Ec(t.lastLimboFreeSnapshotVersion):So.min();return void 0!==t.query.documents?(vo(1===(n=t.query).documents.length),e=Vs(xs(hu(n.documents[0])))):e=function(t){return Vs(mu(t))}(t.query),new dc(e,t.targetId,0,t.lastListenSequenceNumber,r,i,Lo.fromBase64String(t.resumeToken))}function _c(t,e){var n,r=wc(e.snapshotVersion),i=wc(e.lastLimboFreeSnapshotVersion);n=ps(e.target)?gu(t.Lt,e.target):vu(t.Lt,e.target);var o=e.resumeToken.toBase64();return new Ku(e.targetId,ls(e.target),r,o,e.sequenceNumber,i,n)}function Sc(t){var e=mu({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Us(e,e.limit,"L"):e}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ac=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return Nc(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:Ec(e.createTime),version:e.version};var e}))},t.prototype.saveBundleMetadata=function(t,e){return Nc(t).put({bundleId:(n=e).id,createTime:wc(iu(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return Dc(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:Sc(e.bundledQuery),readTime:Ec(e.readTime)};var e}))},t.prototype.saveNamedQuery=function(t,e){return Dc(t).put(function(t){return{name:t.name,readTime:wc(iu(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function Nc(t){return lc(t,Wu.store)}function Dc(t){return lc(t,$u.store)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Cc=function(){function t(){this.Bt=new kc}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),tc.resolve()},t.prototype.getCollectionParents=function(t,e){return tc.resolve(this.Bt.getEntries(e))},t}(),kc=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Oa(ko.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Oa(ko.comparator)).toArray()},t}(),xc=function(){function t(){this.qt=new kc}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener((function(){n.qt.add(e)}));var o={collectionId:r,parent:ku(i)};return Oc(t).put(o)}return tc.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[To(e),""],!1,!0);return Oc(t).Nt(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Ru(o.parent))}return n}))},t}();function Oc(t){return lc(t,Hu.store)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Rc={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Lc=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Pc(t,e,n){var r=t.store(Mu.store),i=t.store(Vu.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.$t({range:s},(function(t,e,n){return a++,n.delete()}));o.push(u.next((function(){vo(1===a)})));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],p=Vu.key(e,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return tc.waitFor(o).next((function(){return c}))}function Fc(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw go();e=t.noDocument}return JSON.stringify(e).length}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */Lc.DEFAULT_COLLECTION_PERCENTILE=10,Lc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Lc.DEFAULT=new Lc(41943040,Lc.DEFAULT_COLLECTION_PERCENTILE,Lc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Lc.DISABLED=new Lc(-1,0,0);var Mc=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Kt={}}return t.Qt=function(e,n,r,i){return vo(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Uc(t).$t({index:Mu.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=jc(t),s=Uc(t);return s.add({}).next((function(a){vo("number"==typeof a);for(var u=new fc(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return du(t.Lt,e)})),i=n.mutations.map((function(e){return du(t.Lt,e)}));return new Mu(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),h=[],l=new Oa((function(t,e){return Eo(t.canonicalString(),e.canonicalString())})),f=0,p=r;f<p.length;f++){var d=p[f],y=Vu.key(i.userId,d.key.path,a);l=l.add(d.key.path.popLast()),h.push(s.put(c)),h.push(o.put(y,Vu.PLACEHOLDER))}return l.forEach((function(e){h.push(i.Ut.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.Kt[a]=u.keys()})),tc.waitFor(h).next((function(){return u}))}))},t.prototype.lookupMutationBatch=function(t,e){var n=this;return Uc(t).get(e).next((function(t){return t?(vo(t.userId===n.userId),Ic(n.R,t)):null}))},t.prototype.jt=function(t,e){var n=this;return this.Kt[e]?tc.resolve(this.Kt[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var r=t.keys();return n.Kt[e]=r,r}return null}))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Uc(t).$t({index:Mu.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(vo(e.batchId>=r),o=Ic(n.R,e)),i.done()})).next((function(){return o}))},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Uc(t).$t({index:Mu.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Uc(t).Nt(Mu.userMutationsIndex,n).next((function(t){return t.map((function(t){return Ic(e.R,t)}))}))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=Vu.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return jc(t).$t({range:i},(function(r,i,s){var a=r[0],u=r[1],c=r[2],h=Ru(u);if(a===n.userId&&e.path.isEqual(h))return Uc(t).get(c).next((function(t){if(!t)throw go();vo(t.userId===n.userId),o.push(Ic(n.R,t))}));s.done()})).next((function(){return o}))},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Oa(Eo),i=[];return e.forEach((function(e){var o=Vu.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=jc(t).$t({range:s},(function(t,i,o){var s=t[0],a=t[1],u=t[2],c=Ru(a);s===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(a)})),tc.waitFor(i).next((function(){return n.Wt(t,r)}))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=Vu.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new Oa(Eo);return jc(t).$t({range:s},(function(t,e,o){var s=t[0],u=t[1],c=t[2],h=Ru(u);s===n.userId&&r.isPrefixOf(h)?h.length===i&&(a=a.add(c)):o.done()})).next((function(){return n.Wt(t,a)}))},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(Uc(t).get(e).next((function(t){if(null===t)throw go();vo(t.userId===n.userId),r.push(Ic(n.R,t))})))})),tc.waitFor(i).next((function(){return r}))},t.prototype.removeMutationBatch=function(t,e){var n=this;return Pc(t.Mt,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.Gt(e.batchId)})),tc.forEach(r,(function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)}))}))},t.prototype.Gt=function(t){delete this.Kt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return tc.resolve();var r=IDBKeyRange.lowerBound(Vu.prefixForUser(e.userId)),i=[];return jc(t).$t({range:r},(function(t,n,r){if(t[0]===e.userId){var o=Ru(t[1]);i.push(o)}else r.done()})).next((function(){vo(0===i.length)}))}))},t.prototype.containsKey=function(t,e){return Vc(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return qc(t).get(this.userId).next((function(t){return t||new Fu(e.userId,-1,"")}))},t}();function Vc(t,e,n){var r=Vu.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return jc(t).$t({range:o,kt:!0},(function(t,n,r){var o=t[0],a=t[1];t[2],o===e&&a===i&&(s=!0),r.done()})).next((function(){return s}))}function Uc(t){return lc(t,Mu.store)}function jc(t){return lc(t,Vu.store)}function qc(t){return lc(t,Fu.store)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Bc=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),Kc=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next((function(n){var r=new Bc(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next((function(t){return So.fromTimestamp(new _o(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)}))},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next((function(){return n.Xt(t).next((function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)}))}))},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return zc(t).delete(e.targetId)})).next((function(){return n.Xt(t)})).next((function(e){return vo(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)}))},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return zc(t).$t((function(s,a){var u=Tc(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))})).next((function(){return tc.waitFor(o)})).next((function(){return i}))},t.prototype.forEachTarget=function(t,e){return zc(t).$t((function(t,n){var r=Tc(n);e(r)}))},t.prototype.Xt=function(t){return Gc(t).get(Gu.key).next((function(t){return vo(null!==t),t}))},t.prototype.Zt=function(t,e){return Gc(t).put(Gu.key,e)},t.prototype.te=function(t,e){return zc(t).put(_c(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next((function(t){return t.targetCount}))},t.prototype.getTargetData=function(t,e){var n=ls(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return zc(t).$t({range:r,index:Ku.queryTargetsIndexName},(function(t,n,r){var o=Tc(n);fs(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=Hc(t);return e.forEach((function(e){var s=ku(e.path);i.push(o.put(new zu(n,s))),i.push(r.referenceDelegate.addReference(t,n,e))})),tc.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=Hc(t);return tc.forEach(e,(function(e){var o=ku(e.path);return tc.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])}))},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=Hc(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Hc(t),i=ja();return r.$t({range:n,kt:!0},(function(t,e,n){var r=Ru(t[1]),o=new Go(r);i=i.add(o)})).next((function(){return i}))},t.prototype.containsKey=function(t,e){var n=ku(e.path),r=IDBKeyRange.bound([n],[To(n)],!1,!0),i=0;return Hc(t).$t({index:zu.documentTargetsIndex,kt:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.lt=function(t,e){return zc(t).get(e).next((function(t){return t?Tc(t):null}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function zc(t){return lc(t,Ku.store)}function Gc(t){return lc(t,Gu.store)}function Hc(t){return lc(t,zu.store)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Qc(t){return Y(this,void 0,void 0,(function(){return J(this,(function(e){if(t.code!==ao.FAILED_PRECONDITION||t.message!==Yu)throw t;return lo("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Wc(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Eo(n,i);return 0===s?Eo(r,o):s}var $c=function(){function t(t){this.ne=t,this.buffer=new Oa(Wc),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Wc(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Xc=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;lo("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,(function(){return Y(e,void 0,void 0,(function(){var e;return J(this,(function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return oc(e=n.sent())?(lo("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Qc(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),Yc=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return tc.resolve(so.o);var r=new $c(e);return this.ae.forEachTarget(t,(function(t){return r.re(t.sequenceNumber)})).next((function(){return n.ae.le(t,(function(t){return r.re(t)}))})).next((function(){return r.maxValue}))},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(lo("LruGarbageCollector","Garbage collection skipped; disabled"),tc.resolve(Rc)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(lo("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),Rc):n.fe(t,e)}))},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,o,s,a,u,c=this,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return e>c.params.maximumSequenceNumbersToCollect?(lo("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)})).next((function(r){return n=r,s=Date.now(),c.removeTargets(t,n,e)})).next((function(e){return i=e,a=Date.now(),c.removeOrphanedDocuments(t,n)})).next((function(t){return u=Date.now(),ho()<=It.DEBUG&&lo("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-h)+"ms"),tc.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})}))},t}(),Jc=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new Yc(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.de=function(t){var e=0;return this.le(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,(function(t,n){return e(n)}))},t.prototype.addReference=function(t,e,n){return Zc(t,n)},t.prototype.removeReference=function(t,e,n){return Zc(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return Zc(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return qc(t).Ot((function(r){return Vc(t,r,e).next((function(t){return t&&(n=!0),tc.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,(function(s,a){if(a<=e){var u=n._e(t,s).next((function(e){if(!e)return o++,r.getEntry(t,s).next((function(){return r.removeEntry(s),Hc(t).delete([0,ku(s.path)])}))}));i.push(u)}})).next((function(){return tc.waitFor(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return Zc(t,e)},t.prototype.we=function(t,e){var n,r=Hc(t),i=so.o;return r.$t({index:zu.documentTargetsIndex},(function(t,r){var o=t[0];t[1];var s=r.path,a=r.sequenceNumber;0===o?(i!==so.o&&e(new Go(Ru(n)),i),i=a,n=s):i=so.o})).next((function(){i!==so.o&&e(new Go(Ru(n)),i)}))},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function Zc(t,e){return Hc(t).put(function(t,e){return new zu(0,ku(t.path),e)}(e,t.currentSequenceNumber))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var th=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(this.equalsFn(s,t))return a}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){No(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];t(s,a)}}))},t.prototype.isEmpty=function(){return Do(this.inner)},t}(),eh=function(){function t(){this.changes=new th((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:So.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:us.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?tc.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),nh=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return oh(t).put(sh(e),n)},t.prototype.removeEntry=function(t,e){var n=oh(t),r=sh(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.me(t,r)}))},t.prototype.getEntry=function(t,e){var n=this;return oh(t).get(sh(e)).next((function(t){return n.ye(e,t)}))},t.prototype.ge=function(t,e){var n=this;return oh(t).get(sh(e)).next((function(t){return{document:n.ye(e,t),size:Fc(t)}}))},t.prototype.getEntries=function(t,e){var n=this,r=Pa();return this.pe(t,e,(function(t,e){var i=n.ye(t,e);r=r.insert(t,i)})).next((function(){return r}))},t.prototype.Ee=function(t,e){var n=this,r=Pa(),i=new Ca(Go.comparator);return this.pe(t,e,(function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,Fc(e))})).next((function(){return{documents:r,Te:i}}))},t.prototype.pe=function(t,e,n){if(e.isEmpty())return tc.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return oh(t).$t({range:r},(function(t,e,r){for(var s=Go.fromSegments(t);o&&Go.comparator(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=Pa(),o=e.path.length+1,s={};if(n.isEqual(So.min())){var a=e.path.toArray();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.toArray(),c=mc(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=qu.collectionReadTimeIndex}return oh(t).$t(s,(function(t,n,s){if(t.length===o){var a=gc(r.R,n);e.path.isPrefixOf(a.key.path)?Ks(e,a)&&(i=i.insert(a.key,a)):s.done()}})).next((function(){return i}))},t.prototype.newChangeBuffer=function(t){return new rh(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return ih(t).get(Bu.key).next((function(t){return vo(!!t),t}))},t.prototype.me=function(t,e){return ih(t).put(Bu.key,e)},t.prototype.ye=function(t,e){if(e){var n=gc(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(So.min()))return n}return us.newInvalidDocument(t)},t}(),rh=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new th((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return $(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new Oa((function(t,e){return Eo(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,s){var a=e.Ae.get(o);if(s.document.isValidDocument()){var u=vc(e.Ie.R,s.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=Fc(u);r+=c-a,n.push(e.Ie.addEntry(t,o,u))}else if(r-=a,e.trackRemovals){var h=vc(e.Ie.R,us.newNoDocument(o,So.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,h))}else n.push(e.Ie.removeEntry(t,o))})),i.forEach((function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))})),n.push(this.Ie.updateMetadata(t,r)),tc.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next((function(t){return n.Ae.set(e,t.size),t.document}))},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next((function(t){var e=t.documents;return t.Te.forEach((function(t,e){n.Ae.set(t,e)})),e}))},e}(eh);
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ih(t){return lc(t,Bu.store)}function oh(t){return lc(t,qu.store)}function sh(t){return t.path.toArray()}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ah=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;vo(n<r&&n>=0&&r<=11);var o=new ec("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(Pu.store)}(t),function(t){t.createObjectStore(Fu.store,{keyPath:Fu.keyPath}),t.createObjectStore(Mu.store,{keyPath:Mu.keyPath,autoIncrement:!0}).createIndex(Mu.userMutationsIndex,Mu.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Vu.store)}(t),uh(t),function(t){t.createObjectStore(qu.store)}(t));var s=tc.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(zu.store),t.deleteObjectStore(Ku.store),t.deleteObjectStore(Gu.store)}(t),uh(t)),s=s.next((function(){return function(t){var e=t.store(Gu.store),n=new Gu(0,0,So.min().toTimestamp(),0);return e.put(Gu.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(Mu.store).Nt().next((function(n){t.deleteObjectStore(Mu.store),t.createObjectStore(Mu.store,{keyPath:Mu.keyPath,autoIncrement:!0}).createIndex(Mu.userMutationsIndex,Mu.userMutationsKeyPath,{unique:!0});var r=e.store(Mu.store),i=n.map((function(t){return r.put(t)}));return tc.waitFor(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(Qu.store,{keyPath:Qu.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.Re(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(Bu.store)}(t),i.be(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ve(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.Pe(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(qu.store);e.createIndex(qu.readTimeIndex,qu.readTimeIndexPath,{unique:!1}),e.createIndex(qu.collectionReadTimeIndex,qu.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.Ve(o)}))),n<11&&r>=11&&(s=s.next((function(){!function(t){t.createObjectStore(Wu.store,{keyPath:Wu.keyPath})}(t),function(t){t.createObjectStore($u.store,{keyPath:$u.keyPath})}(t)}))),s},t.prototype.be=function(t){var e=0;return t.store(qu.store).$t((function(t,n){e+=Fc(n)})).next((function(){var n=new Bu(e);return t.store(Bu.store).put(Bu.key,n)}))},t.prototype.Re=function(t){var e=this,n=t.store(Fu.store),r=t.store(Mu.store);return n.Nt().next((function(n){return tc.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(Mu.userMutationsIndex,i).next((function(r){return tc.forEach(r,(function(r){vo(r.userId===n.userId);var i=Ic(e.R,r);return Pc(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ve=function(t){var e=t.store(zu.store),n=t.store(qu.store);return t.store(Gu.store).get(Gu.key).next((function(t){var r=[];return n.$t((function(n,i){var o=new ko(n),s=function(t){return[0,ku(t)]}(o);r.push(e.get(s).next((function(n){return n?tc.resolve():function(n){return e.put(new zu(0,ku(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return tc.waitFor(r)}))}))},t.prototype.Pe=function(t,e){t.createObjectStore(Hu.store,{keyPath:Hu.keyPath});var n=e.store(Hu.store),r=new kc,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:ku(i)})}};return e.store(qu.store).$t({kt:!0},(function(t,e){var n=new ko(t);return i(n.popLast())})).next((function(){return e.store(Vu.store).$t({kt:!0},(function(t,e){t[0];var n=t[1];t[2];var r=Ru(n);return i(r.popLast())}))}))},t.prototype.Ve=function(t){var e=this,n=t.store(Ku.store);return n.$t((function(t,r){var i=Tc(r),o=_c(e.R,i);return n.put(o)}))},t}();function uh(t){t.createObjectStore(zu.store,{keyPath:zu.keyPath}).createIndex(zu.documentTargetsIndex,zu.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Ku.store,{keyPath:Ku.keyPath}).createIndex(Ku.queryTargetsIndexName,Ku.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Gu.store)}var ch="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",hh=function(){function t(e,n,r,i,o,s,a,u,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=s,this.document=a,this.De=c,this.Ce=h,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fe=null,this.inForeground=!1,this.ke=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new uo(ao.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Jc(this,i),this.Le=n+"main",this.R=new yc(u),this.Be=new nc(this.Le,11,new ah(this.R)),this.qe=new Kc(this.referenceDelegate,this.R),this.Ut=new xc,this.Ue=function(t,e){return new nh(t,e)}(this.R,this.Ut),this.Ke=new Ac,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,!1===h&&fo("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new uo(ao.FAILED_PRECONDITION,ch);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.qe.getHighestSequenceNumber(e)}))})).then((function(e){t.Ne=new so(e,t.De)})).then((function(){t.xe=!0})).catch((function(e){return t.Be&&t.Be.close(),Promise.reject(e)}))},t.prototype.He=function(t){var e=this;return this.Me=function(n){return Y(e,void 0,void 0,(function(){return J(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt((function(n){return Y(e,void 0,void 0,(function(){return J(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget((function(){return Y(e,void 0,void 0,(function(){return J(this,(function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return fh(e).put(new Qu(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Je(e).next((function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable((function(){return t.Me(!1)})))}))})).next((function(){return t.Ye(e)})).next((function(n){return t.isPrimary&&!n?t.Xe(e).next((function(){return!1})):!!n&&t.Ze(e).next((function(){return!0}))}))})).catch((function(e){if(oc(e))return lo("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return lo("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Se.enqueueRetryable((function(){return t.Me(e)})),t.isPrimary=e}))},t.prototype.Je=function(t){var e=this;return lh(t).get(Pu.key).next((function(t){return tc.resolve(e.tn(t))}))},t.prototype.en=function(t){return fh(t).delete(this.clientId)},t.prototype.nn=function(){return Y(this,void 0,void 0,(function(){var t,e,n,r,i=this;return J(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=lc(t,Qu.store);return e.Nt().next((function(t){var n=i.rn(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return tc.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.Qe)for(e=0,n=t;e<n.length;e++)r=n[e],this.Qe.removeItem(this.on(r.clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return t.je().then((function(){return t.nn()})).then((function(){return t.ze()}))}))},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?tc.resolve(!0):lh(t).get(Pu.key).next((function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new uo(ao.FAILED_PRECONDITION,ch);return!1}}return!(!e.networkEnabled||!e.inForeground)||fh(t).Nt().next((function(t){return void 0===e.rn(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&lo("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return Y(this,void 0,void 0,(function(){var t=this;return J(this,(function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[Pu.store,Qu.store],(function(e){var n=new hc(e,so.o);return t.Xe(n).next((function(){return t.en(n)}))}))];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}}))}))},t.prototype.rn=function(t,e){var n=this;return t.filter((function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)}))},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return fh(e).Nt().next((function(e){return t.rn(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return Mc.Qt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;lo("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Be.runTransaction(t,o,Xu,(function(o){return i=new hc(o,r.Ne?r.Ne.next():so.o),"readwrite-primary"===e?r.Je(i).next((function(t){return!!t||r.Ye(i)})).next((function(e){if(!e)throw fo("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Se.enqueueRetryable((function(){return r.Me(!1)})),new uo(ao.FAILED_PRECONDITION,Yu);return n(i)})).next((function(t){return r.Ze(i).next((function(){return t}))})):r.dn(i).next((function(){return n(i)}))})).then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.dn=function(t){var e=this;return lh(t).get(Pu.key).next((function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new uo(ao.FAILED_PRECONDITION,ch)}))},t.prototype.Ze=function(t){var e=new Pu(this.clientId,this.allowTabSynchronization,Date.now());return lh(t).put(Pu.key,e)},t.yt=function(){return nc.yt()},t.prototype.Xe=function(t){var e=this,n=lh(t);return n.get(Pu.key).next((function(t){return e.tn(t)?(lo("IndexedDbPersistence","Releasing primary lease."),n.delete(Pu.key)):tc.resolve()}))},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(fo("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ke=function(){t.Se.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.je()}))},this.document.addEventListener("visibilitychange",this.ke),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.ke&&(this.document.removeEventListener("visibilitychange",this.ke),this.ke=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Fe=function(){e.un(),!st()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")&&navigator.appVersion.match("Version/14")&&e.Se.enterRestrictedMode(!0),e.Se.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("pagehide",this.Fe))},t.prototype.hn=function(){this.Fe&&(this.window.removeEventListener("pagehide",this.Fe),this.Fe=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Qe)||void 0===e?void 0:e.getItem(this.on(t)));return lo("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return fo("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.un=function(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),String(Date.now()))}catch(t){fo("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function lh(t){return lc(t,Pu.store)}function fh(t){return lc(t,Qu.store)}function ph(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var dh=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.yn(t,e,r)}))},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next((function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t}))},t.prototype.gn=function(t,e){t.forEach((function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)}))},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next((function(e){return n.En(t,e).next((function(){return e}))}))},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(t){return n.gn(e,t)}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return Go.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):Fs(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new Go(e)).next((function(t){var e=Ma();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=Ma();return this.Ut.getCollectionParents(t,i).next((function(s){return tc.forEach(s,(function(s){var a=function(t,e){return new Cs(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.An(t,a,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return i=e,o.Rn(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,h=r.get(c);null==h&&(h=us.newInvalidDocument(c),r=r.insert(c,h)),pa(u,h,o.localWriteTime),h.isFoundDocument()||(r=r.remove(c))}}))})).next((function(){return r.forEach((function(t,n){Ks(e,n)||(r=r.remove(t))})),r}))},t.prototype.Rn=function(t,e,n){for(var r=ja(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof ma&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next((function(t){return t.forEach((function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))})),c}))},t}(),yh=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=ja(),i=ja(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),gh=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(So.min())?this.Dn(t,e):this.Sn.pn(t,r).next((function(o){var s=i.Cn(e,o);return(Os(e)||Rs(e))&&i.Nn(e.limitType,s,r,n)?i.Dn(t,e):(ho()<=It.DEBUG&&lo("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Bs(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next((function(t){return s.forEach((function(e){t=t.insert(e.key,e)})),t})))}))},t.prototype.Cn=function(t,e){var n=new Oa(zs(t));return e.forEach((function(e,r){Ks(t,r)&&(n=n.add(r))})),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return ho()<=It.DEBUG&&lo("QueryEngine","Using full collection scan to execute query:",Bs(e)),this.Sn.getDocumentsMatchingQuery(t,e,So.min())},t}(),vh=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.Fn=new Ca(Eo),this.kn=new th((function(t){return ls(t)}),fs),this.$n=So.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new dh(this.On,this._n,this.persistence.getIndexManager()),this.Ke=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.collect(n,e.Fn)}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function mh(t,e,n,r){return new vh(t,e,n,r)}function bh(t,e){return Y(this,void 0,void 0,(function(){var n,r,i,o;return J(this,(function(s){switch(s.label){case 0:return n=mo(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n._n.getAllMutationBatches(t).next((function(s){return o=s,r=n.persistence.getMutationQueue(e),i=new dh(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)})).next((function(e){for(var n=[],r=[],s=ja(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++){var f=l[h];s=s.add(f.key)}}for(var p=0,d=e;p<d.length;p++){var y=d[p];r.push(y.batchId);for(var g=0,v=y.mutations;g<v.length;g++){var m=v[g];s=s.add(m.key)}}return i.pn(t,s).next((function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}}))}))}))];case 1:return o=s.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}}))}))}function wh(t,e){var n=mo(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=tc.resolve();return o.forEach((function(t){s=s.next((function(){return r.getEntry(e,t)})).next((function(e){var o=n.docVersions.get(t);vo(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))}))})),s.next((function(){return t._n.removeMutationBatch(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}function Eh(t){var e=mo(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.qe.getLastRemoteSnapshotVersion(t)}))}function Ih(t,e){var n=mo(t),r=e.snapshotVersion,i=n.Fn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.Fn;var s=[];e.targetChanges.forEach((function(e,o){var a=i.get(o);if(a){s.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next((function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)})));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=a.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return vo(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,c,e)&&s.push(n.qe.updateTargetData(t,c))}}}));var a=Pa();if(e.documentUpdates.forEach((function(r,i){e.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),s.push(function(t,e,n,r,i){var o=ja();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=Pa();return n.forEach((function(n,s){var a=t.get(n),u=(null==i?void 0:i.get(n))||r;s.isNoDocument()&&s.version.isEqual(So.min())?(e.removeEntry(n,u),o=o.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(s,u),o=o.insert(n,s)):lo("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)})),o}))}(t,o,e.documentUpdates,r,void 0).next((function(t){a=t}))),!r.isEqual(So.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next((function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)}));s.push(u)}return tc.waitFor(s).next((function(){return o.apply(t)})).next((function(){return n.Mn.En(t,a)})).next((function(){return a}))})).then((function(t){return n.Fn=i,t}))}function Th(t,e){var n=mo(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)}))}function _h(t,e){var n=mo(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.qe.getTargetData(t,e).next((function(i){return i?(r=i,tc.resolve(r)):n.qe.allocateTargetId(t).next((function(i){return r=new dc(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.Fn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fn=n.Fn.insert(t.targetId,t),n.kn.set(e,t.targetId)),t}))}function Sh(t,e,n){return Y(this,void 0,void 0,(function(){var r,i,o,s;return J(this,(function(a){switch(a.label){case 0:r=mo(t),i=r.Fn.get(e),o=n?"readwrite":"readwrite-primary",a.label=1;case 1:return a.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.referenceDelegate.removeTarget(t,i)}))];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if(!oc(s=a.sent()))throw s;return lo("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.Fn=r.Fn.remove(e),r.kn.delete(i.target),[2]}}))}))}function Ah(t,e,n){var r=mo(t),i=So.min(),o=ja();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=mo(t),i=r.kn.get(n);return void 0!==i?tc.resolve(r.Fn.get(i)):r.qe.getTargetData(e,n)}(r,t,Vs(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:So.min(),n?o:ja())})).next((function(t){return{documents:t,Bn:o}}))}))}function Nh(t,e){var n=mo(t),r=mo(n.qe),i=n.Fn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.lt(t,e).next((function(t){return t?t.target:null}))}))}function Dh(t){var e=mo(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=mo(t),i=Pa(),o=mc(n),s=oh(e),a=IDBKeyRange.lowerBound(o,!0);return s.$t({index:qu.readTimeIndex,range:a},(function(t,e){var n=gc(r.R,e);i=i.insert(n.key,n),o=e.readTime})).next((function(){return{wn:i,readTime:bc(o)}}))}(e.On,t,e.$n)})).then((function(t){var n=t.wn,r=t.readTime;return e.$n=r,n}))}function Ch(t){return Y(this,void 0,void 0,(function(){var e;return J(this,(function(n){return[2,(e=mo(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=oh(t),n=So.min();return e.$t({index:qu.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=bc(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.$n=t}))]}))}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var kh=function(){function t(t){this.R=t,this.Qn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return tc.resolve(this.Qn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Qn.set(e.id,{id:(n=e).id,version:n.version,createTime:iu(n.createTime)}),tc.resolve()},t.prototype.getNamedQuery=function(t,e){return tc.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:Sc(t.bundledQuery),readTime:iu(t.readTime)}}(e)),tc.resolve()},t}(),xh=function(){function t(){this.Wn=new Oa(Oh.Gn),this.zn=new Oa(Oh.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new Oh(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},t.prototype.removeReference=function(t,e){this.Yn(new Oh(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},t.prototype.Zn=function(t){var e=this,n=new Go(new ko([])),r=new Oh(n,t),i=new Oh(n,t+1),o=[];return this.zn.forEachInRange([r,i],(function(t){e.Yn(t),o.push(t.key)})),o},t.prototype.ts=function(){var t=this;this.Wn.forEach((function(e){return t.Yn(e)}))},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new Go(new ko([])),n=new Oh(e,t),r=new Oh(e,t+1),i=ja();return this.zn.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.containsKey=function(t){var e=new Oh(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),Oh=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return Go.comparator(t.key,e.key)||Eo(t.ns,e.ns)},t.Hn=function(t,e){return Eo(t.ns,e.ns)||Go.comparator(t.key,e.key)},t}(),Rh=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new Oa(Oh.Gn)}return t.prototype.checkEmpty=function(t){return tc.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];var o=new fc(i,e,n,r);this._n.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.rs=this.rs.add(new Oh(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return tc.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return tc.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.cs(n),i=r<0?0:r;return tc.resolve(this._n.length>i?this._n[i]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return tc.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return tc.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new Oh(e,0),i=new Oh(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],(function(t){var e=n.os(t.ns);o.push(e)})),tc.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Oa(Eo);return e.forEach((function(t){var e=new Oh(t,0),i=new Oh(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],(function(t){r=r.add(t.ns)}))})),tc.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;Go.isDocumentKey(i)||(i=i.child(""));var o=new Oh(new Go(i),0),s=new Oa(Eo);return this.rs.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(s=s.add(t.ns)),!0)}),o),tc.resolve(this.us(s))},t.prototype.us=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.os(t);null!==r&&n.push(r)})),n},t.prototype.removeMutationBatch=function(t,e){var n=this;vo(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return tc.forEach(e.mutations,(function(i){var o=new Oh(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((function(){n.rs=r}))},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new Oh(e,0),r=this.rs.firstAfterOrEqual(n);return tc.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return this._n.length,tc.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),Lh=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new Ca(Go.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:s,readTime:n}),this.size+=s-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return tc.resolve(n?n.document.clone():us.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=Pa();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():us.newInvalidDocument(t))})),tc.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=Pa(),i=new Go(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.key,u=s.value,c=u.document,h=u.readTime;if(!e.path.isPrefixOf(a.path))break;h.compareTo(n)<=0||Ks(e,c)&&(r=r.insert(c.key,c.clone()))}return tc.resolve(r)},t.prototype.fs=function(t,e){return tc.forEach(this.docs,(function(t){return e(t)}))},t.prototype.newChangeBuffer=function(t){return new Ph(this)},t.prototype.getSize=function(t){return tc.resolve(this.size)},t}(),Ph=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return $(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)})),tc.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(eh),Fh=function(){function t(t){this.persistence=t,this.ds=new th((function(t){return ls(t)}),fs),this.lastRemoteSnapshotVersion=So.min(),this.highestTargetId=0,this.ws=0,this._s=new xh,this.targetCount=0,this.ys=Bc.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach((function(t,n){return e(n)})),tc.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return tc.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return tc.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),tc.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),tc.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new Bc(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,tc.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),tc.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,tc.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach((function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.ds.delete(s),o.push(r.removeMatchingKeysForTargetId(t,a.targetId)),i++)})),tc.waitFor(o).next((function(){return i}))},t.prototype.getTargetCount=function(t){return tc.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return tc.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),tc.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.markPotentiallyOrphaned(t,e))})),tc.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),tc.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return tc.resolve(n)},t.prototype.containsKey=function(t,e){return tc.resolve(this._s.containsKey(e))},t}(),Mh=function(){function t(t,e){var n=this;this.gs={},this.Ne=new so(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new Fh(this),this.Ut=new Cc,this.Ue=function(t,e){return new Lh(t,(function(t){return n.referenceDelegate.ps(t)}))}(this.Ut),this.R=new yc(e),this.Ke=new kh(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new Rh(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;lo("MemoryPersistence","Starting transaction:",t);var i=new Vh(this.Ne.next());return this.referenceDelegate.Es(),n(i).next((function(t){return r.referenceDelegate.Ts(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.Is=function(t,e){return tc.or(Object.values(this.gs).map((function(n){return function(){return n.containsKey(t,e)}})))},t}(),Vh=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return $(e,t),e}(Ju),Uh=function(){function t(t){this.persistence=t,this.As=new xh,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw go()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),tc.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),tc.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),tc.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach((function(t){return n.vs.add(t.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.vs.add(t.toString())}))})).next((function(){return r.removeTargetData(t,e)}))},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return tc.forEach(this.vs,(function(r){var i=Go.fromPath(r);return e.Ps(t,i).next((function(t){t||n.removeEntry(i)}))})).next((function(){return e.Rs=null,n.apply(t)}))},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next((function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())}))},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return tc.or([function(){return tc.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),jh=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function qh(t,e){return"firestore_clients_"+t+"_"+e}function Bh(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function Kh(t,e){return"firestore_targets_"+t+"_"+e}jh.UNAUTHENTICATED=new jh(null),jh.GOOGLE_CREDENTIALS=new jh("google-credentials-uid"),jh.FIRST_PARTY=new jh("first-party-uid");var zh=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new uo(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(fo("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Gh=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new uo(i.error.code,i.error.message)),o?new t(e,i.state,r):(fo("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Hh=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Ba(),s=0;i&&s<r.activeTargetIds.length;++s)i=zo(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(fo("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Qh=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(fo("SharedClientState","Failed to parse online state: "+e),null)},t}(),Wh=function(){function t(){this.activeTargetIds=Ba()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),$h=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.Fs.bind(this),this.ks=new Ca(Eo),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=qh(this.persistenceKey,this.Ns),this.Ms=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.ks=this.ks.insert(this.Ns,new Wh),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Ks=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Y(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,a,u,c,h,l=this;return J(this,(function(f){switch(f.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(qh(this.persistenceKey,r)))&&(o=Hh.Vs(r,i))&&(this.ks=this.ks.insert(o.clientId,o));for(this.Qs(),(s=this.storage.getItem(this.Us))&&(a=this.js(s))&&this.Ws(a),u=0,c=this.$s;u<c.length;u++)h=c[u],this.Fs(h);return this.$s=[],this.window.addEventListener("pagehide",(function(){return l.shutdown()})),this.started=!0,[2]}}))}))},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.ks)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.ks.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(Kh(this.persistenceKey,t));if(n){var r=Gh.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Qs(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Qs()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(Kh(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.Hs(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return lo("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){lo("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){lo("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Fs=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(lo("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void fo("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable((function(){return Y(e,void 0,void 0,(function(){var t,e,r,i,o,s;return J(this,(function(a){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(s=function(t){var e=so.o;if(null!=t)try{var n=JSON.parse(t);vo("number"==typeof n),e=n}catch(t){fo("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==so.o&&this.sequenceNumberHandler(s);else if(n.key===this.Ks)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.ks.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Qs=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new zh(this.currentUser,t,e,n),i=Bh(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=Bh(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){var e={clientId:this.Ns,onlineState:t};this.storage.setItem(this.Us,JSON.stringify(e))},t.prototype.Ys=function(t,e,n){var r=Kh(this.persistenceKey,t),i=new Gh(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Ks,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return Hh.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return zh.Vs(new jh(i),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return Gh.Vs(r,e)},t.prototype.js=function(t){return Qh.Vs(t)},t.prototype.ii=function(t){return Y(this,void 0,void 0,(function(){return J(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(lo("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.ks.insert(t,e):this.ks.remove(t),i=this.Gs(this.ks),o=this.Gs(r),s=[],a=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||a.push(t)})),this.syncEngine.hi(s,a).then((function(){n.ks=r}))},t.prototype.Ws=function(t){this.ks.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=Ba();return t.forEach((function(t,n){e=e.unionWith(n.activeTargetIds)})),e},t}(),Xh=function(){function t(){this.li=new Wh,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new Wh,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),Yh=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),Jh=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){lo("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){lo("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Zh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},tl=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),el=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n.useFetchStreams=e.useFetchStreams,n}return $(e,t),e.prototype.ki=function(t,e,n,r){return new Promise((function(i,o){var s=new oo;s.listenOnce(Zi.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case Ji.NO_ERROR:var e=s.getResponseJson();lo("Connection","XHR received:",JSON.stringify(e)),i(e);break;case Ji.TIMEOUT:lo("Connection",'RPC "'+t+'" timed out'),o(new uo(ao.DEADLINE_EXCEEDED,"Request time out"));break;case Ji.HTTP_ERROR:var n=s.getStatus();if(lo("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(ao).indexOf(e)>=0?e:ao.UNKNOWN}(r.status);o(new uo(a,r.message))}else o(new uo(ao.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new uo(ao.UNAVAILABLE,"Connection failed."));break;default:go()}}finally{lo("Connection",'RPC "'+t+'" completed.')}}));var a=JSON.stringify(r);s.send(e,"POST",a,n,15)}))},e.prototype.Oi=function(t,e){var n,r=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new Qi,o=jn(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(s.xmlHttpFactory=new ro({})),this.Fi(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ot())||"object"==typeof navigator&&"ReactNative"===navigator.product||ot().indexOf("Electron/")>=0||function(){var t=ot();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()||ot().indexOf("MSAppHost/")>=0||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var a=r.join("");lo("Connection","Creating WebChannel: "+a,s);var u=i.createWebChannel(a,s),c=!1,h=!1,l=new tl({Ei:function(t){h?lo("Connection","Not sending because WebChannel is closed:",t):(c||(lo("Connection","Opening WebChannel transport."),u.open(),c=!0),lo("Connection","WebChannel sending:",t),u.send(t))},Ti:function(){return u.close()}}),f=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return f(u,io.EventType.OPEN,(function(){h||lo("Connection","WebChannel transport opened.")})),f(u,io.EventType.CLOSE,(function(){h||(h=!0,lo("Connection","WebChannel transport closed"),l.Vi())})),f(u,io.EventType.ERROR,(function(t){h||(h=!0,po("Connection","WebChannel transport errored:",t),l.Vi(new uo(ao.UNAVAILABLE,"The operation could not be completed")))})),f(u,io.EventType.MESSAGE,(function(t){var e;if(!h){var n=t.data[0];vo(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){lo("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=Ia[t];if(void 0!==e)return Da(e)}(o),a=i.message;void 0===s&&(s=ao.INTERNAL,a="Unknown error status: "+o+" with message "+i.message),h=!0,l.Vi(new uo(s,a)),u.close()}else lo("Connection","WebChannel received:",n),l.Si(n)}})),f(o,to.STAT_EVENT,(function(t){t.stat===eo?lo("Connection","Detected buffering proxy"):t.stat===no&&lo("Connection","Detected no buffering proxy")})),setTimeout((function(){l.Pi()}),0),l},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.Di=e+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);lo("RestConnection","Sending: ",i,n);var o={};return this.Fi(o,r),this.ki(t,i,o,n).then((function(t){return lo("RestConnection","Received: ",t),t}),(function(e){throw po("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.Fi=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.8.0",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){var n=Zh[t];return this.Di+"/v1/"+e+":"+n},t}());
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function nl(){return"undefined"!=typeof window?window:null}function rl(){return"undefined"!=typeof document?document:null}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function il(t){return new tu(t,!0)}var ol=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Ki=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Qi=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Ki),i=Math.max(0,n-r);i>0&&lo("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,(function(){return e.Ki=Date.now(),t()})),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),sl=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new ol(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return Y(this,void 0,void 0,(function(){return J(this,(function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,(function(){return t.rr()})))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return Y(this,void 0,void 0,(function(){return J(this,(function(t){return this.er()?[2,this.close(0)]:[2]}))}))},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return Y(this,void 0,void 0,(function(){return J(this,(function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===ao.RESOURCE_EXHAUSTED?(fo(e.toString()),fo("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Qi()):e&&e.code===ao.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then((function(e){t.Yi===n&&t.lr(e)}),(function(n){e((function(){var e=new uo(ao.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)}))}))},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii((function(){n((function(){return e.state=2,e.listener.Ii()}))})),this.stream.Ri((function(t){n((function(){return e.dr(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji((function(){return Y(t,void 0,void 0,(function(){return J(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.dr=function(t){return lo("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget((function(){return e.Yi===t?n():(lo("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),al=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,s}return $(e,t),e.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:go()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(vo(void 0===e||"string"==typeof e),Lo.fromBase64String(e||"")):(vo(void 0===e||e instanceof Uint8Array),Lo.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(a=e.targetChange.cause)&&function(t){var e=void 0===t.code?ao.UNKNOWN:Da(t.code);return new uo(e,t.message||"")}(a);n=new Qa(r,i,o,s||null)}else if("documentChange"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=uu(t,r.document.name),o=iu(r.document.updateTime);var a=new ss({mapValue:{fields:r.document.fields}}),u=(s=us.newFoundDocument(i,o,a),r.targetIds||[]),c=r.removedTargetIds||[];n=new Ga(u,c,s.key,s)}else if("documentDelete"in e)e.documentDelete,(r=e.documentDelete).document,i=uu(t,r.document),o=r.readTime?iu(r.readTime):So.min(),a=us.newNoDocument(i,o),s=r.removedTargetIds||[],n=new Ga([],s,a.key,a);else if("documentRemove"in e)e.documentRemove,(r=e.documentRemove).document,i=uu(t,r.document),o=r.removedTargetIds||[],n=new Ga([],o,i,null);else{if(!("filter"in e))return go();e.filter;var h=e.filter;h.targetId,r=h.count||0,i=new Aa(r),o=h.targetId,n=new Ha(o,i)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return So.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?So.min():e.readTime?iu(e.readTime):So.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={};e.database=lu(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=ps(r)?{documents:gu(t,r)}:{query:vu(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=nu(t,e.resumeToken):e.snapshotVersion.compareTo(So.min())>0&&(n.readTime=eu(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return go()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.R,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=lu(this.R),e.removeTarget=t,this.cr(e)},e}(sl),ul=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,s.gr=!1,s}return $(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.Oi("Write",t)},e.prototype.onMessage=function(t){if(vo(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?(vo(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?iu(t.updateTime):iu(e);return n.isEqual(So.min())&&(n=iu(e)),new ua(n,t.transformResults||[])}(t,e)}))):[]}(t.writeResults,t.commitTime),n=iu(t.commitTime);return this.listener.Tr(n,e)}return vo(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=lu(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return du(e.R,t)}))};this.cr(n)},e}(sl),cl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return $(e,t),e.prototype.br=function(){if(this.Rr)throw new uo(ao.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Ni(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===ao.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new uo(ao.UNKNOWN,t.toString())}))},e.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.$i(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===ao.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new uo(ao.UNKNOWN,t.toString())}))},e.prototype.terminate=function(){this.Rr=!0},e}((function(){})),hl=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()})))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.Fr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.Fr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(fo(e),this.Vr=!1):lo("OnlineStateTracker",e)},t.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),ll=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di((function(t){n.enqueueAndForget((function(){return Y(o,void 0,void 0,(function(){return J(this,(function(t){switch(t.label){case 0:return wl(this)?(lo("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Y(this,void 0,void 0,(function(){var e;return J(this,(function(n){switch(n.label){case 0:return(e=mo(t)).Or.add(4),[4,pl(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,fl(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Br=new hl(n,r)};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function fl(t){return Y(this,void 0,void 0,(function(){var e,n;return J(this,(function(r){switch(r.label){case 0:if(!wl(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function pl(t){return Y(this,void 0,void 0,(function(){var e,n;return J(this,(function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function dl(t,e){var n=mo(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),bl(n)?ml(n):Pl(n).er()&&gl(n,e))}function yl(t,e){var n=mo(t),r=Pl(n);n.$r.delete(e),r.er()&&vl(n,e),0===n.$r.size&&(r.er()?r.ir():wl(n)&&n.Br.set("Unknown"))}function gl(t,e){t.qr.U(e.targetId),Pl(t).mr(e)}function vl(t,e){t.qr.U(e),Pl(t).yr(e)}function ml(t){t.qr=new $a({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),Pl(t).start(),t.Br.Sr()}function bl(t){return wl(t)&&!Pl(t).tr()&&t.$r.size>0}function wl(t){return 0===mo(t).Or.size}function El(t){t.qr=void 0}function Il(t){return Y(this,void 0,void 0,(function(){return J(this,(function(e){return t.$r.forEach((function(e,n){gl(t,e)})),[2]}))}))}function Tl(t,e){return Y(this,void 0,void 0,(function(){return J(this,(function(n){return El(t),bl(t)?(t.Br.Nr(e),ml(t)):t.Br.set("Unknown"),[2]}))}))}function _l(t,e,n){return Y(this,void 0,void 0,(function(){var r,i,o;return J(this,(function(s){switch(s.label){case 0:if(t.Br.set("Online"),!(e instanceof Qa&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Y(this,void 0,void 0,(function(){var n,r,i,o;return J(this,(function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?(o=i[r],t.$r.has(o)?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]):[3,5];case 2:s.sent(),t.$r.delete(o),t.qr.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),lo("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,Sl(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Ga?t.qr.X(e):e instanceof Ha?t.qr.rt(e):t.qr.et(e),n.isEqual(So.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,Eh(t.localStore)];case 8:return i=s.sent(),n.compareTo(i)>=0?[4,function(t,e){var n=t.qr.ut(e);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.$r.get(r);i&&t.$r.set(r,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((function(e){var n=t.$r.get(e);if(n){t.$r.set(e,n.withResumeToken(Lo.EMPTY_BYTE_STRING,n.snapshotVersion)),vl(t,e);var r=new dc(n.target,e,1,n.sequenceNumber);gl(t,r)}})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return lo("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,Sl(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}}))}))}function Sl(t,e,n){return Y(this,void 0,void 0,(function(){var r=this;return J(this,(function(i){switch(i.label){case 0:if(!oc(e))throw e;return t.Or.add(1),[4,pl(t)];case 1:return i.sent(),t.Br.set("Offline"),n||(n=function(){return Eh(t.localStore)}),t.asyncQueue.enqueueRetryable((function(){return Y(r,void 0,void 0,(function(){return J(this,(function(e){switch(e.label){case 0:return lo("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,fl(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function Al(t,e){return e().catch((function(n){return Sl(t,n,e)}))}function Nl(t){return Y(this,void 0,void 0,(function(){var e,n,r,i,o;return J(this,(function(s){switch(s.label){case 0:e=mo(t),n=Fl(e),r=e.kr.length>0?e.kr[e.kr.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return wl(t)&&t.kr.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,Th(e.localStore,r)];case 3:return null===(i=s.sent())?(0===e.kr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.kr.push(e);var n=Fl(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,Sl(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return Dl(e)&&Cl(e),[2]}}))}))}function Dl(t){return wl(t)&&!Fl(t).tr()&&t.kr.length>0}function Cl(t){Fl(t).start()}function kl(t){return Y(this,void 0,void 0,(function(){return J(this,(function(e){return Fl(t).Ar(),[2]}))}))}function xl(t){return Y(this,void 0,void 0,(function(){var e,n,r,i;return J(this,(function(o){for(e=Fl(t),n=0,r=t.kr;n<r.length;n++)i=r[n],e.Er(i.mutations);return[2]}))}))}function Ol(t,e,n){return Y(this,void 0,void 0,(function(){var r,i;return J(this,(function(o){switch(o.label){case 0:return r=t.kr.shift(),i=pc.from(r,e,n),[4,Al(t,(function(){return t.remoteSyncer.applySuccessfulWrite(i)}))];case 1:return o.sent(),[4,Nl(t)];case 2:return o.sent(),[2]}}))}))}function Rl(t,e){return Y(this,void 0,void 0,(function(){return J(this,(function(n){switch(n.label){case 0:return e&&Fl(t).pr?[4,function(t,e){return Y(this,void 0,void 0,(function(){var n,r;return J(this,(function(i){switch(i.label){case 0:return Na(r=e.code)&&r!==ao.ABORTED?(n=t.kr.shift(),Fl(t).sr(),[4,Al(t,(function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,Nl(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Dl(t)&&Cl(t),[2]}}))}))}function Ll(t,e){return Y(this,void 0,void 0,(function(){var n;return J(this,(function(r){switch(r.label){case 0:return n=mo(t),e?(n.Or.delete(2),[4,fl(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,pl(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function Pl(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=mo(t);return r.br(),new al(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:Il.bind(null,t),Ri:Tl.bind(null,t),_r:_l.bind(null,t)}),t.Mr.push((function(n){return Y(e,void 0,void 0,(function(){return J(this,(function(e){switch(e.label){case 0:return n?(t.Ur.sr(),bl(t)?ml(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),El(t),e.label=3;case 3:return[2]}}))}))}))),t.Ur}function Fl(t){var e=this;return t.Kr||(t.Kr=function(t,e,n){var r=mo(t);return r.br(),new ul(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:kl.bind(null,t),Ri:Rl.bind(null,t),Ir:xl.bind(null,t),Tr:Ol.bind(null,t)}),t.Mr.push((function(n){return Y(e,void 0,void 0,(function(){return J(this,(function(e){switch(e.label){case 0:return n?(t.Kr.sr(),[4,Nl(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kr.stop()];case 3:e.sent(),t.kr.length>0&&(lo("RemoteStore","Stopping write stream with "+t.kr.length+" pending writes"),t.kr=[]),e.label=4;case 4:return[2]}}))}))}))),t.Kr
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var Ml=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Zu,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t.createAndSchedule=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new uo(ao.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function Vl(t,e){if(fo("AsyncQueue",e+": "+t),oc(t))return new uo(ao.UNAVAILABLE,e+": "+t);throw t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ul=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||Go.comparator(e.key,n.key)}:function(t,e){return Go.comparator(t.key,e.key)},this.keyedMap=Ma(),this.sortedSet=new Ca(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),jl=function(){function t(){this.Qr=new Ca(Go.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Qr.get(e);n?0!==t.type&&3===n.type?this.Qr=this.Qr.insert(e,t):3===t.type&&1!==n.type?this.Qr=this.Qr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Qr=this.Qr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Qr=this.Qr.remove(e):1===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):go():this.Qr=this.Qr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Qr.inorderTraversal((function(e,n){t.push(n)})),t},t}(),ql=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,Ul.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&js(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Bl=function(){this.Wr=void 0,this.listeners=[]},Kl=function(){this.queries=new th((function(t){return qs(t)}),js),this.onlineState="Unknown",this.Gr=new Set};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function zl(t,e){return Y(this,void 0,void 0,(function(){var n,r,i,o,s,a,u;return J(this,(function(c){switch(c.label){case 0:if(n=mo(t),r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new Bl),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.onListen(r)];case 2:return s.Wr=c.sent(),[3,4];case 3:return a=c.sent(),u=Vl(a,"Initialization of query '"+Bs(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&Wl(n),[2]}}))}))}function Gl(t,e){return Y(this,void 0,void 0,(function(){var n,r,i,o,s;return J(this,(function(a){return n=mo(t),r=e.query,i=!1,(o=n.queries.get(r))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]}))}))}function Hl(t,e){for(var n=mo(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=s.query,u=n.queries.get(a);if(u){for(var c=0,h=u.listeners;c<h.length;c++)h[c].Hr(s)&&(r=!0);u.Wr=s}}r&&Wl(n)}function Ql(t,e,n){var r=mo(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function Wl(t){t.Gr.forEach((function(t){t.next()}))}var $l=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new ql(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.so&&n||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){if(t.docChanges.length>0)return!0;var e=this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=ql.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),Xl=function(t){this.key=t},Yl=function(t){this.key=t},Jl=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=ja(),this.mutatedKeys=ja(),this.lo=zs(t),this.fo=new Ul(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new jl,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=Os(this.query)&&i.size===this.query.limit?i.last():null,c=Rs(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var h=i.get(t),l=Ks(n.query,e)?e:null,f=!!h&&n.mutatedKeys.has(h.key),p=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),d=!1;h&&l?h.data.isEqual(l.data)?f!==p&&(r.track({type:3,doc:l}),d=!0):n.yo(h,l)||(r.track({type:2,doc:l}),d=!0,(u&&n.lo(l,u)>0||c&&n.lo(l,c)<0)&&(a=!0)):!h&&l?(r.track({type:0,doc:l}),d=!0):h&&!l&&(r.track({type:1,doc:h}),d=!0,(u||c)&&(a=!0)),d&&(l?(s=s.add(l),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),Os(this.query)||Rs(this.query))for(;s.size>this.query.limit;){var h=Os(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{fo:s,mo:r,Nn:a,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return go()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)})),this.po(n);var s=e?this.Eo():[],a=0===this.ho.size&&this.current?1:0,u=a!==this.ao;return this.ao=a,0!==o.length||u?{snapshot:new ql(this.query,t.fo,i,o,t.mutatedKeys,0===a,u,!1),To:s}:{To:s}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new jl,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e.uo=e.uo.add(t)})),t.modifiedDocuments.forEach((function(t){})),t.removedDocuments.forEach((function(t){return e.uo=e.uo.delete(t)})),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=ja(),this.fo.forEach((function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))}));var n=[];return e.forEach((function(e){t.ho.has(e)||n.push(new Yl(e))})),this.ho.forEach((function(t){e.has(t)||n.push(new Xl(t))})),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=ja();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return ql.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),Zl=function(t,e,n){this.query=t,this.targetId=e,this.view=n},tf=function(t){this.key=t,this.bo=!1},ef=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new th((function(t){return qs(t)}),js),this.Vo=new Map,this.So=new Set,this.Do=new Ca(Go.comparator),this.Co=new Map,this.No=new xh,this.xo={},this.Fo=new Map,this.ko=Bc.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function nf(t,e){return Y(this,void 0,void 0,(function(){var n,r,i,o,s,a;return J(this,(function(u){switch(u.label){case 0:return n=Of(t),(o=n.Po.get(e))?(r=o.targetId,n.sharedClientState.addLocalQueryTarget(r),i=o.view.Ro(),[3,4]):[3,1];case 1:return[4,_h(n.localStore,Vs(e))];case 2:return s=u.sent(),a=n.sharedClientState.addLocalQueryTarget(s.targetId),r=s.targetId,[4,rf(n,e,r,"current"===a)];case 3:i=u.sent(),n.isPrimaryClient&&dl(n.remoteStore,s),u.label=4;case 4:return[2,i]}}))}))}function rf(t,e,n,r){return Y(this,void 0,void 0,(function(){var i,o,s,a,u,c;return J(this,(function(h){switch(h.label){case 0:return t.Oo=function(e,n,r){return function(t,e,n,r){return Y(this,void 0,void 0,(function(){var i,o,s;return J(this,(function(a){switch(a.label){case 0:return(i=e.view._o(n)).Nn?[4,Ah(t.localStore,e.query,!1).then((function(t){var n=t.documents;return e.view._o(n,i)}))]:[3,2];case 1:i=a.sent(),a.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),s=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(vf(t,e.targetId,s.To),s.snapshot)]}}))}))}(t,e,n,r)},[4,Ah(t.localStore,e,!0)];case 1:return i=h.sent(),o=new Jl(e,i.Bn),s=o._o(i.documents),a=za.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),u=o.applyChanges(s,t.isPrimaryClient,a),vf(t,n,u.To),c=new Zl(e,n,o),[2,(t.Po.set(e,c),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),u.snapshot)]}}))}))}function of(t,e){return Y(this,void 0,void 0,(function(){var n,r,i;return J(this,(function(o){switch(o.label){case 0:return n=mo(t),r=n.Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter((function(t){return!js(t,e)}))),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,Sh(n.localStore,r.targetId,!1).then((function(){n.sharedClientState.clearQueryState(r.targetId),yl(n.remoteStore,r.targetId),yf(n,r.targetId)})).catch(Qc)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return yf(n,r.targetId),[4,Sh(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function sf(t,e,n){return Y(this,void 0,void 0,(function(){var r,i,o,s;return J(this,(function(a){switch(a.label){case 0:r=Rf(t),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,function(t,e){var n,r=mo(t),i=_o.now(),o=e.reduce((function(t,e){return t.add(e.key)}),ja());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Mn.pn(t,o).next((function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var c=u[a],h=da(c,n.get(c.key));null!=h&&s.push(new ma(c.key,h,as(h.value.mapValue),ca.exists(!0)))}return r._n.addMutationBatch(t,i,s,e)}))})).then((function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}}))}(r.localStore,e)];case 2:return i=a.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new Ca(Eo)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,wf(r,i.changes)];case 3:return a.sent(),[4,Nl(r.remoteStore)];case 4:return a.sent(),[3,6];case 5:return o=a.sent(),s=Vl(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}}))}))}function af(t,e){return Y(this,void 0,void 0,(function(){var n,r;return J(this,(function(i){switch(i.label){case 0:n=mo(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Ih(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach((function(t,e){var r=n.Co.get(e);r&&(vo(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?vo(r.bo):t.removedDocuments.size>0&&(vo(r.bo),r.bo=!1))})),[4,wf(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Qc(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function uf(t,e,n){var r=mo(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach((function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=mo(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)})),r&&Wl(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function cf(t,e,n){return Y(this,void 0,void 0,(function(){var r,i,o,s,a,u;return J(this,(function(c){switch(c.label){case 0:return(r=mo(t)).sharedClientState.updateQueryState(e,"rejected",n),i=r.Co.get(e),(o=i&&i.key)?(s=(s=new Ca(Go.comparator)).insert(o,us.newNoDocument(o,So.min())),a=ja().add(o),u=new Ka(So.min(),new Map,new Oa(Eo),s,a),[4,af(r,u)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),bf(r),[3,4];case 2:return[4,Sh(r.localStore,e,!1).then((function(){return yf(r,e,n)})).catch(Qc)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function hf(t,e){return Y(this,void 0,void 0,(function(){var n,r,i;return J(this,(function(o){switch(o.label){case 0:n=mo(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,wh(n.localStore,e)];case 2:return i=o.sent(),df(n,r,null),pf(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,wf(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Qc(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function lf(t,e,n){return Y(this,void 0,void 0,(function(){var r,i;return J(this,(function(o){switch(o.label){case 0:r=mo(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=mo(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n._n.lookupMutationBatch(t,e).next((function(e){return vo(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}(r.localStore,e)];case 2:return i=o.sent(),df(r,e,n),pf(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,wf(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Qc(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function ff(t,e){return Y(this,void 0,void 0,(function(){var n,r,i,o,s;return J(this,(function(a){switch(a.label){case 0:wl((n=mo(t)).remoteStore)||lo("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,function(t){var e=mo(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e._n.getHighestUnacknowledgedBatchId(t)}))}(n.localStore)];case 2:return-1===(r=a.sent())?[2,void e.resolve()]:((i=n.Fo.get(r)||[]).push(e),n.Fo.set(r,i),[3,4]);case 3:return o=a.sent(),s=Vl(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}}))}))}function pf(t,e){(t.Fo.get(e)||[]).forEach((function(t){t.resolve()})),t.Fo.delete(e)}function df(t,e,n){var r=mo(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function yf(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach((function(e){t.No.containsKey(e)||gf(t,e)}))}function gf(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(yl(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),bf(t))}function vf(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Xl?(t.No.addReference(o.key,e),mf(t,o)):o instanceof Yl?(lo("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||gf(t,o.key)):go()}}function mf(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(lo("SyncEngine","New document in limbo: "+n),t.So.add(r),bf(t))}function bf(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new Go(ko.fromString(e)),r=t.ko.next();t.Co.set(r,new tf(n)),t.Do=t.Do.insert(n,r),dl(t.remoteStore,new dc(Vs(xs(n.path)),r,2,so.o))}}function wf(t,e,n){return Y(this,void 0,void 0,(function(){var r,i,o,s;return J(this,(function(a){switch(a.label){case 0:return r=mo(t),i=[],o=[],s=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach((function(t,a){s.push(r.Oo(a,e,n).then((function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=yh.Pn(a.targetId,t);o.push(e)}})))})),[4,Promise.all(s)]);case 1:return a.sent(),r.vo._r(i),[4,function(t,e){return Y(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,h;return J(this,(function(l){switch(l.label){case 0:n=mo(t),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return tc.forEach(e,(function(e){return tc.forEach(e.bn,(function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)})).next((function(){return tc.forEach(e.vn,(function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)}))}))}))}))];case 2:return l.sent(),[3,4];case 3:if(!oc(r=l.sent()))throw r;return lo("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)s=o[i],a=s.targetId,s.fromCache||(u=n.Fn.get(a),c=u.snapshotVersion,h=u.withLastLimboFreeSnapshotVersion(c),n.Fn=n.Fn.insert(a,h));return[2]}}))}))}(r.localStore,o)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function Ef(t,e){return Y(this,void 0,void 0,(function(){var n,r;return J(this,(function(i){switch(i.label){case 0:return(n=mo(t)).currentUser.isEqual(e)?[3,3]:(lo("SyncEngine","User change. New user:",e.toKey()),[4,bh(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Fo.forEach((function(t){t.forEach((function(t){t.reject(new uo(ao.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Fo.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,wf(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function If(t,e){var n=mo(t),r=n.Co.get(e);if(r&&r.bo)return ja().add(r.key);var i=ja(),o=n.Vo.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=a[s],c=n.Po.get(u);i=i.unionWith(c.view.wo)}return i}function Tf(t,e){return Y(this,void 0,void 0,(function(){var n,r,i;return J(this,(function(o){switch(o.label){case 0:return[4,Ah((n=mo(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&vf(n,e.targetId,i.To),i)]}}))}))}function _f(t){return Y(this,void 0,void 0,(function(){var e;return J(this,(function(n){return[2,Dh((e=mo(t)).localStore).then((function(t){return wf(e,t)}))]}))}))}function Sf(t,e,n,r){return Y(this,void 0,void 0,(function(){var i,o;return J(this,(function(s){switch(s.label){case 0:return[4,function(t,e){var n=mo(t),r=mo(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.jt(t,e).next((function(e){return e?n.Mn.pn(t,e):tc.resolve(null)}))}))}((i=mo(t)).localStore,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,Nl(i.remoteStore)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(df(i,e,r||null),pf(i,e),function(t,e){mo(mo(t)._n).Gt(e)}(i.localStore,e)):go(),s.label=4;case 4:return[4,wf(i,o)];case 5:return s.sent(),[3,7];case 6:lo("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}}))}))}function Af(t,e){return Y(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c;return J(this,(function(h){switch(h.label){case 0:return Of(n=mo(t)),Rf(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,Nf(n,r.toArray())]);case 1:return i=h.sent(),n.$o=!0,[4,Ll(n.remoteStore,!0)];case 2:for(h.sent(),o=0,s=i;o<s.length;o++)a=s[o],dl(n.remoteStore,a);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(u=[],c=Promise.resolve(),n.Vo.forEach((function(t,e){n.sharedClientState.isLocalQueryTarget(e)?u.push(e):c=c.then((function(){return yf(n,e),Sh(n.localStore,e,!0)})),yl(n.remoteStore,e)})),[4,c]);case 4:return h.sent(),[4,Nf(n,u)];case 5:return h.sent(),function(t){var e=mo(t);e.Co.forEach((function(t,n){yl(e.remoteStore,n)})),e.No.ts(),e.Co=new Map,e.Do=new Ca(Go.comparator)}(n),n.$o=!1,[4,Ll(n.remoteStore,!1)];case 6:h.sent(),h.label=7;case 7:return[2]}}))}))}function Nf(t,e,n){return Y(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,h,l,f,p,d,y;return J(this,(function(g){switch(g.label){case 0:n=mo(t),r=[],i=[],o=0,s=e,g.label=1;case 1:return o<s.length?(a=s[o],u=void 0,(c=n.Vo.get(a))&&0!==c.length?[4,_h(n.localStore,Vs(c[0]))]:[3,7]):[3,13];case 2:u=g.sent(),h=0,l=c,g.label=3;case 3:return h<l.length?(f=l[h],p=n.Po.get(f),[4,Tf(n,p)]):[3,6];case 4:(d=g.sent()).snapshot&&i.push(d.snapshot),g.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,Nh(n.localStore,a)];case 8:return y=g.sent(),[4,_h(n.localStore,y)];case 9:return u=g.sent(),[4,rf(n,Df(y),a,!1)];case 10:g.sent(),g.label=11;case 11:r.push(u),g.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}}))}))}function Df(t){return ks(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Cf(t){var e=mo(t);return mo(mo(e.localStore).persistence).fn()}function kf(t,e,n,r){return Y(this,void 0,void 0,(function(){var i,o,s;return J(this,(function(a){switch(a.label){case 0:return(i=mo(t)).$o?(lo("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Dh(i.localStore)];case 3:return o=a.sent(),s=Ka.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,wf(i,o,s)];case 4:return a.sent(),[3,8];case 5:return[4,Sh(i.localStore,e,!0)];case 6:return a.sent(),yf(i,e,r),[3,8];case 7:go(),a.label=8;case 8:return[2]}}))}))}function xf(t,e,n){return Y(this,void 0,void 0,(function(){var r,i,o,s,a,u,c,h,l,f;return J(this,(function(p){switch(p.label){case 0:if(!(r=Of(t)).$o)return[3,10];i=0,o=e,p.label=1;case 1:return i<o.length?(s=o[i],r.Vo.has(s)?(lo("SyncEngine","Adding an already active target "+s),[3,5]):[4,Nh(r.localStore,s)]):[3,6];case 2:return a=p.sent(),[4,_h(r.localStore,a)];case 3:return u=p.sent(),[4,rf(r,Df(a),u.targetId,!1)];case 4:p.sent(),dl(r.remoteStore,u),p.label=5;case 5:return i++,[3,1];case 6:c=function(t){return J(this,(function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,Sh(r.localStore,t,!1).then((function(){yl(r.remoteStore,t),yf(r,t)})).catch(Qc)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},h=0,l=n,p.label=7;case 7:return h<l.length?(f=l[h],[5,c(f)]):[3,10];case 8:p.sent(),p.label=9;case 9:return h++,[3,7];case 10:return[2]}}))}))}function Of(t){var e=mo(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=af.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=If.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=cf.bind(null,e),e.vo._r=Hl.bind(null,e.eventManager),e.vo.Mo=Ql.bind(null,e.eventManager),e}function Rf(t){var e=mo(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=hf.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=lf.bind(null,e),e}var Lf=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Y(this,void 0,void 0,(function(){return J(this,(function(e){switch(e.label){case 0:return this.R=il(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Ko(t),[2]}}))}))},t.prototype.Uo=function(t){return null},t.prototype.Ko=function(t){return mh(this.persistence,new gh,t.initialUser,this.R)},t.prototype.qo=function(t){return new Mh(Uh.bs,this.R)},t.prototype.Bo=function(t){return new Xh},t.prototype.terminate=function(){return Y(this,void 0,void 0,(function(){return J(this,(function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}}))}))},t}(),Pf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qo=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return $(e,t),e.prototype.initialize=function(e){return Y(this,void 0,void 0,(function(){return J(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,Ch(this.localStore)];case 2:return n.sent(),[4,this.Qo.initialize(this,e)];case 3:return n.sent(),[4,Rf(this.Qo.syncEngine)];case 4:return n.sent(),[4,Nl(this.Qo.remoteStore)];case 5:return n.sent(),[2]}}))}))},e.prototype.Ko=function(t){return mh(this.persistence,new gh,t.initialUser,this.R)},e.prototype.Uo=function(t){var e=this.persistence.referenceDelegate.garbageCollector;return new Xc(e,t.asyncQueue)},e.prototype.qo=function(t){var e=ph(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Lc.withCacheSize(this.cacheSizeBytes):Lc.DEFAULT;return new hh(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,nl(),rl(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new Xh},e}(Lf),Ff=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Qo=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return $(e,t),e.prototype.initialize=function(e){return Y(this,void 0,void 0,(function(){var n,r=this;return J(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Qo.syncEngine,this.sharedClientState instanceof $h?(this.sharedClientState.syncEngine={ui:Sf.bind(null,n),ai:kf.bind(null,n),hi:xf.bind(null,n),fn:Cf.bind(null,n),ci:_f.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He((function(t){return Y(r,void 0,void 0,(function(){return J(this,(function(e){switch(e.label){case 0:return[4,Af(this.Qo.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.Bo=function(t){var e=nl();if(!$h.yt(e))throw new uo(ao.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=ph(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new $h(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(Pf),Mf=function(){function t(){}return t.prototype.initialize=function(t,e){return Y(this,void 0,void 0,(function(){var n=this;return J(this,(function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return uf(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=Ef.bind(null,this.syncEngine),[4,Ll(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.createEventManager=function(t){return new Kl},t.prototype.createDatastore=function(t){var e,n=il(t.databaseInfo.databaseId),r=(e=t.databaseInfo,new el(e));return function(t,e,n){return new cl(t,e,n)}(t.credentials,r,n)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,s=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return uf(s.syncEngine,t,0)},o=Jh.yt()?new Jh:new Yh,new ll(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,s){var a=new ef(t,e,n,r,i,o);return s&&(a.$o=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return Y(this,void 0,void 0,(function(){var e;return J(this,(function(n){switch(n.label){case 0:return e=mo(t),lo("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,pl(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}}))}))}(this.remoteStore)},t}(),Vf=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),Uf=function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return Y(this,void 0,void 0,(function(){var e,n=this;return J(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new uo(ao.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Y(this,void 0,void 0,(function(){var n,r,i,o,s,a;return J(this,(function(u){switch(u.label){case 0:return n=mo(t),r=lu(n.R)+"/documents",i={documents:e.map((function(t){return au(n.R,t)}))},[4,n.$i("BatchGetDocuments",r,i)];case 1:return o=u.sent(),s=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){vo(!!e.found),e.found.name,e.found.updateTime;var n=uu(t,e.found.name),r=iu(e.found.updateTime),i=new ss({mapValue:{fields:e.found.fields}});return us.newFoundDocument(n,r,i)}(t,e):"missing"in e?function(t,e){vo(!!e.missing),vo(!!e.readTime);var n=uu(t,e.missing),r=iu(e.readTime);return us.newNoDocument(n,r)}(t,e):go()}(n.R,t);s.set(e.key.toString(),e)})),a=[],[2,(e.forEach((function(t){var e=s.get(t.toString());vo(!!e),a.push(e)})),a)]}}))}))}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach((function(t){return n.recordVersion(t)})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new _a(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return Y(this,void 0,void 0,(function(){var t,e=this;return J(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=Go.fromPath(n);e.mutations.push(new Sa(r,e.precondition(r)))})),[4,function(t,e){return Y(this,void 0,void 0,(function(){var n,r,i;return J(this,(function(o){switch(o.label){case 0:return n=mo(t),r=lu(n.R)+"/documents",i={writes:e.map((function(t){return du(n.R,t)}))},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw go();e=So.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new uo(ao.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?ca.updateTime(e):ca.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(So.min()))throw new uo(ao.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ca.updateTime(e)}return ca.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}(),jf=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new ol(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.ec-=1,this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji((function(){return Y(t,void 0,void 0,(function(){var t,e,n=this;return J(this,(function(r){return t=new Uf(this.datastore),(e=this.sc(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.ic(t)}))}))})).catch((function(t){n.ic(t)})),[2]}))}))}))},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!Bo(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget((function(){return e.nc(),Promise.resolve()}))):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Na(e)}return!1},t}(),qf=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=jh.UNAUTHENTICATED,this.clientId=wo.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,(function(t){return Y(r,void 0,void 0,(function(){return J(this,(function(e){switch(e.label){case 0:return lo("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}}))}))}))}return t.prototype.getConfiguration=function(){return Y(this,void 0,void 0,(function(){return J(this,(function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]}))}))},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new uo(ao.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new Zu;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((function(){return Y(t,void 0,void 0,(function(){var t,n;return J(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=Vl(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Bf(t,e){return Y(this,void 0,void 0,(function(){var n,r,i=this;return J(this,(function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),lo("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener((function(t){return Y(i,void 0,void 0,(function(){return J(this,(function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,bh(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}}))}))})),e.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=e,[2]}}))}))}function Kf(t,e){return Y(this,void 0,void 0,(function(){var n,r;return J(this,(function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,zf(t)];case 1:return n=i.sent(),lo("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener((function(t){return function(t,e){return Y(this,void 0,void 0,(function(){var n,r;return J(this,(function(i){switch(i.label){case 0:return(n=mo(t)).asyncQueue.verifyOperationInProgress(),lo("RemoteStore","RemoteStore received new credentials"),r=wl(n),n.Or.add(3),[4,pl(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,fl(n)];case 3:return i.sent(),[2]}}))}))}(e.remoteStore,t)})),t.onlineComponents=e,[2]}}))}))}function zf(t){return Y(this,void 0,void 0,(function(){return J(this,(function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(lo("FirestoreClient","Using default OfflineComponentProvider"),[4,Bf(t,new Lf)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}}))}))}function Gf(t){return Y(this,void 0,void 0,(function(){return J(this,(function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(lo("FirestoreClient","Using default OnlineComponentProvider"),[4,Kf(t,new Mf)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}}))}))}function Hf(t){return zf(t).then((function(t){return t.persistence}))}function Qf(t){return zf(t).then((function(t){return t.localStore}))}function Wf(t){return Gf(t).then((function(t){return t.remoteStore}))}function $f(t){return Gf(t).then((function(t){return t.syncEngine}))}function Xf(t){return Y(this,void 0,void 0,(function(){var e,n;return J(this,(function(r){switch(r.label){case 0:return[4,Gf(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=nf.bind(null,e.syncEngine),n.onUnlisten=of.bind(null,e.syncEngine),n)]}}))}))}function Yf(t,e,n){var r=this;void 0===n&&(n={});var i=new Zu;return t.asyncQueue.enqueueAndForget((function(){return Y(r,void 0,void 0,(function(){var r;return J(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Vf({next:function(o){e.enqueueAndForget((function(){return Gl(t,s)}));var a=o.docs.has(n);!a&&o.fromCache?i.reject(new uo(ao.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new uo(ao.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new $l(xs(n.path),o,{includeMetadataChanges:!0,so:!0});return zl(t,s)},[4,Xf(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}function Jf(t,e,n){var r=this;void 0===n&&(n={});var i=new Zu;return t.asyncQueue.enqueueAndForget((function(){return Y(r,void 0,void 0,(function(){var r;return J(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Vf({next:function(n){e.enqueueAndForget((function(){return Gl(t,s)})),n.fromCache&&"server"===r.source?i.reject(new uo(ao.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new $l(n,o,{includeMetadataChanges:!0,so:!0});return zl(t,s)},[4,Xf(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}var Zf=function(t,e,n,r,i,o,s,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=a},tp=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),ep=new Map,np=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},rp=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable((function(){return e(jh.UNAUTHENTICATED)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),ip=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable((function(){return e(n.token.user)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),op=function(){function t(t){var e=this;this.currentUser=jh.UNAUTHENTICATED,this.oc=new Zu,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.ac(),e.oc.resolve(),e.changeListener&&e.asyncQueue.enqueueRetryable((function(){return e.changeListener(e.currentUser)}))};var n=function(t){lo("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.auth.addAuthTokenListener(e.uc)};t.onInit((function(t){return n(t)})),setTimeout((function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):(lo("FirebaseCredentialsProvider","Auth not yet detected"),e.oc.resolve())}}),0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.cc!==e?(lo("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(vo("string"==typeof n.accessToken),new np(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){var n=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable((function(){return Y(n,void 0,void 0,(function(){return J(this,(function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,e(this.currentUser)];case 2:return t.sent(),this.changeListener=e,[2]}}))}))}))},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return vo(null===t||"string"==typeof t),new jh(t)},t}(),sp=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n,this.type="FirstParty",this.user=jh.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},e=this.hc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),t}(),ap=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n}return t.prototype.getToken=function(){return Promise.resolve(new sp(this.hc,this.lc,this.fc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable((function(){return e(jh.FIRST_PARTY)}))},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function up(t,e,n){if(!n)throw new uo(ao.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function cp(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new uo(ao.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function hp(t,e,n,r){if(!0===e&&!0===r)throw new uo(ao.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function lp(t){if(!Go.isDocumentKey(t))throw new uo(ao.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function fp(t){if(Go.isDocumentKey(t))throw new uo(ao.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function pp(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":go()}function dp(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new uo(ao.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=pp(t);throw new uo(ao.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function yp(t,e){if(e<=0)throw new uo(ao.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var gp=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new uo(ao.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new uo(ao.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,hp("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},t}(),vp=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new gp({}),this._settingsFrozen=!1,t instanceof tp?(this._databaseId=t,this._credentials=new rp):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new uo(ao.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new tp(t.options.projectId)}(t),this._credentials=new op(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new uo(ao.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new uo(ao.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new gp(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new rp;switch(t.type){case"gapi":var e=t.client;return vo(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ap(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new uo(ao.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return this,(t=ep.get(this))&&(lo("ComponentProvider","Removing Datastore"),ep.delete(this),t.terminate()),Promise.resolve();var t},t}(),mp=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new wp(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),bp=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),wp=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,xs(r))||this)._path=r,i.type="collection",i}return $(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new mp(this.firestore,null,new Go(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(bp);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ep(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=yt(t),up("collection","path",e),t instanceof vp)return fp(n=ko.fromString.apply(ko,et([e],r))),new wp(t,null,n);if(!(t instanceof mp||t instanceof wp))throw new uo(ao.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return fp(n=ko.fromString.apply(ko,et([t.path],r)).child(ko.fromString(e))),new wp(t.firestore,null,n)}function Ip(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=yt(t),1===arguments.length&&(e=wo.u()),up("doc","path",e),t instanceof vp)return lp(n=ko.fromString.apply(ko,et([e],r))),new mp(t,null,new Go(n));if(!(t instanceof mp||t instanceof wp))throw new uo(ao.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return lp(n=t._path.child(ko.fromString.apply(ko,et([e],r)))),new mp(t.firestore,t instanceof wp?t.converter:null,new Go(n))}function Tp(t,e){return t=yt(t),e=yt(e),(t instanceof mp||t instanceof wp)&&(e instanceof mp||e instanceof wp)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function _p(t,e){return t=yt(t),e=yt(e),t instanceof bp&&e instanceof bp&&t.firestore===e.firestore&&js(t._query,e._query)&&t.converter===e.converter
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var Sp=function(){function t(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=!1,this.Tc=[],this.Zi=new ol(this,"async_queue_retry"),this.Ic=function(){var e=rl();e&&lo("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=rl();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ic)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ac(),this.Rc(t)},t.prototype.enterRestrictedMode=function(t){if(!this._c){this._c=!0,this.Ec=t||!1;var e=rl();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Ic)}},t.prototype.enqueue=function(t){var e=this;if(this.Ac(),this._c)return new Promise((function(){}));var n=new Zu;return this.Rc((function(){return e._c&&e.Ec?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget((function(){return e.wc.push(t),e.bc()}))},t.prototype.bc=function(){return Y(this,void 0,void 0,(function(){var t,e=this;return J(this,(function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!oc(t=n.sent()))throw t;return lo("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.wc.length>0&&this.Zi.ji((function(){return e.bc()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Rc=function(t){var e=this,n=this.dc.then((function(){return e.gc=!0,t().catch((function(t){throw e.yc=t,e.gc=!1,fo("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.gc=!1,t}))}));return this.dc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Ac(),this.Tc.indexOf(t)>-1&&(e=0);var i=Ml.createAndSchedule(this,t,e,n,(function(t){return r.vc(t)}));return this.mc.push(i),i},t.prototype.Ac=function(){this.yc&&go()},t.prototype.verifyOperationInProgress=function(){},t.prototype.Pc=function(){return Y(this,void 0,void 0,(function(){var t;return J(this,(function(e){switch(e.label){case 0:return[4,t=this.dc];case 1:e.sent(),e.label=2;case 2:if(t!==this.dc)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Vc=function(t){for(var e=0,n=this.mc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Sc=function(t){var e=this;return this.Pc().then((function(){e.mc.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.Pc()}))},t.prototype.Dc=function(t){this.Tc.push(t)},t.prototype.vc=function(t){var e=this.mc.indexOf(t);this.mc.splice(e,1)},t}();function Ap(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var Np=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new Sp,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return $(e,t),e.prototype._terminate=function(){return this._firestoreClient||Cp(this),this._firestoreClient.terminate()},e}(vp);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Dp(t){return t._firestoreClient||Cp(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Cp(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new Zf(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new qf(t._credentials,t._queue,r)}function kp(t,e,n){var r=this,i=new Zu;return t.asyncQueue.enqueue((function(){return Y(r,void 0,void 0,(function(){var r;return J(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,Bf(t,n)];case 1:return o.sent(),[4,Kf(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===ao.FAILED_PRECONDITION||t.code===ao.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function xp(t){if(t._initialized||t._terminated)throw new uo(ao.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Op=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new uo(ao.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Oo(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),Rp=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(Lo.fromBase64String(e))}catch(e){throw new uo(ao.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(Lo.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),Lp=function(t){this._methodName=t},Pp=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new uo(ao.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new uo(ao.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return Eo(this._lat,t._lat)||Eo(this._long,t._long)},t}(),Fp=/^__.*__$/,Mp=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new ma(t,this.data,this.fieldMask,e,this.fieldTransforms):new va(t,this.data,e,this.fieldTransforms)},t}(),Vp=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new ma(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Up(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw go()}}var jp=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Cc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Nc",{get:function(){return this.settings.Nc},enumerable:!1,configurable:!0}),t.prototype.xc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.Fc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.xc({path:n,kc:!1});return r.$c(t),r},t.prototype.Oc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.xc({path:n,kc:!1});return r.Cc(),r},t.prototype.Mc=function(t){return this.xc({path:void 0,kc:!0})},t.prototype.Lc=function(t){return sd(t,this.settings.methodName,this.settings.Bc||!1,this.path,this.settings.qc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},t.prototype.Cc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.$c(this.path.get(t))},t.prototype.$c=function(t){if(0===t.length)throw this.Lc("Document fields must not be empty");if(Up(this.Nc)&&Fp.test(t))throw this.Lc('Document fields cannot begin and end with "__"')},t}(),qp=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||il(t)}return t.prototype.Uc=function(t,e,n,r){return void 0===r&&(r=!1),new jp({Nc:t,methodName:e,qc:n,path:Oo.emptyPath(),kc:!1,Bc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function Bp(t){var e=t._freezeSettings(),n=il(t._databaseId);return new qp(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Kp(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Uc(o.merge||o.mergeFields?2:0,e,n,i);nd("Data must be an object, but it was:",s,r);var a,u,c=td(r,s);if(o.merge)a=new Ro(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){for(var h=[],l=0,f=o.mergeFields;l<f.length;l++){var p=rd(e,f[l],n);if(!s.contains(p))throw new uo(ao.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");ad(h,p)||h.push(p)}a=new Ro(h),u=s.fieldTransforms.filter((function(t){return a.covers(t.field)}))}else a=null,u=s.fieldTransforms;return new Mp(new ss(c),a,u)}var zp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.Nc)throw 1===t.Nc?t.Lc(this._methodName+"() can only appear at the top level of your update data"):t.Lc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(Lp);function Gp(t,e,n){return new jp({Nc:3,qc:e.settings.qc,methodName:t._methodName,kc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var Hp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $(e,t),e.prototype._toFieldTransform=function(t){return new aa(t.path,new Zs)},e.prototype.isEqual=function(t){return t instanceof e},e}(Lp),Qp=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return $(e,t),e.prototype._toFieldTransform=function(t){var e=Gp(this,t,!0),n=this.Kc.map((function(t){return Zp(t,e)})),r=new ta(n);return new aa(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Lp),Wp=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return $(e,t),e.prototype._toFieldTransform=function(t){var e=Gp(this,t,!0),n=this.Kc.map((function(t){return Zp(t,e)})),r=new na(n);return new aa(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Lp),$p=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Qc=n,r}return $(e,t),e.prototype._toFieldTransform=function(t){var e=new ia(t.R,Ws(t.R,this.Qc));return new aa(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(Lp);function Xp(t,e,n,r){var i=t.Uc(1,e,n);nd("Data must be an object, but it was:",i,r);var o=[],s=ss.empty();No(r,(function(t,r){var a=od(e,t,n);r=yt(r);var u=i.Oc(a);if(r instanceof zp)o.push(a);else{var c=Zp(r,u);null!=c&&(o.push(a),s.set(a,c))}}));var a=new Ro(o);return new Vp(s,a,i.fieldTransforms)}function Yp(t,e,n,r,i,o){var s=t.Uc(1,e,n),a=[rd(e,r,n)],u=[i];if(o.length%2!=0)throw new uo(ao.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(rd(e,o[c])),u.push(o[c+1]);for(var h=[],l=ss.empty(),f=a.length-1;f>=0;--f)if(!ad(h,a[f])){var p=a[f],d=u[f];d=yt(d);var y=s.Oc(p);if(d instanceof zp)h.push(p);else{var g=Zp(d,y);null!=g&&(h.push(p),l.set(p,g))}}var v=new Ro(h);return new Vp(l,v,s.fieldTransforms)}function Jp(t,e,n,r){return void 0===r&&(r=!1),Zp(n,t.Uc(r?4:3,e))}function Zp(t,e){if(ed(t=yt(t)))return nd("Unsupported field value:",e,t),td(t,e);if(t instanceof Lp)return function(t,e){if(!Up(e.Nc))throw e.Lc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Lc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.kc&&4!==e.Nc)throw e.Lc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=Zp(o[i],e.Mc(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=yt(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Ws(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=_o.fromDate(t);return{timestampValue:eu(e.R,n)}}if(t instanceof _o)return n=new _o(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:eu(e.R,n)};if(t instanceof Pp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Rp)return{bytesValue:nu(e.R,t._byteString)};if(t instanceof mp){n=e.databaseId;var r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Lc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:ou(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Lc("Unsupported field value: "+pp(t))}(t,e)}function td(t,e){var n={};return Do(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):No(t,(function(t,r){var i=Zp(r,e.Fc(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function ed(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof _o||t instanceof Pp||t instanceof Rp||t instanceof mp||t instanceof Lp)}function nd(t,e,n){if(!ed(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=pp(n);throw"an object"===r?e.Lc(t+" a custom object"):e.Lc(t+" "+r)}}function rd(t,e,n){if((e=yt(e))instanceof Op)return e._internalPath;if("string"==typeof e)return od(t,e);throw sd("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var id=new RegExp("[~\\*/\\[\\]]");function od(t,e,n){if(e.search(id)>=0)throw sd("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(Op.bind.apply(Op,et([void 0],e.split(".")))))._internalPath}catch(r){throw sd("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function sd(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new uo(ao.INVALID_ARGUMENT,(a+=". ")+t+u)}function ad(t,e){return t.some((function(t){return t.isEqual(e)}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ud=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new mp(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new cd(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(hd("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),cd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(ud);function hd(t,e){return"string"==typeof e?od(t,e):e instanceof Op?e._internalPath:e._delegate._internalPath}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ld=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),fd=function(t){function e(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this)._firestore=e,a._firestoreImpl=e,a.metadata=o,a}return $(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new pd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(hd("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(ud),pd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(fd),dd=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new ld(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach((function(r){t.call(e,new pd(n._firestore,n._userDataWriter,r.key,r,new ld(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new uo(ao.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map((function(e){return{type:"added",doc:new pd(t._firestore,t._userDataWriter,e.doc.key,e.doc,new ld(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:n++}}))}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new pd(t._firestore,t._userDataWriter,e.doc.key,e.doc,new ld(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:yd(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function yd(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return go()}}function gd(t,e){return t instanceof fd&&e instanceof fd?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof dd&&e instanceof dd&&t._firestore===e._firestore&&_p(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function vd(t){if(Rs(t)&&0===t.explicitOrderBy.length)throw new uo(ao.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var md=function(){};function bd(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var wd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).jc=e,i.Wc=n,i.Gc=r,i.type="where",i}return $(e,t),e.prototype._apply=function(t){var e=Bp(t.firestore),n=function(t,e,n,r,i,o,s){var a;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new uo(ao.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Nd(s,o);for(var u=[],c=0,h=s;c<h.length;c++){var l=h[c];u.push(Ad(r,t,l))}a={arrayValue:{values:u}}}else a=Ad(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Nd(s,o),a=Jp(n,"where",s,"in"===o||"not-in"===o);var f=ds.create(i,o,a);return function(t,e){if(e.g()){var n=Ps(t);if(null!==n&&!n.isEqual(e.field))throw new uo(ao.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Ls(t);null!==r&&Dd(t,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new uo(ao.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new uo(ao.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t._query,0,e,t.firestore._databaseId,this.jc,this.Wc,this.Gc);return new bp(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new Cs(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(md),Ed=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).jc=e,r.zc=n,r.type="orderBy",r}return $(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new uo(ao.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new uo(ao.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Ss(e,n);return function(t,e){if(null===Ls(t)){var n=Ps(t);null!==n&&Dd(t,n,e.field)}}(t,r),r}(t._query,this.jc,this.zc);return new bp(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new Cs(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(md),Id=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Hc=n,i.Jc=r,i}return $(e,t),e.prototype._apply=function(t){return new bp(t.firestore,t.converter,Us(t._query,this.Hc,this.Jc))},e}(md),Td=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Yc=n,i.Xc=r,i}return $(e,t),e.prototype._apply=function(t){var e=Sd(t,this.type,this.Yc,this.Xc);return new bp(t.firestore,t.converter,function(t,e){return new Cs(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(md),_d=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Yc=n,i.Xc=r,i}return $(e,t),e.prototype._apply=function(t){var e=Sd(t,this.type,this.Yc,this.Xc);return new bp(t.firestore,t.converter,function(t,e){return new Cs(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(md);function Sd(t,e,n,r){if(n[0]=yt(n[0]),n[0]instanceof ud)return function(t,e,n,r,i){if(!r)throw new uo(ao.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=Ms(t);s<a.length;s++){var u=a[s];if(u.field.isKeyField())o.push(Zo(e,r.key));else{var c=r.data.field(u.field);if(Uo(c))throw new uo(ao.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=u.field.canonicalString();throw new uo(ao.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Ts(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=Bp(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new uo(ao.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.isKeyField()){if("string"!=typeof c)throw new uo(ao.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Fs(t)&&-1!==c.indexOf("/"))throw new uo(ao.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(ko.fromString(c));if(!Go.isDocumentKey(h))throw new uo(ao.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var l=new Go(h);a.push(Zo(e,l))}else{var f=Jp(n,r,c);a.push(f)}}return new Ts(a,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function Ad(t,e,n){if("string"==typeof(n=yt(n))){if(""===n)throw new uo(ao.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Fs(e)&&-1!==n.indexOf("/"))throw new uo(ao.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(ko.fromString(n));if(!Go.isDocumentKey(r))throw new uo(ao.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Zo(t,new Go(r))}if(n instanceof mp)return Zo(t,n._key);throw new uo(ao.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+pp(n)+".")}function Nd(t,e){if(!Array.isArray(t)||0===t.length)throw new uo(ao.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new uo(ao.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Dd(t,e,n){if(!n.isEqual(e))throw new uo(ao.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Cd=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),Ho(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Mo(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Vo(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw go()}},t.prototype.convertObject=function(t,e){var n=this,r={};return No(t.fields,(function(t,i){r[t]=n.convertValue(i,e)})),r},t.prototype.convertGeoPoint=function(t){return new Pp(Mo(t.latitude),Mo(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=jo(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(qo(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=Fo(t);return new _o(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=ko.fromString(t);vo(Cu(n));var r=new tp(n.get(1),n.get(3)),i=new Go(n.popFirst(5));return r.isEqual(e)||fo("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function kd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var xd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return $(e,t),e.prototype.convertBytes=function(t){return new Rp(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new mp(this.firestore,null,e)},e}(Cd),Od=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=Bp(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=Rd(t,this._firestore),i=kd(r.converter,e,n),o=Kp(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,ca.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,s=Rd(t,this._firestore);return o="string"==typeof(e=yt(e))||e instanceof Op?Yp(this._dataReader,"WriteBatch.update",s._key,e,n,r):Xp(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(o.toMutation(s._key,ca.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=Rd(t,this._firestore);return this._mutations=this._mutations.concat(new _a(e._key,ca.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new uo(ao.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Rd(t,e){if((t=yt(t)).firestore!==e)throw new uo(ao.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ld=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return $(e,t),e.prototype.convertBytes=function(t){return new Rp(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new mp(this.firestore,null,e)},e}(Cd);function Pd(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=dp(t,mp);var o=dp(t.firestore,Np),s=Bp(o);return Md(o,[("string"==typeof(e=yt(e))||e instanceof Op?Yp(s,"updateDoc",t._key,e,n,r):Xp(s,"updateDoc",t._key,e)).toMutation(t._key,ca.exists(!0))])}function Fd(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t=yt(t);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||Ap(i[a])||(s=i[a],a++);var u,c,h,l={includeMetadataChanges:s.includeMetadataChanges};if(Ap(i[a])){var f=i[a];i[a]=null===(e=f.next)||void 0===e?void 0:e.bind(f),i[a+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),i[a+2]=null===(r=f.complete)||void 0===r?void 0:r.bind(f)}if(t instanceof mp)c=dp(t.firestore,Np),h=xs(t._key.path),u={next:function(e){i[a]&&i[a](Vd(c,t,e))},error:i[a+1],complete:i[a+2]};else{var p=dp(t,bp);c=dp(p.firestore,Np),h=p._query;var d=new Ld(c);u={next:function(t){i[a]&&i[a](new dd(c,d,p,t))},error:i[a+1],complete:i[a+2]},vd(t._query)}return function(t,e,n,r){var i=this,o=new Vf(r),s=new $l(e,o,n);return t.asyncQueue.enqueueAndForget((function(){return Y(i,void 0,void 0,(function(){var e;return J(this,(function(n){switch(n.label){case 0:return e=zl,[4,Xf(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))})),function(){o.Wo(),t.asyncQueue.enqueueAndForget((function(){return Y(i,void 0,void 0,(function(){var e;return J(this,(function(n){switch(n.label){case 0:return e=Gl,[4,Xf(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))}))}}(Dp(c),h,l,u)}function Md(t,e){return function(t,e){var n=this,r=new Zu;return t.asyncQueue.enqueueAndForget((function(){return Y(n,void 0,void 0,(function(){var n;return J(this,(function(i){switch(i.label){case 0:return n=sf,[4,$f(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(Dp(t),e)}function Vd(t,e,n){var r=n.docs.get(e._key),i=new Ld(t);return new fd(t,i,e._key,r,new ld(n.hasPendingWrites,n.fromCache),e.converter)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ud=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return $(e,t),e.prototype.get=function(e){var n=this,r=Rd(e,this._firestore),i=new Ld(this._firestore);return t.prototype.get.call(this,e).then((function(t){return new fd(n._firestore,i,r._key,t._document,new ld(!1,!1),r.converter)}))},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=Bp(t)}return t.prototype.get=function(t){var e=this,n=Rd(t,this._firestore),r=new xd(this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return go();var i=t[0];if(i.isFoundDocument())return new ud(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new ud(e._firestore,r,n._key,null,n.converter);throw go()}))},t.prototype.set=function(t,e,n){var r=Rd(t,this._firestore),i=kd(r.converter,e,n),o=Kp(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=Rd(t,this._firestore);return o="string"==typeof(e=yt(e))||e instanceof Op?Yp(this._dataReader,"Transaction.update",s._key,e,n,r):Xp(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,o),this},t.prototype.delete=function(t){var e=Rd(t,this._firestore);return this._transaction.delete(e._key),this},t}());
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function jd(){if("undefined"==typeof Uint8Array)throw new uo(ao.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function qd(){if("undefined"==typeof atob)throw new uo(ao.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Bd=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return qd(),new t(Rp.fromBase64String(e))},t.fromUint8Array=function(e){return jd(),new t(Rp.fromUint8Array(e))},t.prototype.toBase64=function(){return qd(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return jd(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),Kd=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){xp(t=dp(t,Np));var n=Dp(t),r=t._freezeSettings(),i=new Mf;return kp(n,i,new Pf(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){xp(t=dp(t,Np));var e=Dp(t),n=t._freezeSettings(),r=new Mf;return kp(e,r,new Ff(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new uo(ao.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new Zu;return t._queue.enqueueAndForgetEvenWhileRestricted((function(){return Y(e,void 0,void 0,(function(){var e;return J(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Y(this,void 0,void 0,(function(){var e;return J(this,(function(n){switch(n.label){case 0:return nc.yt()?(e=t+"main",[4,nc.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(ph(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._delegate)},t}(),zd=function(){function t(t,e,n){var r=this;this._delegate=e,this.Zc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof tp||(this.tu=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||po("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={});var i=(t=dp(t,vp))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==e&&po("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:e+":"+n,ssl:!1})),r.mockUserToken){var o=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var o=X({iss:"https://securetoken.google.com/"+n,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[nt.encodeString(JSON.stringify({alg:"none",type:"JWT"}),!1),nt.encodeString(JSON.stringify(o),!1),""].join(".")}(r.mockUserToken),s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new uo(ao.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");t._credentials=new ip(new np(o,new jh(s)))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return Y(e,void 0,void 0,(function(){var e,n;return J(this,(function(r){switch(r.label){case 0:return[4,Hf(t)];case 1:return e=r.sent(),[4,Wf(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=mo(t);return e.Or.delete(0),fl(e)}(n))]}}))}))}))}(Dp(dp(this._delegate,Np)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return Y(e,void 0,void 0,(function(){var e,n;return J(this,(function(r){switch(r.label){case 0:return[4,Hf(t)];case 1:return e=r.sent(),[4,Wf(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return Y(this,void 0,void 0,(function(){var e;return J(this,(function(n){switch(n.label){case 0:return(e=mo(t)).Or.add(0),[4,pl(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(Dp(dp(this._delegate,Np)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&hp("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Zc.enableMultiTabIndexedDbPersistence(this):this.Zc.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.Zc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.tu&&(this.tu._removeServiceInstance("firestore"),this.tu._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new Zu;return t.asyncQueue.enqueueAndForget((function(){return Y(e,void 0,void 0,(function(){var e;return J(this,(function(r){switch(r.label){case 0:return e=ff,[4,$f(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(Dp(dp(this._delegate,Np)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new Vf(e);return t.asyncQueue.enqueueAndForget((function(){return Y(n,void 0,void 0,(function(){var e;return J(this,(function(n){switch(n.label){case 0:return e=function(t,e){mo(t).Gr.add(e),e.next()},[4,Xf(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.Wo(),t.asyncQueue.enqueueAndForget((function(){return Y(n,void 0,void 0,(function(){var e;return J(this,(function(n){switch(n.label){case 0:return e=function(t,e){mo(t).Gr.delete(e)},[4,Xf(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(Dp(t=dp(t,Np)),Ap(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.tu)throw new uo(ao.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.tu},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new iy(this,Ep(this._delegate,t))}catch(t){throw Xd(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new $d(this,Ip(this._delegate,t))}catch(t){throw Xd(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new ey(this,function(t,e){if(t=dp(t,vp),up("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new uo(ao.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new bp(t,null,function(t){return new Cs(ko.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw Xd(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new Zu;return t.asyncQueue.enqueueAndForget((function(){return Y(n,void 0,void 0,(function(){var n;return J(this,(function(i){switch(i.label){case 0:return[4,function(t){return Gf(t).then((function(t){return t.datastore}))}(t)];case 1:return n=i.sent(),new jf(t.asyncQueue,n,e,r).run(),[2]}}))}))})),r.promise}(Dp(t),(function(n){return e(new Ud(t,n))}))}(this._delegate,(function(n){return t(new Hd(e,n))}))},t.prototype.batch=function(){var t=this;return Dp(this._delegate),new Qd(new Od(this._delegate,(function(e){return Md(t._delegate,e)})))},t.prototype.loadBundle=function(t){throw new uo(ao.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new uo(ao.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),Gd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return $(e,t),e.prototype.convertBytes=function(t){return new Bd(new Rp(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return $d.eu(e,this.firestore,null)},e}(Cd);var Hd=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new Gd(t)}return t.prototype.get=function(t){var e=this,n=oy(t);return this._delegate.get(n).then((function(t){return new Zd(e._firestore,new fd(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))}))},t.prototype.set=function(t,e,n){var r=oy(t);return n?(cp("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=oy(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,et([s,e,n],i)),this},t.prototype.delete=function(t){var e=oy(t);return this._delegate.delete(e),this},t}(),Qd=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=oy(t);return n?(cp("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=oy(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,et([s,e,n],i)),this},t.prototype.delete=function(t){var e=oy(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),Wd=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new pd(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new ty(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.nu=function(e,n){var r=t.su,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new Gd(e),n),i.set(n,o)),o},t}();Wd.su=new WeakMap;var $d=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Gd(t)}return t.iu=function(e,n,r){if(e.length%2!=0)throw new uo(ao.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new mp(n._delegate,r,new Go(e)))},t.eu=function(e,n,r){return new t(n,new mp(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new iy(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new iy(this.firestore,Ep(this._delegate,t))}catch(t){throw Xd(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=yt(t))instanceof mp&&Tp(this._delegate,t)},t.prototype.set=function(t,e){e=cp("DocumentReference.set",e);try{return function(t,e,n){t=dp(t,mp);var r=dp(t.firestore,Np),i=kd(t.converter,e,n);return Md(r,[Kp(Bp(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,ca.none())])}(this._delegate,t,e)}catch(t){throw Xd(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Pd(this._delegate,t):Pd.apply(void 0,et([this._delegate,t,e],n))}catch(t){throw Xd(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return Md(dp((t=this._delegate).firestore,Np),[new _a(t._key,ca.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Yd(e),i=Jd(e,(function(e){return new Zd(t.firestore,new fd(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}));return Fd(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=dp(t,mp);var e=dp(t.firestore,Np),n=Dp(e),r=new Ld(e);return function(t,e){var n=this,r=new Zu;return t.asyncQueue.enqueueAndForget((function(){return Y(n,void 0,void 0,(function(){var n;return J(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return Y(this,void 0,void 0,(function(){var r,i;return J(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=mo(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Mn.mn(t,e)}))}(t,e)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new uo(ao.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=Vl(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,Qf(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._key).then((function(n){return new fd(e,r,t._key,n,new ld(null!==n&&n.hasLocalMutations,!0),t.converter)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=dp(t,mp);var e=dp(t.firestore,Np);return Yf(Dp(e),t._key,{source:"server"}).then((function(n){return Vd(e,t,n)}))}(this._delegate):function(t){t=dp(t,mp);var e=dp(t.firestore,Np);return Yf(Dp(e),t._key).then((function(n){return Vd(e,t,n)}))}(this._delegate)).then((function(t){return new Zd(e.firestore,new fd(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}))},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Wd.nu(this.firestore,e)):this._delegate.withConverter(null))},t}();function Xd(t,e,n){return t.message=t.message.replace(e,n),t}function Yd(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Ap(r))return r}return{}}function Jd(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=Ap(t[0])?t[0]:Ap(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Zd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new $d(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return gd(this._delegate,t._delegate)},t}(),ty=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(Zd),ey=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Gd(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,bd(this._delegate,function(t,e,n){var r=e,i=hd("where",t);return new wd(i,r,n)}(e,n,r)))}catch(e){throw Xd(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,bd(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=hd("orderBy",t);return new Ed(r,n)}(e,n)))}catch(e){throw Xd(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,bd(this._delegate,function(t){return yp("limit",t),new Id("limit",t,"F")}(e)))}catch(e){throw Xd(e,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,bd(this._delegate,function(t){return yp("limitToLast",t),new Id("limitToLast",t,"L")}(e)))}catch(e){throw Xd(e,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,bd(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Td("startAt",t,!0)}.apply(void 0,e)))}catch(e){throw Xd(e,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,bd(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Td("startAfter",t,!1)}.apply(void 0,e)))}catch(e){throw Xd(e,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,bd(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new _d("endBefore",t,!0)}.apply(void 0,e)))}catch(e){throw Xd(e,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,bd(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new _d("endAt",t,!1)}.apply(void 0,e)))}catch(e){throw Xd(e,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return _p(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=dp(t,bp);var e=dp(t.firestore,Np),n=Dp(e),r=new Ld(e);return function(t,e){var n=this,r=new Zu;return t.asyncQueue.enqueueAndForget((function(){return Y(n,void 0,void 0,(function(){var n;return J(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return Y(this,void 0,void 0,(function(){var r,i,o,s,a;return J(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,Ah(t,e,!0)];case 1:return a=u.sent(),r=new Jl(e,a.Bn),i=r._o(a.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=u.sent(),a=Vl(s,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}}))}))},[4,Qf(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._query).then((function(n){return new dd(e,r,t,n)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=dp(t,bp);var e=dp(t.firestore,Np),n=Dp(e),r=new Ld(e);return Jf(n,t._query,{source:"server"}).then((function(n){return new dd(e,r,t,n)}))}(this._delegate):function(t){t=dp(t,bp);var e=dp(t.firestore,Np),n=Dp(e),r=new Ld(e);return vd(t._query),Jf(n,t._query).then((function(n){return new dd(e,r,t,n)}))}(this._delegate)).then((function(t){return new ry(e.firestore,new dd(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}))},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Yd(e),i=Jd(e,(function(e){return new ry(t.firestore,new dd(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}));return Fd(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Wd.nu(this.firestore,e)):this._delegate.withConverter(null))},t}(),ny=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new ty(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),ry=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new ey(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map((function(e){return new ty(t._firestore,e)}))},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map((function(t){return new ny(e._firestore,t)}))},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach((function(r){t.call(e,new ty(n._firestore,r))}))},t.prototype.isEqual=function(t){return gd(this._delegate,t._delegate)},t}(),iy=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return $(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new $d(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new $d(this.firestore,void 0===t?Ip(this._delegate):Ip(this._delegate,t))}catch(t){throw Xd(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=dp(t.firestore,Np),r=Ip(t),i=kd(t.converter,e);return Md(n,[Kp(Bp(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,ca.exists(!1))]).then((function(){return r}))}(this._delegate,t).then((function(t){return new $d(e.firestore,t)}))},e.prototype.isEqual=function(t){return Tp(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(Wd.nu(this.firestore,t)):this._delegate.withConverter(null))},e}(ey);function oy(t){return dp(t,mp)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var sy,ay=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(Op.bind.apply(Op,et([void 0],t)))}return t.documentId=function(){return new t(Oo.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=yt(t))instanceof Op&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),uy=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new Hp("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new zp("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Qp("arrayUnion",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Wp("arrayRemove",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(t){return new $p("increment",t)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}(),cy={Firestore:zd,GeoPoint:Pp,Timestamp:_o,Blob:Bd,Transaction:Hd,WriteBatch:Qd,DocumentReference:$d,DocumentSnapshot:Zd,Query:ey,QueryDocumentSnapshot:ty,QuerySnapshot:ry,CollectionReference:iy,FieldPath:ay,FieldValue:uy,setLogLevel:function(t){var e;e=t,co.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new gt("firestore",(function(t){return function(t,e){return new zd(t,new Np(t,e),new Kd)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},cy)))})(sy=zt),sy.registerVersion("@firebase/firestore","2.3.9");
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var hy={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},ly=function(t){function e(n,r,i){var o=t.call(this,r)||this;return Object.setPrototypeOf(o,e.prototype),o.code=n,o.details=i,o}return $(e,t),e}(Error);var fy=function(){function t(t,e){var n=this;this.auth=null,this.messaging=null,this.auth=t.getImmediate({optional:!0}),this.messaging=e.getImmediate({optional:!0}),this.auth||t.get().then((function(t){return n.auth=t}),(function(){})),this.messaging||e.get().then((function(t){return n.messaging=t}),(function(){}))}return t.prototype.getAuthToken=function(){return Y(this,void 0,void 0,(function(){var t;return J(this,(function(e){switch(e.label){case 0:if(!this.auth)return[2,void 0];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return(t=e.sent())?[2,t.accessToken]:[2,void 0];case 3:return e.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getInstanceIdToken=function(){return Y(this,void 0,void 0,(function(){return J(this,(function(t){switch(t.label){case 0:if(!this.messaging||!("Notification"in self)||"granted"!==Notification.permission)return[2,void 0];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.messaging.getToken()];case 2:return[2,t.sent()];case 3:return t.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getContext=function(){return Y(this,void 0,void 0,(function(){var t,e;return J(this,(function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return t=n.sent(),[4,this.getInstanceIdToken()];case 2:return e=n.sent(),[2,{authToken:t,instanceIdToken:e}]}}))}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function py(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}var dy=function(){function t(){}return t.prototype.encode=function(t){var e=this;if(null==t)return null;if(t instanceof Number&&(t=t.valueOf()),"number"==typeof t&&isFinite(t))return t;if(!0===t||!1===t)return t;if("[object String]"===Object.prototype.toString.call(t))return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map((function(t){return e.encode(t)}));if("function"==typeof t||"object"==typeof t)return py(t,(function(t){return e.encode(t)}));throw new Error("Data cannot be encoded in JSON: "+t)},t.prototype.decode=function(t){var e=this;if(null==t)return t;if(t["@type"])switch(t["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var n=Number(t.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+t);return n;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map((function(t){return e.decode(t)})):"function"==typeof t||"object"==typeof t?py(t,(function(t){return e.decode(t)})):t},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var yy=function(){function t(t,e,n,r,i,o){var s=this;void 0===i&&(i="us-central1"),this.app_=t,this.appCheckProvider=r,this.fetchImpl=o,this.serializer=new dy,this.emulatorOrigin=null,this.INTERNAL={delete:function(){return Promise.resolve(s.deleteService())}},this.contextProvider=new fy(e,n),this.cancelAllRequests=new Promise((function(t){s.deleteService=function(){return t()}}));try{var a=new URL(i);this.customDomain=a.origin,this.region="us-central1"}catch(t){this.customDomain=null,this.region=i}}return Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!1,configurable:!0}),t.prototype._url=function(t){var e=this.app_.options.projectId;return null!==this.emulatorOrigin?this.emulatorOrigin+"/"+e+"/"+this.region+"/"+t:null!==this.customDomain?this.customDomain+"/"+t:"https://"+this.region+"-"+e+".cloudfunctions.net/"+t},t.prototype.useEmulator=function(t,e){this.emulatorOrigin="http://"+t+":"+e},t.prototype.useFunctionsEmulator=function(t){this.emulatorOrigin=t},t.prototype.httpsCallable=function(t,e){var n=this;return function(r){return n.call(t,r,e||{})}},t.prototype.postJSON=function(t,e,n){return Y(this,void 0,void 0,(function(){var r,i,o;return J(this,(function(s){switch(s.label){case 0:return n["Content-Type"]="application/json",[4,this.getAppCheckToken()];case 1:null!==(r=s.sent())&&(n["X-Firebase-AppCheck"]=r),s.label=2;case 2:return s.trys.push([2,4,,5]),[4,this.fetchImpl(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 3:return i=s.sent(),[3,5];case 4:return s.sent(),[2,{status:0,json:null}];case 5:o=null,s.label=6;case 6:return s.trys.push([6,8,,9]),[4,i.json()];case 7:return o=s.sent(),[3,9];case 8:return s.sent(),[3,9];case 9:return[2,{status:i.status,json:o}]}}))}))},t.prototype.getAppCheckToken=function(){return Y(this,void 0,void 0,(function(){var t;return J(this,(function(e){switch(e.label){case 0:return(t=this.appCheckProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:return[2,e.sent().token];case 2:return[2,null]}}))}))},t.prototype.call=function(t,e,n){return Y(this,void 0,void 0,(function(){var r,i,o,s,a,u,c,h,l,f,p;return J(this,(function(d){switch(d.label){case 0:return r=this._url(t),e=this.serializer.encode(e),i={data:e},o={},[4,this.contextProvider.getContext()];case 1:return(s=d.sent()).authToken&&(o.Authorization="Bearer "+s.authToken),s.instanceIdToken&&(o["Firebase-Instance-ID-Token"]=s.instanceIdToken),a=n.timeout||7e4,u=function(t){var e,n=new Promise((function(n,r){e=setTimeout((function(){r(new ly("deadline-exceeded","deadline-exceeded"))}),t)}));return{timer:e,promise:n}}(a),c=u.timer,h=u.promise,[4,Promise.race([gy(c,this.postJSON(r,i,o)),h,gy(c,this.cancelAllRequests)])];case 2:if(!(l=d.sent()))throw new ly("cancelled","Firebase Functions instance was deleted.");if(f=function(t,e,n){var r=function(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),i=r,o=void 0;try{var s=e&&e.error;if(s){var a=s.status;if("string"==typeof a){if(!hy[a])return new ly("internal","internal");r=hy[a],i=a}var u=s.message;"string"==typeof u&&(i=u),void 0!==(o=s.details)&&(o=n.decode(o))}}catch(t){}return"ok"===r?null:new ly(r,i,o)}(l.status,l.json,this.serializer))throw f;if(!l.json)throw new ly("internal","Response is not valid JSON object.");if(void 0===(p=l.json.data)&&(p=l.json.result),void 0===p)throw new ly("internal","Response is missing data field.");return[2,{data:this.serializer.decode(p)}]}}))}))},t}();function gy(t,e){return Y(this,void 0,void 0,(function(){var n;return J(this,(function(r){switch(r.label){case 0:return[4,e];case 1:return n=r.sent(),clearTimeout(t),[2,n]}}))}))}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
!function(t,e){var n={Functions:yy};t.INTERNAL.registerComponent(new gt("functions",(function(t,n){var r=n.instanceIdentifier,i=t.getProvider("app").getImmediate(),o=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal"),a=t.getProvider("messaging");return new yy(i,o,a,s,r,e)}),"PUBLIC").setServiceProps(n).setMultipleInstances(!0))}(zt,fetch.bind(self)),zt.registerVersion("@firebase/functions","0.6.13");zt.initializeApp({apiKey:"AIzaSyAq59lK80pPZj_-DmD8swIckq2TYTt8Meo",authDomain:"anime-corner-rankings.firebaseapp.com",projectId:"anime-corner-rankings",storageBucket:"anime-corner-rankings.appspot.com",messagingSenderId:"1056575402361",appId:"1:1056575402361:web:0fd9790f5ef43a94897fa8",measurementId:"G-264NJGB06X"});const vy=zt.firestore(),my=zt.functions();var by=function(t,e){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return t.apply(e,n)}},wy=Object.prototype.toString;function Ey(t){return"[object Array]"===wy.call(t)}function Iy(t){return void 0===t}function Ty(t){return null!==t&&"object"==typeof t}function _y(t){if("[object Object]"!==wy.call(t))return!1;var e=Object.getPrototypeOf(t);return null===e||e===Object.prototype}function Sy(t){return"[object Function]"===wy.call(t)}function Ay(t,e){if(null!=t)if("object"!=typeof t&&(t=[t]),Ey(t))for(var n=0,r=t.length;n<r;n++)e.call(null,t[n],n,t);else for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.call(null,t[i],i,t)}var Ny={isArray:Ey,isArrayBuffer:function(t){return"[object ArrayBuffer]"===wy.call(t)},isBuffer:function(t){return null!==t&&!Iy(t)&&null!==t.constructor&&!Iy(t.constructor)&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)},isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:Ty,isPlainObject:_y,isUndefined:Iy,isDate:function(t){return"[object Date]"===wy.call(t)},isFile:function(t){return"[object File]"===wy.call(t)},isBlob:function(t){return"[object Blob]"===wy.call(t)},isFunction:Sy,isStream:function(t){return Ty(t)&&Sy(t.pipe)},isURLSearchParams:function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:Ay,merge:function t(){var e={};function n(n,r){_y(e[r])&&_y(n)?e[r]=t(e[r],n):_y(n)?e[r]=t({},n):Ey(n)?e[r]=n.slice():e[r]=n}for(var r=0,i=arguments.length;r<i;r++)Ay(arguments[r],n);return e},extend:function(t,e,n){return Ay(e,(function(e,r){t[r]=n&&"function"==typeof e?by(e,n):e})),t},trim:function(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")},stripBOM:function(t){return 65279===t.charCodeAt(0)&&(t=t.slice(1)),t}};function Dy(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var Cy=function(t,e,n){if(!e)return t;var r;if(n)r=n(e);else if(Ny.isURLSearchParams(e))r=e.toString();else{var i=[];Ny.forEach(e,(function(t,e){null!=t&&(Ny.isArray(t)?e+="[]":t=[t],Ny.forEach(t,(function(t){Ny.isDate(t)?t=t.toISOString():Ny.isObject(t)&&(t=JSON.stringify(t)),i.push(Dy(e)+"="+Dy(t))})))})),r=i.join("&")}if(r){var o=t.indexOf("#");-1!==o&&(t=t.slice(0,o)),t+=(-1===t.indexOf("?")?"?":"&")+r}return t};function ky(){this.handlers=[]}ky.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},ky.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},ky.prototype.forEach=function(t){Ny.forEach(this.handlers,(function(e){null!==e&&t(e)}))};var xy=ky,Oy=function(t,e,n){return Ny.forEach(n,(function(n){t=n(t,e)})),t},Ry=function(t){return!(!t||!t.__CANCEL__)},Ly=function(t,e){Ny.forEach(t,(function(n,r){r!==e&&r.toUpperCase()===e.toUpperCase()&&(t[e]=n,delete t[r])}))},Py=function(t,e,n,r,i){return function(t,e,n,r,i){return t.config=e,n&&(t.code=n),t.request=r,t.response=i,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},t}(new Error(t),e,n,r,i)},Fy=Ny.isStandardBrowserEnv()?{write:function(t,e,n,r,i,o){var s=[];s.push(t+"="+encodeURIComponent(e)),Ny.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),Ny.isString(r)&&s.push("path="+r),Ny.isString(i)&&s.push("domain="+i),!0===o&&s.push("secure"),document.cookie=s.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},My=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],Vy=Ny.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function r(t){var r=t;return e&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return t=r(window.location.href),function(e){var n=Ny.isString(e)?r(e):e;return n.protocol===t.protocol&&n.host===t.host}}():function(){return!0},Uy=function(t){return new Promise((function(e,n){var r=t.data,i=t.headers;Ny.isFormData(r)&&delete i["Content-Type"];var o=new XMLHttpRequest;if(t.auth){var s=t.auth.username||"",a=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";i.Authorization="Basic "+btoa(s+":"+a)}var u,c,h=(u=t.baseURL,c=t.url,u&&!/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(c)?function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}(u,c):c);if(o.open(t.method.toUpperCase(),Cy(h,t.params,t.paramsSerializer),!0),o.timeout=t.timeout,o.onreadystatechange=function(){if(o&&4===o.readyState&&(0!==o.status||o.responseURL&&0===o.responseURL.indexOf("file:"))){var r,i,s,a,u,c="getAllResponseHeaders"in o?(r=o.getAllResponseHeaders(),u={},r?(Ny.forEach(r.split("\n"),(function(t){if(a=t.indexOf(":"),i=Ny.trim(t.substr(0,a)).toLowerCase(),s=Ny.trim(t.substr(a+1)),i){if(u[i]&&My.indexOf(i)>=0)return;u[i]="set-cookie"===i?(u[i]?u[i]:[]).concat([s]):u[i]?u[i]+", "+s:s}})),u):u):null,h={data:t.responseType&&"text"!==t.responseType?o.response:o.responseText,status:o.status,statusText:o.statusText,headers:c,config:t,request:o};!function(t,e,n){var r=n.config.validateStatus;n.status&&r&&!r(n.status)?e(Py("Request failed with status code "+n.status,n.config,null,n.request,n)):t(n)}(e,n,h),o=null}},o.onabort=function(){o&&(n(Py("Request aborted",t,"ECONNABORTED",o)),o=null)},o.onerror=function(){n(Py("Network Error",t,null,o)),o=null},o.ontimeout=function(){var e="timeout of "+t.timeout+"ms exceeded";t.timeoutErrorMessage&&(e=t.timeoutErrorMessage),n(Py(e,t,"ECONNABORTED",o)),o=null},Ny.isStandardBrowserEnv()){var l=(t.withCredentials||Vy(h))&&t.xsrfCookieName?Fy.read(t.xsrfCookieName):void 0;l&&(i[t.xsrfHeaderName]=l)}if("setRequestHeader"in o&&Ny.forEach(i,(function(t,e){void 0===r&&"content-type"===e.toLowerCase()?delete i[e]:o.setRequestHeader(e,t)})),Ny.isUndefined(t.withCredentials)||(o.withCredentials=!!t.withCredentials),t.responseType)try{o.responseType=t.responseType}catch(e){if("json"!==t.responseType)throw e}"function"==typeof t.onDownloadProgress&&o.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&o.upload&&o.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then((function(t){o&&(o.abort(),n(t),o=null)})),r||(r=null),o.send(r)}))},jy={"Content-Type":"application/x-www-form-urlencoded"};function qy(t,e){!Ny.isUndefined(t)&&Ny.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var By,Ky={adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(By=Uy),By),transformRequest:[function(t,e){return Ly(e,"Accept"),Ly(e,"Content-Type"),Ny.isFormData(t)||Ny.isArrayBuffer(t)||Ny.isBuffer(t)||Ny.isStream(t)||Ny.isFile(t)||Ny.isBlob(t)?t:Ny.isArrayBufferView(t)?t.buffer:Ny.isURLSearchParams(t)?(qy(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):Ny.isObject(t)?(qy(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(t){return t>=200&&t<300}};Ky.headers={common:{Accept:"application/json, text/plain, */*"}},Ny.forEach(["delete","get","head"],(function(t){Ky.headers[t]={}})),Ny.forEach(["post","put","patch"],(function(t){Ky.headers[t]=Ny.merge(jy)}));var zy=Ky;function Gy(t){t.cancelToken&&t.cancelToken.throwIfRequested()}var Hy=function(t){return Gy(t),t.headers=t.headers||{},t.data=Oy(t.data,t.headers,t.transformRequest),t.headers=Ny.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),Ny.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete t.headers[e]})),(t.adapter||zy.adapter)(t).then((function(e){return Gy(t),e.data=Oy(e.data,e.headers,t.transformResponse),e}),(function(e){return Ry(e)||(Gy(t),e&&e.response&&(e.response.data=Oy(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)}))},Qy=function(t,e){e=e||{};var n={},r=["url","method","data"],i=["headers","auth","proxy","params"],o=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],s=["validateStatus"];function a(t,e){return Ny.isPlainObject(t)&&Ny.isPlainObject(e)?Ny.merge(t,e):Ny.isPlainObject(e)?Ny.merge({},e):Ny.isArray(e)?e.slice():e}function u(r){Ny.isUndefined(e[r])?Ny.isUndefined(t[r])||(n[r]=a(void 0,t[r])):n[r]=a(t[r],e[r])}Ny.forEach(r,(function(t){Ny.isUndefined(e[t])||(n[t]=a(void 0,e[t]))})),Ny.forEach(i,u),Ny.forEach(o,(function(r){Ny.isUndefined(e[r])?Ny.isUndefined(t[r])||(n[r]=a(void 0,t[r])):n[r]=a(void 0,e[r])})),Ny.forEach(s,(function(r){r in e?n[r]=a(t[r],e[r]):r in t&&(n[r]=a(void 0,t[r]))}));var c=r.concat(i).concat(o).concat(s),h=Object.keys(t).concat(Object.keys(e)).filter((function(t){return-1===c.indexOf(t)}));return Ny.forEach(h,u),n};function Wy(t){this.defaults=t,this.interceptors={request:new xy,response:new xy}}Wy.prototype.request=function(t){"string"==typeof t?(t=arguments[1]||{}).url=arguments[0]:t=t||{},(t=Qy(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var e=[Hy,void 0],n=Promise.resolve(t);for(this.interceptors.request.forEach((function(t){e.unshift(t.fulfilled,t.rejected)})),this.interceptors.response.forEach((function(t){e.push(t.fulfilled,t.rejected)}));e.length;)n=n.then(e.shift(),e.shift());return n},Wy.prototype.getUri=function(t){return t=Qy(this.defaults,t),Cy(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")},Ny.forEach(["delete","get","head","options"],(function(t){Wy.prototype[t]=function(e,n){return this.request(Qy(n||{},{method:t,url:e,data:(n||{}).data}))}})),Ny.forEach(["post","put","patch"],(function(t){Wy.prototype[t]=function(e,n,r){return this.request(Qy(r||{},{method:t,url:e,data:n}))}}));var $y=Wy;function Xy(t){this.message=t}Xy.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},Xy.prototype.__CANCEL__=!0;var Yy=Xy;function Jy(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise((function(t){e=t}));var n=this;t((function(t){n.reason||(n.reason=new Yy(t),e(n.reason))}))}Jy.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},Jy.source=function(){var t;return{token:new Jy((function(e){t=e})),cancel:t}};var Zy=Jy;function tg(t){var e=new $y(t),n=by($y.prototype.request,e);return Ny.extend(n,$y.prototype,e),Ny.extend(n,e),n}var eg=tg(zy);eg.Axios=$y,eg.create=function(t){return tg(Qy(eg.defaults,t))},eg.Cancel=Yy,eg.CancelToken=Zy,eg.isCancel=Ry,eg.all=function(t){return Promise.all(t)},eg.spread=function(t){return function(e){return t.apply(null,e)}},eg.isAxiosError=function(t){return"object"==typeof t&&!0===t.isAxiosError};var ng=eg,rg=eg;ng.default=rg;var ig=ng;function og(t){let e,n=localStorage.getItem(`${t}`);return n&&(n=JSON.parse(n),e=parseInt(Date.now()/1e3)-n.cachetime>86400,console.log(`${t} expired:`,e)),{cachedData:n,expired:e}}function sg(t,e){const n={data:e,cachetime:parseInt(Date.now()/1e3)};localStorage.setItem(`${t}`,JSON.stringify(n))}function ag(t){let e,n={ctx:t,current:null,token:null,hasCatch:!1,pending:hg,then:cg,catch:ug,value:6};return function(t,e){const n=e.token={};function r(t,r,i,o){if(e.token!==n)return;e.resolved=o;let s=e.ctx;void 0!==i&&(s=s.slice(),s[i]=o);const a=t&&(e.current=t)(s);let u=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==r&&t&&(V(),q(t,1,1,(()=>{e.blocks[n]===t&&(e.blocks[n]=null)})),U())})):e.block.d(1),a.c(),j(a,1),a.m(e.mount(),e.anchor),u=!0),e.block=a,e.blocks&&(e.blocks[r]=a),u&&L()}if((i=t)&&"object"==typeof i&&"function"==typeof i.then){const n=_();if(t.then((t=>{T(n),r(e.then,1,e.value,t),T(null)}),(t=>{if(T(n),r(e.catch,2,e.error,t),T(null),!e.hasCatch)throw t})),e.current!==e.pending)return r(e.pending,0),!0}else{if(e.current!==e.then)return r(e.then,1,e.value,t),!0;e.resolved=t}var i}(t[5](),n),{c(){e=g(),n.block.c()},m(t,r){h(t,e,r),n.block.m(t,n.anchor=r),n.mount=()=>e.parentNode,n.anchor=e},p(e,r){!function(t,e,n){const r=e.slice(),{resolved:i}=t;t.current===t.then&&(r[t.value]=i),t.current===t.catch&&(r[t.error]=i),t.block.p(r,n)}(n,t=e,r)},d(t){t&&l(e),n.block.d(t),n.token=null,n=null}}}function ug(e){return{c:t,m:t,p:t,d:t}}function cg(e){let n,r=e[6].description+"";return{c(){n=p("div"),m(n,"class","card-content")},m(t,e){h(t,n,e),n.innerHTML=r},p:t,d(t){t&&l(n)}}}function hg(e){let n;return{c(){n=p("div"),n.innerHTML="<p>Loading...</p>",m(n,"class","card-content")},m(t,e){h(t,n,e)},p:t,d(t){t&&l(n)}}}function lg(e){let n,r,i,o,s,a,u,f,w,E,I,T,_,S,A=e[0]&&ag(e);return{c(){n=p("div"),r=p("div"),i=d(e[1]),o=y(),s=p("div"),a=d(e[2]),u=y(),f=p("div"),w=d(e[3]),E=d("%"),I=y(),A&&A.c(),T=g(),m(r,"class","card--rank"),m(s,"class","card--title"),m(f,"class","card--votes"),m(n,"class","card svelte-ee2ok9")},m(t,l){h(t,n,l),c(n,r),c(r,i),c(n,o),c(n,s),c(s,a),c(n,u),c(n,f),c(f,w),c(f,E),h(t,I,l),A&&A.m(t,l),h(t,T,l),_||(S=v(n,"click",e[4]),_=!0)},p(t,[e]){2&e&&b(i,t[1]),4&e&&b(a,t[2]),8&e&&b(w,t[3]),t[0]?A?A.p(t,e):(A=ag(t),A.c(),A.m(T.parentNode,T)):A&&(A.d(1),A=null)},i:t,o:t,d(t){t&&l(n),t&&l(I),A&&A.d(t),t&&l(T),_=!1,S()}}}function fg(t,e,n){let{rank:r}=e,{title:i}=e,{votes:o}=e,{isActive:s}=e;return t.$$set=t=>{"rank"in t&&n(1,r=t.rank),"title"in t&&n(2,i=t.title),"votes"in t&&n(3,o=t.votes),"isActive"in t&&n(0,s=t.isActive)},[s,r,i,o,function(){n(0,s=!s)},async()=>{let t,e=`${i} Details`,n=og(e);if(n.cachedData&&!n.expired)return n.cachedData.data;{const n="\n  query ($title: String){\n    Media (search: $title, type: ANIME) {\n      rankings {\n        allTime\n        rank\n        context\n      }\n      genres\n      description\n      externalLinks {\n        url\n      }\n      coverImage {\n        extraLarge\n      }\n    }\n  } \n  ",r={title:i},o={"Content-Type":"application/json",Accept:"application/json"};return await ig({method:"post",url:"https://graphql.anilist.co/",headers:o,data:JSON.stringify({query:n,variables:r})}).then((e=>t=e.data.data.Media)).catch((async e=>{console.log(e.message),console.log("Trying Kitsu...");const n={"Content-Type":"application/vnd.api+json",Accept:"application/vnd.api+json"};t=await(async()=>{const t={},e=await ig({method:"get",url:`https://kitsu.io/api/edge/anime?filter[text]=${i}`,headers:n}).catch((t=>console.log(t.message)));return t.description=e.data.data[0].attributes.synopsis.replace(/\n/g,"<br />"),t})()})),sg(e,t),console.log(`${i} details fetched`,t),t}}]}class pg extends Q{constructor(t){super(),H(this,t,fg,lg,s,{rank:1,title:2,votes:3,isActive:0})}}const dg=[];function yg(e,n=t){let r;const i=new Set;function o(t){if(s(e,t)&&(e=t,r)){const t=!dg.length;for(const t of i)t[1](),dg.push(t,e);if(t){for(let t=0;t<dg.length;t+=2)dg[t][0](dg[t+1]);dg.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(s,a=t){const u=[s,a];return i.add(u),1===i.size&&(r=n(o)||t),s(e),()=>{i.delete(u),0===i.size&&(r(),r=null)}}}}const gg=yg("2021"),vg=yg("Summer"),mg=yg("Week-04"),bg=yg(!1);function wg(t,e,n){const r=t.slice();return r[18]=e[n],r}function Eg(t,e,n){const r=t.slice();return r[21]=e[n],r}function Ig(t,e,n){const r=t.slice();return r[24]=e[n],r}function Tg(t){let e,n,r,o=t[0],s=[];for(let e=0;e<o.length;e+=1)s[e]=Sg(Ig(t,o,e));return{c(){e=p("select");for(let t=0;t<s.length;t+=1)s[t].c();void 0===t[4]&&x((()=>t[11].call(e)))},m(i,o){h(i,e,o);for(let t=0;t<s.length;t+=1)s[t].m(e,null);w(e,t[4]),n||(r=[v(e,"change",t[11]),v(e,"change",t[7])],n=!0)},p(t,n){if(1&n){let r;for(o=t[0],r=0;r<o.length;r+=1){const i=Ig(t,o,r);s[r]?s[r].p(i,n):(s[r]=Sg(i),s[r].c(),s[r].m(e,null))}for(;r<s.length;r+=1)s[r].d(1);s.length=o.length}17&n&&w(e,t[4])},d(t){t&&l(e),f(s,t),n=!1,i(r)}}}function _g(e){let n,r;return{c(){n=p("select"),r=p("option"),r.textContent="Loading...",r.__value="",r.value=r.__value},m(t,e){h(t,n,e),c(n,r)},p:t,d(t){t&&l(n)}}}function Sg(t){let e,n,r,i=t[24]+"";return{c(){e=p("option"),n=d(i),e.__value=r=t[24],e.value=e.__value},m(t,r){h(t,e,r),c(e,n)},p(t,o){1&o&&i!==(i=t[24]+"")&&b(n,i),1&o&&r!==(r=t[24])&&(e.__value=r,e.value=e.__value)},d(t){t&&l(e)}}}function Ag(t){let e,n,r,o=t[1],s=[];for(let e=0;e<o.length;e+=1)s[e]=Dg(Eg(t,o,e));return{c(){e=p("select");for(let t=0;t<s.length;t+=1)s[t].c();void 0===t[3]&&x((()=>t[12].call(e)))},m(i,o){h(i,e,o);for(let t=0;t<s.length;t+=1)s[t].m(e,null);w(e,t[3]),n||(r=[v(e,"change",t[12]),v(e,"change",t[8])],n=!0)},p(t,n){if(2&n){let r;for(o=t[1],r=0;r<o.length;r+=1){const i=Eg(t,o,r);s[r]?s[r].p(i,n):(s[r]=Dg(i),s[r].c(),s[r].m(e,null))}for(;r<s.length;r+=1)s[r].d(1);s.length=o.length}10&n&&w(e,t[3])},d(t){t&&l(e),f(s,t),n=!1,i(r)}}}function Ng(e){let n,r;return{c(){n=p("select"),r=p("option"),r.textContent="Loading...",r.__value="",r.value=r.__value},m(t,e){h(t,n,e),c(n,r)},p:t,d(t){t&&l(n)}}}function Dg(t){let e,n,r,i=t[21].replace("-"," ")+"";return{c(){e=p("option"),n=d(i),e.__value=r=t[21],e.value=e.__value},m(t,r){h(t,e,r),c(e,n)},p(t,o){2&o&&i!==(i=t[21].replace("-"," ")+"")&&b(n,i),2&o&&r!==(r=t[21])&&(e.__value=r,e.value=e.__value)},d(t){t&&l(e)}}}function Cg(t){let e,n,r=t[2],i=[];for(let e=0;e<r.length;e+=1)i[e]=xg(wg(t,r,e));const o=t=>q(i[t],1,1,(()=>{i[t]=null}));return{c(){for(let t=0;t<i.length;t+=1)i[t].c();e=g()},m(t,r){for(let e=0;e<i.length;e+=1)i[e].m(t,r);h(t,e,r),n=!0},p(t,n){if(36&n){let s;for(r=t[2],s=0;s<r.length;s+=1){const o=wg(t,r,s);i[s]?(i[s].p(o,n),j(i[s],1)):(i[s]=xg(o),i[s].c(),j(i[s],1),i[s].m(e.parentNode,e))}for(V(),s=r.length;s<i.length;s+=1)o(s);U()}},i(t){if(!n){for(let t=0;t<r.length;t+=1)j(i[t]);n=!0}},o(t){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)q(i[t]);n=!1},d(t){f(i,t),t&&l(e)}}}function kg(e){let n;return{c(){n=p("p"),n.textContent="Loading..."},m(t,e){h(t,n,e)},p:t,i:t,o:t,d(t){t&&l(n)}}}function xg(t){let n,r;const i=[t[18],{isActive:t[5]}];let o={};for(let t=0;t<i.length;t+=1)o=e(o,i[t]);return n=new pg({props:o}),{c(){B(n.$$.fragment)},m(t,e){K(n,t,e),r=!0},p(t,e){const r=36&e?function(t,e){const n={},r={},i={$$scope:1};let o=t.length;for(;o--;){const s=t[o],a=e[o];if(a){for(const t in s)t in a||(r[t]=1);for(const t in a)i[t]||(n[t]=a[t],i[t]=1);t[o]=a}else for(const t in s)i[t]=1}for(const t in r)t in n||(n[t]=void 0);return n}(i,[4&e&&(o=t[18],"object"==typeof o&&null!==o?o:{}),32&e&&{isActive:t[5]}]):{};var o;n.$set(r)},i(t){r||(j(n.$$.fragment,t),r=!0)},o(t){q(n.$$.fragment,t),r=!1},d(t){z(n,t)}}}function Og(t){let e,n,r,o,s,a,u,f,g,w,E,I,T,_,S,A,N,D,C,k;function x(t,e){return 0==t[0]?_g:Tg}let O=x(t),R=O(t);function L(t,e){return 0==t[1].length?Ng:Ag}let P=L(t),F=P(t);const M=[kg,Cg],B=[];function K(t,e){return 0==t[2].length?0:1}return _=K(t),S=B[_]=M[_](t),{c(){e=p("button"),e.textContent="Previous",n=y(),R.c(),r=y(),F.c(),o=y(),s=p("button"),s.textContent="Next",a=y(),u=p("p"),f=d("The current params are "),g=d(t[4]),w=y(),E=d(t[3]),I=y(),T=p("div"),S.c(),A=y(),N=p("button"),N.textContent="Show more rankings",m(e,"id","prev-btn"),m(e,"class","svelte-1hn3a7v"),m(s,"id","next-btn"),m(s,"class","svelte-1hn3a7v"),m(T,"class","svelte-1hn3a7v"),m(N,"id","showMore"),m(N,"class","svelte-1hn3a7v")},m(i,l){h(i,e,l),h(i,n,l),R.m(i,l),h(i,r,l),F.m(i,l),h(i,o,l),h(i,s,l),h(i,a,l),h(i,u,l),c(u,f),c(u,g),c(u,w),c(u,E),h(i,I,l),h(i,T,l),B[_].m(T,null),h(i,A,l),h(i,N,l),D=!0,C||(k=[v(e,"click",t[9]),v(s,"click",t[10]),v(N,"click",t[6])],C=!0)},p(t,[e]){O===(O=x(t))&&R?R.p(t,e):(R.d(1),R=O(t),R&&(R.c(),R.m(r.parentNode,r))),P===(P=L(t))&&F?F.p(t,e):(F.d(1),F=P(t),F&&(F.c(),F.m(o.parentNode,o))),(!D||16&e)&&b(g,t[4]),(!D||8&e)&&b(E,t[3]);let n=_;_=K(t),_===n?B[_].p(t,e):(V(),q(B[n],1,1,(()=>{B[n]=null})),U(),S=B[_],S?S.p(t,e):(S=B[_]=M[_](t),S.c()),j(S,1),S.m(T,null))},i(t){D||(j(S),D=!0)},o(t){q(S),D=!1},d(t){t&&l(e),t&&l(n),R.d(t),t&&l(r),F.d(t),t&&l(o),t&&l(s),t&&l(a),t&&l(u),t&&l(I),t&&l(T),B[_].d(),t&&l(A),t&&l(N),C=!1,i(k)}}}function Rg(t,e,n){let r,i,o,s;a(t,mg,(t=>n(3,r=t))),a(t,vg,(t=>n(4,i=t))),a(t,gg,(t=>n(14,o=t))),a(t,bg,(t=>n(5,s=t)));let c=[],h=[],l=[],f=vy.collection(o).doc(i).collection(r).orderBy("rank","asc").limit(10);!function(t){_().$$.on_mount.push(t)}((async()=>{n(2,l=await p()),n(0,c=await d()),n(1,h=await y()),document.getElementById("next-btn").disabled=!0}));const p=async()=>{let t=`${i}-${r}`,e=og(t);if(e.cachedData&&!e.expired)return e.cachedData.data;{let e=await f.get().then((t=>t.docs.map((t=>t.data()))));return sg(t,e),console.log("Data fetched:",e),e}},d=async()=>{let t="Seasons",e=og(t);if(e.cachedData&&!e.expired)return e.cachedData.data;{let e=vy.collection(o).orderBy("order","asc");return await e.get().then((t=>{t.forEach((t=>{n(0,c=[...c,t.id])}))})),sg(t,c),console.log("Seasons fetched:",c),c}},y=async()=>{let t=`${i}-Weeks`,e=og(t);if(e.cachedData&&!e.expired)return n(1,h.length=0,h),n(1,h=e.cachedData.data),h;{n(1,h.length=0,h);const e=my.httpsCallable("fetchSubCollections");return await e({year:o,season:i}).then((t=>{n(1,h=t.data)})),sg(t,h),console.log("Weeks fetched:",h),h}},g=async()=>{let t=`${i}-${r}`,e=og(t);if(e.cachedData&&!e.expired)n(2,l.length=0,l),n(2,l=e.cachedData.data);else{let e=[];n(2,l.length=0,l),f=vy.collection(o).doc(i).collection(r).orderBy("rank","asc").limit(10);let s=await f.get().then((t=>t.docs.map((t=>t.data()))));for(let t=0;t<s.length;t++)e={rank:s[t].rank,title:s[t].title,votes:s[t].votes},n(2,l=[...l,e]);sg(t,s),console.log("Items array updated. New Items:",l)}document.getElementById("showMore").disabled=!1};return[c,h,l,r,i,s,async()=>{let t=[];await f.get().then((e=>{let s=e.docs[e.docs.length-1];f=vy.collection(o).doc(i).collection(r).orderBy("rank","asc").startAfter(s).limit(10),f.get().then((e=>{let r=e.docs.map((t=>t.data()));for(let e=0;e<r.length;e++)t={rank:r[e].rank,title:r[e].title,votes:r[e].votes},n(2,l=[...l,t]);e.size<10?(document.getElementById("showMore").disabled=!0,console.log("No more data to be fetched")):console.log("Next batch of data fetched")}))}))},async()=>{u(mg,r="Week-01",r),document.getElementById("prev-btn").disabled=!0,document.getElementById("next-btn").disabled=!1,await g(),await y()},g,function(){let t=h.indexOf(r);(document.getElementById("next-btn").disabled=!0)&&(document.getElementById("next-btn").disabled=!1),1==t?(u(mg,r=h[t-1],r),g(),document.getElementById("prev-btn").disabled=!0):(u(mg,r=h[t-1],r),g()),console.log("Previous clicked")},function(){let t=h.indexOf(r);(document.getElementById("prev-btn").disabled=!0)&&(document.getElementById("prev-btn").disabled=!1),t+1==h.length-1?(u(mg,r=h[t+1],r),g(),document.getElementById("next-btn").disabled=!0):(u(mg,r=h[t+1],r),g()),console.log("Next clicked")},function(){i=E(this),vg.set(i),n(0,c)},function(){r=E(this),mg.set(r),n(1,h)}]}class Lg extends Q{constructor(t){super(),H(this,t,Rg,Og,s,{})}}function Pg(e){let n,r,i,o,s;return o=new Lg({}),{c(){n=p("main"),r=p("h1"),r.textContent="Anime Corner Rankings",i=y(),B(o.$$.fragment),m(r,"class","svelte-11a7f76"),m(n,"class","svelte-11a7f76")},m(t,e){h(t,n,e),c(n,r),c(n,i),K(o,n,null),s=!0},p:t,i(t){s||(j(o.$$.fragment,t),s=!0)},o(t){q(o.$$.fragment,t),s=!1},d(t){t&&l(n),z(o)}}}return new class extends Q{constructor(t){super(),H(this,t,null,Pg,s,{})}}({target:document.body,props:{name:"world"}})}();
//# sourceMappingURL=bundle.js.map
